{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/analysis/DirectLineMeasurement/DirectLineMeasurementController.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/MeasurementArrowTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/MeasurementArrowMaterial.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/MeasurementArrowVisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/RightAngleQuadVisualElement.js","../node_modules/@arcgis/core/views/3d/layers/analysis/DirectLineMeasurement/DirectLineMeasurementView.js","../node_modules/@arcgis/core/views/3d/layers/DirectLineMeasurementLayerView3D.js","../node_modules/@arcgis/core/chunks/MeasurementArrow.glsl.js"],"names":["R","e","_unitNormalizer","M","_handles","i","_tempStartPosition","v","_tempEndPosition","_tempCornerPosition","this","add","p","view","_initialize","a","spatialReference","t","D","j","z","_sphericalPCPF","s","_","h","viewData","startPoint","layer","elevationAlignedStartPoint","_applyElevationAlignment","endPoint","elevationAlignedEndPoint","result","_computedResult","n","hasZ","clone","c","k","elevationProvider","_euclideanDistances","_exactGeodesicDistanceAndAngle","horizontal","value","directDistance","direct","horizontalDistance","verticalDistance","vertical","geodesicDistance","distance","geodesicAngle","angle","o","r","w","u","m","d","Math","abs","normalizeDistance","g","f","l","addPath","isGeographic","A","b","isWebMercator","_fallbackGeodesicAngle","_fallbackGeodesicDistance","P","metersPerDegree","y","G","S","sin","cos","E","prototype","shader","get","build","rctx","program","camera","projectionMatrix","setUniform1f","width","outlineSize","setUniform4fv","outlineColor","stripeLength","stripeEvenColor","stripeOddColor","rebindTextures","configuration","blending","transparent","polygonOffset","polygonOffsetEnabled","factor","units","depthTest","func","depthWrite","colorWrite","setPipelineState","transparencyPassType","arguments","count","techniqueConfig","params","x","output","updateParameters","_technique","_techniqueRep","releaseAndAcquire","_material","getTechniqueConfig","bindPass","getPassParameters","vec3f","vec2f","f32","C","q","vertexBufferLayout","createBuffer","indices","length","vertexAttributes","data","console","warn","transformation","T","invTranspTransformation","position","normal","L","uv0","setVec","set","auxpos1","_parameters","_origin","_originTransform","_arrowCenter","_renderOccluded","_geometry","_stripeLength","_stripesEnabled","_opacity","applyProps","_arrowMaterial","setParameterValues","renderOccluded","geometryChanged","attached","opacity","arrowStripeEvenColor","arrowStripeOddColor","_updateArrowOpacity","arrowOutlineColor","state","watch","viewChanged","destroy","startRenderSpace","endRenderSpace","_createArrowGeometry","addGeometry","renderCoordsHelper","push","type","eval","worldUpAtPosition","arrowSubdivisions","createPolylineGeometry","recreateGeometry","ready","computeScreenPixelSizeAt","arrowWidth","arrowOutlineWidth","arrowStripeLength","_quadMaterial","_outlineMaterial","_maxSize","_position","_up","_right","_color","_outlineColor","_outlineSize","_size","_outlineRenderOccluded","_updateQuadMaterial","_updateOutlineMaterial","_updateTransform","previous","center","next","min","quadMaterialParameters","O","outlineMaterialParameters","removeAll","_createQuadGeometry","_createOutlineGeometry","_quadGeometryData","object","size","exclusive","Uint16Array","color","writeDepth","Q","_params","I","_segmentVisualElement","_triangleVisualElement","_rightAngleQuad","_projectedGeodesicLine","_geodesicStartHint","_geodesicEndHint","_segmentLabel","_verticalLabel","_horizontalLabel","_startPosition","_endPosition","_cornerPosition","_startPositionAtSeaLevel","_endPositionAtSeaLevel","_state","_segmentLabelDisplayedMeasurement","_triangleOrientationOverride","messages","loadingMessages","viewMode","visualizedMeasurement","actualVisualizedMeasurement","visualElementOrientation","triangleCollapseRatioThreshold","layerView","geodesicDistanceThreshold","visible","suspended","_getActualVisualElementsOrientation","labels","Error","geometry","triangleLineWidth","triangleColor","H","B","stippleIntegerRepeats","geodesicProjectionLineWidth","geodesicProjectionLineColor","stipplePattern","U","guideStippleLengthPixels","guideLineWidth","fontSize","direcLabelFontSize","verticalLabelFontSize","horizontalLabelFontSize","V","_updateGeometryAndViewMode","_updateVisualElementVisibility","fullOpacity","_updateVisualElementsOpacity","_updateLabelText","_updateLabelVisibility","_updateSegmentStripeLength","F","_updateMessageBundle","equals","toRenderCoords","_updateActualVisualizedMeasurement","_computeViewMode","getAltitude","_updateSegment","_updateSegmentAndTriangle","_updateSegmentAndProjection","anchor","segment","sampleLocation","N","X","projectToRenderScreen","Y","Z","J","$","setAltitude","setGeometryFromSegment","text","_getLabelsText","euclideanDistance","notifyChange","unit","_measurementArrowStripeLength","stripesEnabled","_geodesicDistanceExceeded","_requiresGeodesicGuideAt","aboveGround","toUnit","W","then","finally","K","readOnly","laserLineGlowColor","laserLineGlowWidth","laserLineGlowFalloff","laserLineInnerColor","laserLineInnerWidth","laserLineGlobalAlpha","laserLineEnabled","handleColor","handleOpacity","handleRadius","triangleCornerSize","triangleSubdivisions","guideLineColor","labelDistance","_userUnit","_defaultUnit","_analysisView","allowVisualElementsOrientationChange","destroyed","controller","testData","_analysisController","whenReady","vertex","uniforms","attributes","varyings","code","fragment","sqrt","float","Object","freeze","__proto__"],"mappings":"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","file":"static/js/93.d7a60b90.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import i from\"../../../../../core/Handles.js\";import{deg2rad as s,rad2deg as o,acosClamped as r}from\"../../../../../core/mathUtils.js\";import{destroyMaybe as a,isNone as n,unwrapOr as c}from\"../../../../../core/maybe.js\";import l from\"../../../../../core/Quantity.js\";import{whenOnce as p}from\"../../../../../core/watchUtils.js\";import{property as m}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as d}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as h}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{i as u}from\"../../../../../chunks/vec3.js\";import{c as v}from\"../../../../../chunks/vec3f64.js\";import{geodesicLength as g}from\"../../../../../geometry/geometryEngine.js\";import f from\"../../../../../geometry/Polyline.js\";import{canProjectWithoutEngine as _,projectPointToVector as w,projectPointToWGS84ComparableLonLat as y}from\"../../../../../geometry/projection.js\";import{getSphericalPCPF as D,getReferenceEllipsoid as P,SphericalECEFSpatialReference as j,WGS84ECEFSpatialReference as z}from\"../../../../../geometry/projectionEllipsoid.js\";import{isSupported as A,geodesicLengths as b,inverseGeodeticSolver as E}from\"../../../../../geometry/support/geodesicUtils.js\";import{UnitNormalizer as M}from\"../support/UnitNormalizer.js\";import{getElevationAtPoint as k}from\"../../../support/ElevationProvider.js\";let R=class extends t{constructor(e){super(e),this._unitNormalizer=new M,this._handles=new i,this._tempStartPosition=v(),this._tempEndPosition=v(),this._tempCornerPosition=v()}initialize(){this._handles.add(p(this.view,\"ready\",(()=>this._initialize()),!0))}destroy(){this._handles=a(this._handles)}_initialize(){const e=this.view.spatialReference,t=D(e),i=t===j?z:t;this._sphericalPCPF=i;const s=_(e,i);this._unitNormalizer.spatialReference=s?i:e,this._handles.add([h((()=>({viewData:this.viewData,startPoint:this.layer.startPoint})),(({viewData:e,startPoint:t})=>{e.elevationAlignedStartPoint=this._applyElevationAlignment(t)})),h((()=>({viewData:this.viewData,endPoint:this.layer.endPoint})),(({viewData:e,endPoint:t})=>{e.elevationAlignedEndPoint=this._applyElevationAlignment(t)})),h((()=>({result:this._computedResult,viewData:this.viewData})),(({result:e,viewData:t})=>{t.result=e}))])}_applyElevationAlignment(e){if(n(e)||e.hasZ)return e;const t=e.clone();return t.z=c(k(this.view.elevationProvider,t),0),t}get _computedResult(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.viewData;if(n(e)||n(t))return null;const i=this._euclideanDistances(e,t),s=this._exactGeodesicDistanceAndAngle(e,t,i.horizontal.value);return{directDistance:i.direct,horizontalDistance:i.horizontal,verticalDistance:i.vertical,geodesicDistance:s.distance,geodesicAngle:s.angle}}_euclideanDistances(e,t){const i=e.clone();i.z=t.z;const s=this._tempStartPosition,o=this._tempEndPosition,r=this._tempCornerPosition,a=this.view.spatialReference,n=this._sphericalPCPF,c=_(a,n)?n:a;w(e,s,c),w(t,o,c),w(i,r,c);const p=u(s,o),m=u(r,o),d=Math.abs(t.z-e.z),h=e=>this._unitNormalizer.normalizeDistance(e),v=h(p),g=h(m),f=h(d);return{direct:new l(v,\"meters\"),horizontal:new l(g,\"meters\"),vertical:new l(f,\"meters\")}}_exactGeodesicDistanceAndAngle(e,t,i){const s=e.spatialReference,o=new f({spatialReference:s});o.addPath([e,t]);const r=s.isGeographic&&A(s)?b([o],\"meters\")[0]:s.isWebMercator?g(o,\"meters\"):void 0,{distance:a,angle:n}=r?{distance:r,angle:this._fallbackGeodesicAngle(r,s)}:this._fallbackGeodesicDistance(e,t,i);return{distance:new l(a,\"meters\"),angle:new l(n,\"degrees\")}}_fallbackGeodesicAngle(e,t){return e/P(t).metersPerDegree}_fallbackGeodesicDistance(e,t,i){if(y(e,G)){y(t,S);const e=s(G[0]),i=s(G[1]),a=s(S[0]),n=s(S[1]),c=Math.abs(a-e),l=r(Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos(c)),p=o(l),m={distance:0};return E(m,[G[0],G[1]],[S[0],S[1]]),{distance:m.distance,angle:p}}const a=e.spatialReference,n=i;return{distance:n,angle:this._fallbackGeodesicAngle(n,a)}}};e([m()],R.prototype,\"view\",void 0),e([m()],R.prototype,\"layer\",void 0),e([m()],R.prototype,\"viewData\",void 0),e([m()],R.prototype,\"_computedResult\",null),R=e([d(\"esri.views.3d.layers.analysis.DirectLineMeasurement/DirectLineMeasurementController\")],R);const G=v(),S=v();export{R as DirectLineMeasurementController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../../chunks/tslib.es6.js\";import{bindProjectionMatrix as e,bindView as t}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as o}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as i}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as s,ShaderTechniqueConfiguration as n}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as a}from\"../lib/DefaultVertexAttributeLocations.js\";import{blendingDefault as p,OITBlending as l}from\"../lib/OrderIndependentTransparency.js\";import{Program as m}from\"../lib/Program.js\";import{M as h}from\"../../../../chunks/MeasurementArrow.glsl.js\";import{makePipelineState as f,defaultDepthWriteParams as d,defaultColorWriteParams as u}from\"../../../webgl/renderState.js\";class c extends i{constructor(r,e,t){super(r,e,t)}initializeProgram(r){const e=c.shader.get().build();return new m(r.rctx,e,a)}bindPass(r,t){e(this.program,t.camera.projectionMatrix),this.program.setUniform1f(\"width\",r.width),this.program.setUniform1f(\"outlineSize\",r.outlineSize),this.program.setUniform4fv(\"outlineColor\",r.outlineColor),this.program.setUniform1f(\"stripeLength\",r.stripeLength),this.program.setUniform4fv(\"stripeEvenColor\",r.stripeEvenColor),this.program.setUniform4fv(\"stripeOddColor\",r.stripeOddColor)}bindDraw(r){t(this.program,r),this.program.rebindTextures()}setPipelineState(r){const e=3===r,t=this.configuration;return f({blending:t.transparent?e?p:l(r):null,polygonOffset:this.configuration.polygonOffsetEnabled&&{factor:0,units:-4},depthTest:{func:513},depthWrite:d,colorWrite:u})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}get primitiveType(){return 5}}c.shader=new o(h,(()=>import(\"./MeasurementArrow.glsl.js\")));class g extends n{constructor(){super(...arguments),this.polygonOffsetEnabled=!1,this.transparent=!1,this.transparencyPassType=3}}r([s()],g.prototype,\"polygonOffsetEnabled\",void 0),r([s()],g.prototype,\"transparent\",void 0),r([s({count:4})],g.prototype,\"transparencyPassType\",void 0);export{c as MeasurementArrowTechnique,g as MeasurementArrowTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{s as e,n as t,f as s,c as r,i,m as n}from\"../../../../chunks/vec3.js\";import{c as o}from\"../../../../chunks/vec3f64.js\";import{newLayout as a}from\"../../support/buffer/InterleavedLayout.js\";import c from\"../lib/GLMaterial.js\";import{Material as u,materialParametersDefaults as p}from\"../lib/Material.js\";import{MeasurementArrowTechniqueConfiguration as f,MeasurementArrowTechnique as l}from\"../shaders/MeasurementArrowTechnique.js\";class h extends u{constructor(e){super(e,d),this.techniqueConfig=new f}getTechniqueConfig(e){return this.techniqueConfig.polygonOffsetEnabled=this.params.polygonOffset,this.techniqueConfig.transparent=this.params.stripeEvenColor[3]<1||this.params.stripeOddColor[3]<1||this.params.outlineColor[3]<1,this.techniqueConfig.transparencyPassType=e?e.transparencyPassType:3,this.techniqueConfig}dispose(){}getPassParameters(){return this.params}intersect(){}createBufferWriter(){return new x}getGLMaterial(e){return 0===e.output?new m(e):void 0}}class m extends c{constructor(e){super(e),this.updateParameters()}updateParameters(e){this._technique=this._techniqueRep.releaseAndAcquire(l,this._material.getTechniqueConfig(e),this._technique)}beginSlot(e){return 3===e}bind(e){this._technique.bindPass(this._material.getPassParameters(),e)}}const d={width:32,outlineSize:.2,outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,1,1,1],stripeOddColor:[1,.5,0,1],polygonOffset:!1,...p},g=a().vec3f(\"position\").vec3f(\"normal\").vec2f(\"uv0\").f32(\"auxpos1\"),v=o(),C=o(),q=o(),y=o(),b=o();class x{constructor(){this.vertexBufferLayout=g}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 2*(e.indices.get(\"position\").length/2+1)}write(o,a,c,u){const p=a.vertexAttributes.get(\"position\").data,f=a.vertexAttributes.get(\"normal\").data,l=p.length/3,h=a&&a.indices&&a.indices.get(\"position\");h&&h.length!==2*(l-1)&&console.warn(\"MeasurementArrowMaterial does not support indices\");const m=v,d=C,g=q,x=y,P=b,w=o.transformation,T=o.invTranspTransformation,j=c.position,A=c.normal,L=c.uv0;let M=0;for(let v=0;v<l;++v){const o=3*v;if(e(m,p[o],p[o+1],p[o+2]),v<l-1){const i=3*(v+1);e(d,p[i],p[i+1],p[i+2]),e(P,f[i],f[i+1],f[i+2]),t(P,P),s(g,d,m),t(g,g),r(x,P,g),t(x,x)}const a=i(m,d);w&&T&&(n(m,m,w),n(d,d,w),n(x,x,T));const c=u+2*v,h=c+1;j.setVec(c,m),j.setVec(h,m),A.setVec(c,x),A.setVec(h,x),L.set(c,0,M),L.set(c,1,-1),L.set(h,0,M),L.set(h,1,1),v<l-1&&(M+=a)}const _=c.auxpos1;for(let e=0;e<2*l;++e)_.set(u+e,M)}}export{h as MeasurementArrowMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Handles.js\";import{applyOpacity as r}from\"../../../../core/mathUtils.js\";import{isNone as t,isSome as s}from\"../../../../core/maybe.js\";import{c as i}from\"../../../../chunks/mat4f64.js\";import{f as o}from\"../../../../chunks/vec3.js\";import{c as a}from\"../../../../chunks/vec3f64.js\";import{c as n}from\"../../../../chunks/vec4f64.js\";import{sv3d as h}from\"../../../../geometry/support/vectorStacks.js\";import{Object3DVisualElement as l}from\"./Object3DVisualElement.js\";import d from\"../../webgl-engine/lib/GeometryUtil.js\";import{MeasurementArrowMaterial as c}from\"../../webgl-engine/materials/MeasurementArrowMaterial.js\";class p extends l{constructor(e){super(e),this._parameters=m,this._handles=null,this._origin=a(),this._originTransform=i(),this._arrowCenter=a(),this._renderOccluded=4,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this._opacity=1,this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._arrowMaterial&&this._arrowMaterial.setParameterValues({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameterValues({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){const e=this.opacity,{arrowStripeEvenColor:t,arrowStripeOddColor:s}=this._parameters,i=r(_,this._stripesEnabled?t:s,e);this._arrowMaterial.setParameterValues({stripeEvenColor:i})}}get opacity(){return this._opacity}set opacity(e){e!==this._opacity&&(this._opacity=e,this._updateArrowOpacity())}createExternalResources(){const{arrowStripeEvenColor:r,arrowStripeOddColor:t,arrowOutlineColor:s}=this._parameters,i=this._stripesEnabled?r:t;this._arrowMaterial=new c({outlineColor:s,stripeEvenColor:i,stripeOddColor:t,renderOccluded:this.renderOccluded,polygonOffset:!0}),this._handles=new e,this._handles.add(this.view.state.watch(\"camera\",(()=>{this.viewChanged()})))}destroyExternalResources(){this._arrowMaterial=null,this._handles.destroy(),this._handles=null}forEachExternalMaterial(e){e(this._arrowMaterial)}createGeometries(e){if(t(this._geometry)||t(this._geometry.startRenderSpace)||t(this._geometry.endRenderSpace))return;const r=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);e.addGeometry(r,this._arrowMaterial,this._originTransform),this.viewChanged()}_createArrowGeometry(e,r,t,s){const i=this.view.renderCoordsHelper,a=[],n=[],l=(e,r)=>{const s=h.get();o(s,e,t),a.push(s),n.push(r)};if(\"euclidean\"===s.type){s.eval(.5,this._arrowCenter);const t=h.get();i.worldUpAtPosition(this._arrowCenter,t),l(e,t),l(r,t)}else{s.eval(.5,this._arrowCenter);const e=this._parameters.arrowSubdivisions+1&-2;for(let r=0;r<e;++r){const t=r/(e-1),o=h.get(),a=h.get();s.eval(t,o),i.worldUpAtPosition(o,a),l(o,a)}}return d.createPolylineGeometry(a,n)}geometryChanged(){this.recreateGeometry()}viewChanged(){if(this.view.ready&&this.attached&&s(this._geometry)){const e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameterValues({width:this._parameters.arrowWidth*e})}}_updateArrowOpacity(){const e=this.opacity,{arrowStripeEvenColor:t,arrowStripeOddColor:s,arrowOutlineColor:i}=this._parameters,o=r(_,this._stripesEnabled?t:s,e),a=r(w,i,e),n=r(u,s,e);this._arrowMaterial.setParameterValues({stripeEvenColor:o,outlineColor:a,stripeOddColor:n})}}const m={arrowWidth:16,arrowOutlineColor:[1,.5,0,1],arrowOutlineWidth:.2,arrowStripeEvenColor:[1,1,1,1],arrowStripeOddColor:[1,.5,0,1],arrowStripeLength:16,arrowSubdivisions:128},_=n(),w=n(),u=n();export{p as MeasurementArrowVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Handles.js\";import{isSome as t}from\"../../../../core/maybe.js\";import{i,t as r,f as s}from\"../../../../chunks/mat4.js\";import{c as a}from\"../../../../chunks/mat4f64.js\";import{i as o,n as l,f as n,g as u,b as h}from\"../../../../chunks/vec3.js\";import{c as d}from\"../../../../chunks/vec3f64.js\";import{c}from\"../../../../chunks/vec4.js\";import{f as _}from\"../../../../chunks/vec4f32.js\";import{sv3d as m}from\"../../../../geometry/support/vectorStacks.js\";import{Object3DVisualElement as p}from\"./Object3DVisualElement.js\";import{Geometry as M}from\"../../webgl-engine/lib/Geometry.js\";import f from\"../../webgl-engine/lib/GeometryUtil.js\";import{ColorMaterial as g}from\"../../webgl-engine/materials/ColorMaterial.js\";import{RibbonLineMaterial as O}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";class y extends p{constructor(t){super(t),this._handles=new e,this._quadMaterial=null,this._outlineMaterial=null,this._maxSize=0,this._position=d(),this._up=d(),this._right=d(),this._renderOccluded=4,this._color=_(1,0,0,1),this._outlineColor=_(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=16,this.applyProps(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){c(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){c(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry({previous:e,center:t,next:i}){this._maxSize=Math.min(o(t,e),o(t,i))/3,l(this._up,n(this._up,e,t)),l(this._right,n(this._right,i,t)),u(this._position,t),this.recreateGeometry()}createExternalResources(){this._quadMaterial=new g(this.quadMaterialParameters),this._outlineMaterial=new O(this.outlineMaterialParameters),this._handles.add(this.view.state.watch(\"camera\",(()=>this._updateTransform())))}destroyExternalResources(){this._quadMaterial=null,this._outlineMaterial=null,this._handles.removeAll()}forEachExternalMaterial(e){e(this._quadMaterial),e(this._outlineMaterial)}createGeometries(e){this._createQuadGeometry(e),this._createOutlineGeometry(e),this._updateTransform(e)}_createQuadGeometry(e){const t=this._quadGeometryData(this._up,this._right);e.addGeometry(t,this._quadMaterial)}_createOutlineGeometry(e){if(0===this._outlineSize)return;const t=h(m.get(),this._up,this._right),i=f.createPolylineGeometry([this._up,t,this._right]);e.addGeometry(i,this._outlineMaterial)}_updateTransform(e=this.object){const a=this.view.state.camera,o=this._size*a.computeScreenPixelSizeAt(this._position),l=Math.min(this._maxSize,o);i(z),r(z,z,this._position),s(z,z,[l,l,l]),t(e)&&(e.transformation=z)}_quadGeometryData(e,t){const i=h(m.get(),e,t);return new M([[\"position\",{size:3,data:[0,0,0,...t,...e,...i],exclusive:!0}]],[[\"position\",new Uint16Array([0,1,2,1,2,3])]])}get quadMaterialParameters(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}_updateQuadMaterial(){this._quadMaterial&&this._quadMaterial.setParameterValues(this.quadMaterialParameters)}get outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}_updateOutlineMaterial(){this._outlineMaterial&&this._outlineMaterial.setParameterValues(this.outlineMaterialParameters)}}const z=a();export{y as RightAngleQuadVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../intl.js\";import t from\"../../../../../core/Accessor.js\";import i from\"../../../../../core/Handles.js\";import{nextHighestPowerOfTen as s,applyOpacity as n,sign as a,deg2rad as r}from\"../../../../../core/mathUtils.js\";import{isSome as o,isNone as l,destroyMaybe as c}from\"../../../../../core/maybe.js\";import{formatDecimal as h,formatDMS as d,formatImperialLength as u,formatImperialVerticalLength as m,formatMetricLength as g,formatMetricVerticalLength as p}from\"../../../../../core/quantityFormatUtils.js\";import{createRenderScreenPointArray3 as _,createRenderScreenPointArray as v}from\"../../../../../core/screenUtils.js\";import{preferredImperialLengthUnit as b,convertUnit as L}from\"../../../../../core/unitUtils.js\";import{whenOnce as w}from\"../../../../../core/watchUtils.js\";import{property as y}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as f}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{autorun as V,reactionInit as S}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{h as E}from\"../../../../../chunks/vec2.js\";import{a as z,b as j}from\"../../../../../chunks/vec3.js\";import{c as P}from\"../../../../../chunks/vec3f64.js\";import{f as A}from\"../../../../../chunks/vec4f32.js\";import{c as D}from\"../../../../../chunks/vec4f64.js\";import{getReferenceEllipsoid as M}from\"../../../../../geometry/projectionEllipsoid.js\";import{LabelVisualElement as O,mirrorPosition as C}from\"../../../interactive/visualElements/LabelVisualElement.js\";import{LineVisualElement as G}from\"../../../interactive/visualElements/LineVisualElement.js\";import{MeasurementArrowVisualElement as x}from\"../../../interactive/visualElements/MeasurementArrowVisualElement.js\";import{RightAngleQuadVisualElement as H}from\"../../../interactive/visualElements/RightAngleQuadVisualElement.js\";import{GeodesicSegment as k,EuclideanSegment as R}from\"../../../interactive/visualElements/support/Segment.js\";import{screenSpaceTangent as T}from\"../support/viewUtils.js\";import{createStipplePatternSimple as U}from\"../../../webgl-engine/materials/lineStippleUtils.js\";import{onLocaleChange as F}from\"../../../../../intl/locale.js\";import{fetchMessageBundle as W}from\"../../../../../intl/messages.js\";let Q=class extends t{constructor(e){super(e),this._params={...I},this._handles=new i,this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=P(),this._endPosition=P(),this._cornerPosition=P(),this._startPositionAtSeaLevel=P(),this._endPositionAtSeaLevel=P(),this._state=0,this._segmentLabelDisplayedMeasurement=1,this._triangleOrientationOverride=null,this.messages=null,this.loadingMessages=!0,this.viewMode=0,this.visualizedMeasurement=0,this.actualVisualizedMeasurement=1,this.visualElementOrientation=0,this.triangleCollapseRatioThreshold=.03}get _geodesicDistanceExceeded(){var e;const t=this.layerView.result;return o(t)&&(null==(e=t.horizontalDistance)?void 0:e.value)>this.layer.geodesicDistanceThreshold}get ready(){return 1===this._state}get visible(){return this.layerView.visible&&!this.layerView.suspended}get allowVisualElementsOrientationChange(){return l(this._triangleOrientationOverride)}set allowVisualElementsOrientationChange(e){l(this._triangleOrientationOverride)!==e&&(l(this._triangleOrientationOverride)?this._triangleOrientationOverride=this._getActualVisualElementsOrientation():this._triangleOrientationOverride=null)}get labels(){const e=2===this.actualVisualizedMeasurement;return{direct:this._segmentLabel,horizontal:e?this._segmentLabel:this._horizontalLabel,vertical:this._verticalLabel}}get testData(){var e;return{labels:this.labels,stripeLength:null==(e=this._segmentVisualElement)?void 0:e.stripeLength}}initialize(){this._handles.add(w(this.view,\"ready\",(()=>this._initialize()),!0))}_initialize(){switch(this._state){case 1:throw new Error(\"invalid state\");case 2:return}const e=this._params,t={attached:!0,view:this.view};this._segmentVisualElement=new x({...t,geometry:null,renderOccluded:4}),this._triangleVisualElement=new G({...t,width:e.triangleLineWidth,color:e.triangleColor,renderOccluded:4}),this._rightAngleQuad=new H({...t,color:B,renderOccluded:4});const i={...t,polygonOffset:!0,stippleIntegerRepeats:!1,renderOccluded:4};this._projectedGeodesicLine=new G({...i,width:e.geodesicProjectionLineWidth,color:e.geodesicProjectionLineColor,stipplePattern:U(e.guideStippleLengthPixels)}),this._geodesicStartHint=new G({...i,width:e.guideLineWidth,color:e.geodesicProjectionLineColor,stipplePattern:U(e.guideStippleLengthPixels)}),this._geodesicEndHint=new G({...i,width:e.guideLineWidth,color:e.geodesicProjectionLineColor,stipplePattern:U(e.guideStippleLengthPixels)}),this._segmentLabel=new O({...t,fontSize:e.direcLabelFontSize}),this._verticalLabel=new O({...t,fontSize:e.verticalLabelFontSize}),this._horizontalLabel=new O({...t,fontSize:e.horizontalLabelFontSize}),this._handles.add([V((()=>this._updateGeometryAndViewMode())),V((()=>this._updateVisualElementVisibility())),S((()=>this.layerView.fullOpacity),(()=>this._updateVisualElementsOpacity())),V((()=>this._updateLabelText())),V((()=>this._updateLabelVisibility())),V((()=>this._updateSegmentStripeLength())),F((async()=>this._updateMessageBundle()))]),this._state=1,this._updateMessageBundle()}destroy(){2!==this._state&&(this._handles=c(this._handles),this._segmentVisualElement=c(this._segmentVisualElement),this._triangleVisualElement=c(this._triangleVisualElement),this._rightAngleQuad=c(this._rightAngleQuad),this._projectedGeodesicLine=c(this._projectedGeodesicLine),this._geodesicStartHint=c(this._geodesicStartHint),this._geodesicEndHint=c(this._geodesicEndHint),this._segmentLabel=c(this._segmentLabel),this._verticalLabel=c(this._verticalLabel),this._horizontalLabel=c(this._horizontalLabel),this.set(\"view\",null),this._state=2)}async whenReady(){await w(this,\"ready\")}_updateVisualElementVisibility(){if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,this.visible)switch(this.viewMode){case 0:break;case 1:this._segmentVisualElement.visible=!0;break;case 2:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case 3:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode(){const e=this.view.renderCoordsHelper,{elevationAlignedStartPoint:t,elevationAlignedEndPoint:i}=this.layerView;if(l(t)||l(i)||t.equals(i)){this.viewMode=0;const e=this.visualizedMeasurement,t=0===e;return void(this.actualVisualizedMeasurement=t?1:e)}e.toRenderCoords(t,this._startPosition),e.toRenderCoords(i,this._endPosition);const s=this._getActualVisualElementsOrientation(),n=this._updateActualVisualizedMeasurement();this.viewMode=this._computeViewMode(n);let a=this._startPosition,r=this._endPosition;const o=1===s?1:-1,c=o*(e.getAltitude(r)-e.getAltitude(a));c<0&&(a=this._endPosition,r=this._startPosition);const h=2===n?new k(this._startPosition,this._endPosition,e.spatialReference):new R(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=h,this._updateSegmentStripeLength(),this._segmentLabelDisplayedMeasurement=n,this.viewMode){case 1:this._updateSegment(h,s);break;case 2:this._updateSegmentAndTriangle(h,s,a,r,o,c);break;case 3:this._updateSegmentAndProjection(s)}}_updateSegment(e,t){this._segmentLabel.anchor=1===t?\"top\":\"bottom\",this._segmentLabel.geometry={type:\"segment\",segment:e,sampleLocation:\"center\"}}_updateSegmentAndTriangle(e,t,i,s,n,a){const r=this.view,o=r.renderCoordsHelper,l=r.state.camera,c=this._cornerPosition;o.worldUpAtPosition(i,c),z(c,c,n*Math.abs(a)),j(c,c,i),this._triangleVisualElement.geometry=[[[i[0],i[1],i[2]],[c[0],c[1],c[2]],[s[0],s[1],s[2]]]],this._rightAngleQuad.geometry={previous:i,center:c,next:s};const h=new R(i,c),d=new R(c,s),u=q(i,s,c,t,l);this._segmentLabel.anchor=u.segment,this._segmentLabel.geometry={type:\"segment\",segment:e,sampleLocation:\"center\"},this._verticalLabel.geometry={type:\"segment\",segment:h,sampleLocation:\"center\"},this._verticalLabel.anchor=u.vertical,this._horizontalLabel.geometry={type:\"segment\",segment:d,sampleLocation:\"center\"},this._horizontalLabel.anchor=u.horizontal}_updateSegmentAndProjection(e){const t=this.view.renderCoordsHelper;t.setAltitude(this._startPositionAtSeaLevel,0,this._startPosition),t.setAltitude(this._endPositionAtSeaLevel,0,this._endPosition);const i=new k(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(i),this._geodesicStartHint.setGeometryFromSegment(new R(this._startPositionAtSeaLevel,this._startPosition)),this._geodesicEndHint.setGeometryFromSegment(new R(this._endPositionAtSeaLevel,this._endPosition)),this._segmentLabel.geometry={type:\"segment\",segment:i,sampleLocation:\"center\"},this._segmentLabel.anchor=1===e?\"top\":\"bottom\"}_updateLabelText(){if(1!==this._state)return;const e=this._segmentLabel,t=this._horizontalLabel,i=this._verticalLabel,s=this.messages,n=this.layerView.result;if(l(n)||l(s))return e.text=null,t.text=null,void(i.text=null);const a=this._getLabelsText(s,n),r=1===this._segmentLabelDisplayedMeasurement;e.text=r?a.euclideanDistance:a.geodesicDistance,t.text=a.horizontalDistance,i.text=a.verticalDistance,this.notifyChange(\"labels\")}_updateLabelVisibility(){if(1!==this._state)return;const e=this._segmentLabel,t=this._horizontalLabel,i=this._verticalLabel;if(e.visible=!1,t.visible=!1,i.visible=!1,this.visible)switch(this.viewMode){case 1:e.visible=!0;break;case 2:e.visible=!0,t.visible=!0,i.visible=!0;break;case 3:e.visible=!0}}_getLabelsText(e,{directDistance:t,horizontalDistance:i,verticalDistance:s,geodesicDistance:n,geodesicAngle:a}){const r=this.layerView.unit,o=e=>({euclideanDistance:\"\",geodesicDistance:\"\",horizontalDistance:\"\",verticalDistance:\"\",...e});switch(r){case\"metric\":return o({euclideanDistance:t&&g(e,t),geodesicDistance:n&&g(e,n),horizontalDistance:i&&g(e,i),verticalDistance:s&&p(e,s)});case\"imperial\":return o({euclideanDistance:t&&u(e,t),geodesicDistance:n&&u(e,n),horizontalDistance:i&&u(e,i),verticalDistance:s&&m(e,s)});case\"degrees\":{const t=a&&h(e,a,\"degrees\");return o({euclideanDistance:t,geodesicDistance:t,horizontalDistance:t})}case\"degrees-minutes-seconds\":return o({horizontalDistance:a&&d(a)});default:return o({euclideanDistance:t&&h(e,t,r),geodesicDistance:n&&h(e,n,r),horizontalDistance:i&&h(e,i,r),verticalDistance:s&&h(e,s,r)})}}_updateSegmentStripeLength(){const e=this._measurementArrowStripeLength,t=this._segmentVisualElement;o(e)?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}_computeViewMode(e){if(2===e){if(!this._geodesicDistanceExceeded)return 1;if(this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition))return 3}const t=this.layerView.result;if(l(t))return 1;const{verticalDistance:i,horizontalDistance:s}=t,n=i.value,a=s.value;return Math.min(n/a,a/n)<this.triangleCollapseRatioThreshold?1:2}_getActualVisualElementsOrientation(){if(o(this._triangleOrientationOverride))return this._triangleOrientationOverride;const e=this.visualElementOrientation;return 0===e?this.view.state.camera.aboveGround?1:2:e}_updateActualVisualizedMeasurement(){if(0===this.visualizedMeasurement){this.actualVisualizedMeasurement=1;const e=this.layerView.unit;\"degrees\"!==e&&\"degrees-minutes-seconds\"!==e||(this.actualVisualizedMeasurement=2),this._geodesicDistanceExceeded&&(this.actualVisualizedMeasurement=2)}else this.actualVisualizedMeasurement=this.visualizedMeasurement;return this.actualVisualizedMeasurement}_requiresGeodesicGuideAt(e){const t=this.view;if(!t.state)return!1;const i=t.state.camera,s=t.renderCoordsHelper,n=i.computeScreenPixelSizeAt(e);return s.getAltitude(e)/n>=10}get _measurementArrowStripeLength(){const e=this.view,{result:t,unit:i}=this.layerView;let n=null;if(o(t)){const e=t.directDistance;switch(i){case\"metric\":n=e&&e.toUnit(\"meters\");break;case\"imperial\":n=e&&e.toUnit(b(e.value,e.unit));break;case\"degrees\":case\"degrees-minutes-seconds\":{const e=t.geodesicAngle;n=e&&e.toUnit(\"degrees\");break}default:n=e&&e.toUnit(i)}}if(n){let t=1;return t=s(n.value/30),t*=\"degrees\"===n.unit?M(e.spatialReference).metersPerDegree:L(1,n.unit,\"meters\"),t}return null}_updateMessageBundle(){this.loadingMessages=!0,W(\"esri/core/t9n/Units\").then((e=>{this.messages=e,this.view&&this._updateLabelText()})).finally((()=>{this.loadingMessages=!1}))}_updateVisualElementsOpacity(){const e=this.layerView.fullOpacity,t=this._params,{triangleColor:i,geodesicProjectionLineColor:s}=t;this._triangleVisualElement.color=n(K,i,e),this._rightAngleQuad.color=n(K,B,e),n(K,s,e),this._projectedGeodesicLine.color=K,this._geodesicStartHint.color=K,this._geodesicEndHint.color=K,this._segmentVisualElement.opacity=e}};function q(e,t,i,s,n){const r=N,o=X;n.projectToRenderScreen(i,r),n.projectToRenderScreen(t,o);const l={segment:\"bottom\",horizontal:\"top\",vertical:r[0]<o[0]?\"left\":\"right\"};{const s=Y,r=Z;if(T(e,i,s,n),T(e,t,r,n),E(s,r)>=J){const e=a(s[1])===a(r[1]);l.segment=e?C(l.vertical):l.vertical}else{const e=$;T(i,t,e,n),E(e,r)>=J&&(l.segment=a(e[0])===a(r[0])?C(l.horizontal):l.horizontal)}}if(2===s){const e=e=>\"top\"===e?\"bottom\":\"top\";l.segment=e(l.segment),l.horizontal=e(l.horizontal),l.vertical=e(l.vertical)}return l}e([y()],Q.prototype,\"_state\",void 0),e([y()],Q.prototype,\"_segmentLabelDisplayedMeasurement\",void 0),e([y()],Q.prototype,\"_triangleOrientationOverride\",void 0),e([y()],Q.prototype,\"_geodesicDistanceExceeded\",null),e([y()],Q.prototype,\"messages\",void 0),e([y()],Q.prototype,\"view\",void 0),e([y()],Q.prototype,\"layer\",void 0),e([y()],Q.prototype,\"layerView\",void 0),e([y({readOnly:!0})],Q.prototype,\"ready\",null),e([y()],Q.prototype,\"loadingMessages\",void 0),e([y({readOnly:!0})],Q.prototype,\"visible\",null),e([y()],Q.prototype,\"viewMode\",void 0),e([y()],Q.prototype,\"visualizedMeasurement\",void 0),e([y()],Q.prototype,\"actualVisualizedMeasurement\",void 0),e([y()],Q.prototype,\"visualElementOrientation\",void 0),e([y()],Q.prototype,\"triangleCollapseRatioThreshold\",void 0),e([y()],Q.prototype,\"allowVisualElementsOrientationChange\",null),e([y()],Q.prototype,\"labels\",null),e([y()],Q.prototype,\"testData\",null),e([y()],Q.prototype,\"_measurementArrowStripeLength\",null),Q=e([f(\"esri.views.3d.layers.DirectLineMeasurement.DirectLineMeasurementView\")],Q);const B=A(1,.5,0,.75),I={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,triangleColor:B,triangleLineWidth:3,triangleCornerSize:32,triangleSubdivisions:128,arrowWidth:16,arrowOutlineColor:[1,.5,0,1],arrowOutlineWidth:.2,arrowStripeEvenColor:[1,1,1,1],arrowStripeOddColor:[1,.5,0,1],arrowStripeLength:16,arrowSubdivisions:128,geodesicProjectionLineWidth:2,geodesicProjectionLineColor:B,guideLineWidth:2,guideLineColor:B,guideStippleLengthPixels:6,labelDistance:25,direcLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12},J=Math.cos(r(12)),K=D(),N=_(),X=_(),Y=v(),Z=v(),$=v();export{Q as DirectLineMeasurementView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{unwrapOr as t,destroyMaybe as i}from\"../../../core/maybe.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{defaultUnitPropertyMetadata as a}from\"../../../properties/defaultUnit.js\";import{LayerView3D as r}from\"./LayerView3D.js\";import{DirectLineMeasurementController as n}from\"./analysis/DirectLineMeasurement/DirectLineMeasurementController.js\";import{DirectLineMeasurementView as o}from\"./analysis/DirectLineMeasurement/DirectLineMeasurementView.js\";import u from\"../../layers/LayerView.js\";let p=class extends(r(u)){constructor(e){super(e),this._userUnit=null,this.type=\"direct-line-measurement-3d\",this.result=null,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}set unit(e){this._userUnit=e}get unit(){return t(this._userUnit,this._defaultUnit)}get viewMode(){return this._analysisView.viewMode}get visualizedMeasurement(){return this._analysisView.visualizedMeasurement}set visualizedMeasurement(e){this._analysisView.visualizedMeasurement=e}get actualVisualizedMeasurement(){return this._analysisView.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisView.visualElementOrientation}set visualElementOrientation(e){this._analysisView.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisView.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisView.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisView.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisView.triangleCollapseRatioThreshold=e}get directLabelText(){return this._analysisView.labels.direct.text}get horizontalLabelText(){return this._analysisView.labels.horizontal.text}get verticalLabelText(){return this._analysisView.labels.vertical.text}get testData(){var e;return this.destroyed?{labels:null,stripeLength:null,view:null,controller:null}:{...null==(e=this._analysisView)?void 0:e.testData,view:this._analysisView,controller:this._analysisController}}initialize(){const e=this.view,t=this.layer;this._analysisView=new o({view:e,layer:t,layerView:this}),this._analysisController=new n({view:e,layer:t,viewData:this})}destroy(){i(this._analysisController),i(this._analysisView)}whenReady(){return this._analysisView.whenReady()}isUpdating(){var e;return!(null==(e=this._analysisView)||!e.loadingMessages)}};e([s(a)],p.prototype,\"_defaultUnit\",void 0),e([s()],p.prototype,\"_userUnit\",void 0),e([s()],p.prototype,\"_analysisView\",void 0),e([s()],p.prototype,\"_analysisController\",void 0),e([s()],p.prototype,\"type\",void 0),e([s()],p.prototype,\"unit\",null),e([s()],p.prototype,\"layer\",void 0),e([s()],p.prototype,\"result\",void 0),e([s()],p.prototype,\"elevationAlignedStartPoint\",void 0),e([s()],p.prototype,\"elevationAlignedEndPoint\",void 0),e([s({readOnly:!0})],p.prototype,\"viewMode\",null),e([s()],p.prototype,\"visualizedMeasurement\",null),e([s({readOnly:!0})],p.prototype,\"actualVisualizedMeasurement\",null),e([s()],p.prototype,\"visualElementOrientation\",null),e([s()],p.prototype,\"allowVisualElementsOrientationChange\",null),e([s()],p.prototype,\"triangleCollapseRatioThreshold\",null),e([s({readOnly:!0})],p.prototype,\"directLabelText\",null),e([s({readOnly:!0})],p.prototype,\"horizontalLabelText\",null),e([s({readOnly:!0})],p.prototype,\"verticalLabelText\",null),e([s()],p.prototype,\"testData\",null),p=e([l(\"esri.views.3d.layers.DirectLineMeasurementLayerView3D\")],p);var y=p;export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as t}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function o(){const o=new t;o.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\").add(\"width\",\"float\"),o.attributes.add(\"position\",\"vec3\"),o.attributes.add(\"normal\",\"vec3\"),o.attributes.add(\"uv0\",\"vec2\"),o.attributes.add(\"auxpos1\",\"float\"),o.varyings.add(\"vtc\",\"vec2\"),o.varyings.add(\"vlength\",\"float\"),o.varyings.add(\"vradius\",\"float\"),o.vertex.code.add(e`void main(void) {\nvec3 bitangent = normal;\nvtc = uv0;\nvlength = auxpos1;\nvradius = 0.5 * width;\nvec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);\ngl_Position = proj * pos;\n}`),o.fragment.uniforms.add(\"outlineSize\",\"float\").add(\"outlineColor\",\"vec4\").add(\"stripeLength\",\"float\").add(\"stripeEvenColor\",\"vec4\").add(\"stripeOddColor\",\"vec4\");const r=1/Math.sqrt(2);return o.fragment.code.add(e`\n    const float INV_SQRT2 = ${e.float(r)};\n\n    vec4 arrowColor(vec2 tc, float len) {\n      float d = INV_SQRT2 * (tc.x - abs(tc.y));\n      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));\n      d = min(d, 1.0 - abs(tc.y));\n\n      if (d < 0.0) {\n        return vec4(0.0);\n      } else if (d < outlineSize) {\n        return outlineColor;\n      } else {\n        return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;\n      }\n    }\n\n    void main(void) {\n      vec2 ntc = vec2(vtc.x / vradius, vtc.y);\n      vec4 color = arrowColor(ntc, vlength / vradius);\n      if (color.a == 0.0) {\n        discard;\n      }\n      gl_FragColor = color;\n    }\n  `),o}var r=Object.freeze({__proto__:null,build:o});export{r as M,o as b};\n"],"sourceRoot":""}