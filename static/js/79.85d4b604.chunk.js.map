{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightAnalysis.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightRayIntersector.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightResult.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightController.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightConfiguration.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightLayerViewData.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightView.js","../node_modules/@arcgis/core/views/3d/layers/LineOfSightLayerView3D.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js"],"names":["i","t","elevationAlignedTargetLocation","inputPoints","isValid","observer","r","observerSurfaceNormal","target","targetSurfaceNormal","observerAdjusted","targetAdjusted","computationResult","start","end","intersection","isTargetVisible","result","this","notifyChange","o","e","prototype","s","b","intersector","w","view","state","viewingMode","options","hud","store","f","get","v","camera","C","_getRayIntersection","sceneIntersectionHelper","intersectToolIntersectorRay","results","min","R","getIntersectionPoint","renderCoordsHelper","fromRenderCoords","spatialReference","n","d","a","normal","m","c","direction","p","l","I","layer","sourceLayer","type","g","objectIdField","metadata","nodeIndex","componentIndex","uid","id","ray","h","point","tile","lij","slice","j","S","T","toRenderCoords","worldUpAtPosition","basemapTerrain","elevationBounds","getAltitude","Math","abs","max","y","_canUpdateFromIntersectionResult","u","intersectedGraphic","intersectedLocation","z","_tasks","N","_handles","_analysisHandles","resourceController","scheduler","registerTask","k","LINE_OF_SIGHT_TOOL","add","_connectObserver","_connectAnalyses","_connectTargets","_intersector","V","destroy","_analyses","removeAll","updating","priority","layerViewData","analyses","observerEngineLocation","computeScreenPixelSizeAt","_observerEngineLocation","analysis","_canComputeAnalysis","_computeAnalysisIntersection","_interpolateAnalysisIntersection","updateComputationResults","emit","_screenPixelSize","U","A","interpolationInfo","L","B","_","originalIntersection","originalObserver","originalTarget","F","x","visible","D","O","elevationAlignedObserver","frustum","intersectsPoint","targets","_applyElevationAlignment","LINE_OF_SIGHT_TOOL_INTERACTIVE","hasZ","clone","H","elevationProvider","updateFromIntersectionResult","E","_adjustStartEndPositions","updateInputPoints","targetLocation","location","targetIntersection","_onTargetLocationChange","_onObserverChangeForAnalysis","observerIntersection","_onObserverEngineForAnalysis","isDirty","_isCameraDirty","on","G","extent","_onObserverChange","onElevationChange","getLineOfSightComputationDependencies","schedule","computeAnalysis","has","_connectAnalysisToTarget","_connectAnalysisToObserver","_connectAnalysisToObserverEngine","_connectAnalysisToCamera","_connectAnalysisToElevation","_connectAnalysisForCompute","remove","added","forEach","_connectAnalysis","removed","_disconnectAnalysis","items","length","_addTarget","_onTargetCollectionChange","_removeTarget","some","find","_onAnalysesCollectionChange","_onTargetsChange","cursorTarget","_onCursorTargetChange","M","EventedMixin","Z","constructOnly","P","innerWidth","outerWidth","visibleInnerColor","visibleOuterColor","occludedInnerColor","occludedOuterColor","undefinedInnerColor","undefinedOuterColor","Number","arguments","configuration","_handle","layerView","suspended","fullOpacity","_configuration","_opacity","attached","width","toUnitRGBA","visibleLineVisualElement","color","innerColor","occludedLineVisualElement","undefinedLineVisualElement","geometry","transform","createLineOfSightVisualization","getLineOfSightVisualizationDependencies","updateLineOfSightVisualization","updateVisualizationOpacity","destroyLineOfSightVisualization","moved","readOnly","_analysisController","_analysisView","handles","map","controller","_resources","_transform","object","transformation","createResources","_stage","removeMany","geometries","removeAllGeometries","createGeometries","setVisible","addMany","destroyResources","isPickable","updatePolicy","castShadow","createExternalResources","forEachExternalMaterial","dispose","destroyExternalResources","_attached","_resourcesCreated","_visible","watch","_createResources","_destroyResources","console","error","updateVisibility","_renderOccluded","_width","_color","_innerWidth","_innerColor","_stipplePattern","_stippleOffColor","_stippleIntegerRepeats","_writeDepthEnabled","_falloff","_polygonOffset","applyProps","push","lines","origin","endpoint","basis1","basis2","endRenderSpace","createRenderGeometry","points","_updateMaterial","_geometry","recreateGeometry","recreate","_material","materialParameters","_createLineGeometries","addGeometry","stippleOffColor","stipplePattern","isClosed","falloff","stippleIntegerRepeats","polygonOffset","renderOccluded","writeDepth","setParameterValues","Float64Array","attributeData","position","removeDuplicateStartEnd"],"mappings":"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","file":"static/js/79.85d4b604.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../../chunks/tslib.es6.js\";import o from\"../../../../../core/Accessor.js\";import{property as e}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as s}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{c as r}from\"../../../../../chunks/vec3f64.js\";let i=class extends o{constructor(t){super(t),this.elevationAlignedTargetLocation=null,this.inputPoints={isValid:!1,observer:r(),observerSurfaceNormal:null,target:r(),targetSurfaceNormal:null,observerAdjusted:r(),targetAdjusted:r()},this.computationResult={start:r(),end:r(),intersection:r(),isValid:!1,isTargetVisible:!1},this.result=null}updateComputationResults(){this.notifyChange(\"computationResult\")}updateInputPoints(){this.notifyChange(\"inputPoints\")}onElevationChange(){this.notifyChange(\"elevationAlignedTargetLocation\")}};t([e()],i.prototype,\"target\",void 0),t([e()],i.prototype,\"elevationAlignedTargetLocation\",void 0),t([e()],i.prototype,\"inputPoints\",void 0),t([e()],i.prototype,\"computationResult\",void 0),t([e()],i.prototype,\"result\",void 0),i=t([s(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightAnalysis\")],i);export{i as LineOfSightAnalysis};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import{isNone as r,isSome as s}from\"../../../../../core/maybe.js\";import{screenPointObjectToArray as o}from\"../../../../../core/screenUtils.js\";import{property as i}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as n}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{g as a,d as c,a as p,n as m,b as l}from\"../../../../../chunks/vec3.js\";import{c as d}from\"../../../../../chunks/vec3f64.js\";import{create as u,copy as h,fromPoints as y}from\"../../../../../geometry/support/ray.js\";import{sv2d as f}from\"../../../../../geometry/support/vectorStacks.js\";import{getObjectId as g}from\"../../../../../layers/graphics/dehydratedFeatures.js\";import{fromScreen as v}from\"../../../support/geometryUtils/ray.js\";import{tilesAreRelated as j}from\"../../../terrain/tileUtils.js\";import{Intersector as w}from\"../../../webgl-engine/lib/Intersector.js\";import{toGraphic as I}from\"../../../webgl-engine/lib/intersectorUtilsConversions.js\";let b=class extends t{constructor(e){super(e)}initialize(){this.intersector=new w(this.view.state.viewingMode),this.intersector.options.hud=!1,this.intersector.options.store=0}getScreenPointIntersection(e){const t=o(e,f.get()),r=v(this.view.state.camera,t,C);return this._getRayIntersection(r)}_getRayIntersection(e){if(r(e))return null;this.view.sceneIntersectionHelper.intersectToolIntersectorRay(e,this.intersector);const t=this.intersector.results.min,o=R;if(!t||!t.getIntersectionPoint(o))return null;const i=this.view.renderCoordsHelper.fromRenderCoords(o,this.view.spatialReference),n=d();a(n,t.normal);const m=c(n,e.direction)>0?-1:1;p(n,n,m);const l=I(t,this.view);if(s(l)){const r=l.layer,s=l.sourceLayer;let o;if(s)switch(s.type){case\"scene\":o=g(l,s.objectIdField);break;case\"integrated-mesh\":{const e=t.target;o=`${e.metadata.nodeIndex}/${e.metadata.componentIndex}`;break}default:o=l.uid}else o=l.uid;return{type:\"Graphic\",id:`${r.uid}/${o}`,ray:h(e),normal:n,point:i}}if(\"TerrainRenderer\"===t.intersector){return{type:\"Terrain\",id:t.target.metadata.tile.lij.slice(),ray:h(e),normal:n,point:i}}return null}_canUpdateFromIntersectionResult(e,t){if(r(e)||!t||e.type!==t.type)return!1;switch(e.type){case\"Terrain\":{const r=e.id,s=t.id;return r[0]===s[0]&&r[1]===s[1]&&r[2]===s[2]||j(r,s)}case\"Graphic\":case\"I3S\":return e.id===t.id}}updateFromIntersectionResult(e){let t;if(\"Terrain\"===e.type&&s(e.point)){const r=R,s=S,o=T;this.view.renderCoordsHelper.toRenderCoords(e.point,s),this.view.renderCoordsHelper.worldUpAtPosition(s,o);const i=this.view.basemapTerrain.elevationBounds,n=this.view.renderCoordsHelper.getAltitude(s),a=i?Math.abs(i.max-i.min)/Math.abs(n):100,c=n>0?1:-1;m(o,o),p(o,o,c*a),l(r,s,o),y(r,s,C),t=this._getRayIntersection(C)}else t=this._getRayIntersection(e.ray);return this._canUpdateFromIntersectionResult(t,e)?t.point:null}};e([i()],b.prototype,\"view\",void 0),e([i()],b.prototype,\"intersector\",void 0),b=e([n(\"esri.views.3d.interactive.analysisTools.lineOfSight.LineOfSightRayIntersector\")],b);const R=d(),S=d(),T=d(),C=u();export{b as LineOfSightRayIntersector};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import e from\"../../../../../core/Accessor.js\";import{property as t}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as r}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let s=class extends e{constructor(o){super(o),this.target=null,this.intersectedGraphic=null,this.intersectedLocation=null,this.elevationAlignedTargetLocation=null}};o([t()],s.prototype,\"target\",void 0),o([t()],s.prototype,\"intersectedGraphic\",void 0),o([t()],s.prototype,\"intersectedLocation\",void 0),o([t()],s.prototype,\"elevationAlignedTargetLocation\",void 0),o([t()],s.prototype,\"visible\",void 0),s=o([r(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightResult\")],s);export{s as LineOfSightResult};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../geometry.js\";import t from\"../../../../../core/Accessor.js\";import s from\"../../../../../core/Evented.js\";import r from\"../../../../../core/Handles.js\";import{handlesGroup as n,makeHandle as i}from\"../../../../../core/handleUtils.js\";import{isSome as o,isNone as a,unwrapOr as l,abortMaybe as c,removeMaybe as h,none as p}from\"../../../../../core/maybe.js\";import{createTask as g,ignoreAbortErrors as u}from\"../../../../../core/promiseUtils.js\";import{property as d}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as y}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as m,reaction as _}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{g as v,f,n as A,a as b,b as T,j as C,w as O}from\"../../../../../chunks/vec3.js\";import{a as E,c as w}from\"../../../../../chunks/vec3f64.js\";import{projectBoundingRect as j}from\"../../../../../geometry/projection.js\";import{containsPointObject as I,empty as S}from\"../../../../../geometry/support/aaBoundingRect.js\";import{fromPoints as L,create as P}from\"../../../../../geometry/support/ray.js\";import{LineOfSightAnalysis as R}from\"./LineOfSightAnalysis.js\";import{LineOfSightRayIntersector as V}from\"./LineOfSightRayIntersector.js\";import{LineOfSightResult as D}from\"./LineOfSightResult.js\";import{getElevationAtPoint as H}from\"../../../support/ElevationProvider.js\";import{toGraphic as x}from\"../../../webgl-engine/lib/intersectorUtilsConversions.js\";import{ImmediateTask as N,TaskPriority as k}from\"../../../../support/Scheduler.js\";import F from\"../../../../../geometry/Point.js\";let z=class extends(s.EventedMixin(t)){constructor(e){super(e),this._tasks=N,this._handles=new r,this._analysisHandles=new r}initialize(){var e;const t=null==(e=this.view.resourceController)?void 0:e.scheduler;t&&(this._tasks=t.registerTask(k.LINE_OF_SIGHT_TOOL));this._handles.add([this._connectObserver(),this._connectAnalyses(),this._connectTargets()]),this._intersector=new V({view:this.view})}destroy(){this._handles.destroy(),this._analysisHandles.destroy(),this._analyses.removeAll()}get updating(){return this._tasks.updating}get priority(){return this._tasks.priority}set priority(e){this._tasks.priority=e}get _analyses(){return this.layerViewData.analyses}get _observerEngineLocation(){return this.layerViewData.observerEngineLocation}set _observerEngineLocation(e){this.layerViewData.observerEngineLocation=e}get _screenPixelSize(){return this.view.state.camera.computeScreenPixelSizeAt(this._observerEngineLocation)}getLineOfSightComputationDependencies(e){const{inputPoints:t}=e;return{inputPoints:t}}computeAnalysis(e){const{analysis:t}=e,{inputPoints:s,computationResult:r}=t,{observerAdjusted:n,targetAdjusted:i}=s,{start:o,end:a}=r;v(o,n),v(a,i);this._canComputeAnalysis(t)?this._computeAnalysisIntersection(e):this._interpolateAnalysisIntersection(e),t.updateComputationResults(),this.emit(\"result-changed\",{target:e.analysis.target,result:t.result})}_adjustStartEndPositions(e){const t=this._screenPixelSize,s=this.view,{inputPoints:r}=e,{observer:n,observerSurfaceNormal:i,target:a,targetSurfaceNormal:l,observerAdjusted:c,targetAdjusted:h}=r,p=U;o(i)?v(p,i):f(p,a,n);const g=t;A(p,p),b(p,p,Math.min(g,1)),T(c,n,p),o(l)?v(p,l):f(p,n,a);const u=s.state.camera.computeScreenPixelSizeAt(a);A(p,p),b(p,p,Math.min(u,1)),T(h,a,p)}_computeAnalysisIntersection({analysis:e,interpolationInfo:t}){const{view:s}=this,{sceneIntersectionHelper:r,renderCoordsHelper:n}=s;if(a(r))return;const i=this._intersector.intersector,{computationResult:l,inputPoints:c}=e,{observer:h,target:p}=c,{start:g,end:u}=l,d=L(g,u,B);r.intersectToolIntersectorRay(d,i);const y=l.intersection,m=U,_=!!i.results.min&&i.results.min.getIntersectionPoint(y);let f=!0;if(_){v(t.originalIntersection,y),v(t.originalObserver,g),v(t.originalTarget,u),n.fromRenderCoords(y,m,s.spatialReference);const e=1-C(u,p)/C(g,p);f=C(h,y)>=e*C(h,p)}const A=new F(m,s.spatialReference);{const{result:t,target:r}=e;o(t)?(t.target=r,t.intersectedGraphic=f?null:x(i.results.min,s),t.intersectedLocation=f?null:A,t.visible=!!_&&f):e.result=new D({target:r,elevationAlignedTargetLocation:e.elevationAlignedTargetLocation,intersectedGraphic:f?null:x(i.results.min,s),intersectedLocation:f?null:A,visible:!!_&&f})}l.isValid=c.isValid=!0,l.isTargetVisible=f}_interpolateAnalysisIntersection({analysis:e,interpolationInfo:t}){const{computationResult:s,inputPoints:r}=e,{start:n,end:i,intersection:o}=s,{originalIntersection:a,originalObserver:l,originalTarget:c}=t;if(v(o,a),r.isValid){const e=U,t=C(l,a)/C(l,c);O(e,n,l),b(e,e,1-t),T(o,o,e),O(e,i,c),b(e,e,t),T(o,o,e),s.isValid=!0}else e.result=new D,s.isValid=!1,s.isTargetVisible=!1}_canComputeAnalysis(e){const t=this.layerViewData.elevationAlignedObserver,s=this.view.frustum;if(a(t)||a(e.target)||a(s))return!1;const{observerAdjusted:r,targetAdjusted:n}=e.inputPoints,i=s.intersectsPoint(r),o=s.intersectsPoint(n);return i&&o}_onObserverChange(e){if(a(e))return this.layer.targets.removeAll(),void(this.layerViewData.elevationAlignedObserver=null);this.layerViewData.elevationAlignedObserver=this._applyElevationAlignment(e,this.layer.intersection);const t=w();this.view.renderCoordsHelper.toRenderCoords(this.layerViewData.elevationAlignedObserver,t),this._observerEngineLocation=t,this.priority=k.LINE_OF_SIGHT_TOOL_INTERACTIVE}_applyElevationAlignment(e,t){if(e.hasZ&&(a(t)||\"Graphic\"===t.type))return e;const s=e.clone();return s.z=l(H(this.view.elevationProvider,s),0),s}_onObserverChangeForAnalysis(e){e.inputPoints.isValid=!1}_onObserverEngineForAnalysis(e,t,s){const{inputPoints:r}=e;if(v(r.observer,t),o(s)){const e=this._intersector.updateFromIntersectionResult(s);o(e)&&this.view.renderCoordsHelper.toRenderCoords(e,r.observer),r.observerSurfaceNormal=E(s.normal)}else r.observerSurfaceNormal=null;this._adjustStartEndPositions(e),e.updateInputPoints(),this.priority=k.LINE_OF_SIGHT_TOOL_INTERACTIVE}_onTargetLocationChange(e,t,s){const{inputPoints:r}=e;if(r.isValid=!1,o(t)){if(e.elevationAlignedTargetLocation=this._applyElevationAlignment(t,s),this.view.renderCoordsHelper.toRenderCoords(e.elevationAlignedTargetLocation,r.target),o(s)){const e=this._intersector.updateFromIntersectionResult(s);o(e)&&this.view.renderCoordsHelper.toRenderCoords(e,r.target),r.targetSurfaceNormal=E(s.normal)}else r.targetSurfaceNormal=null;this._adjustStartEndPositions(e),e.updateInputPoints()}this.priority=k.LINE_OF_SIGHT_TOOL_INTERACTIVE}_connectAnalysisToTarget(e){return m((()=>({analysis:e,targetLocation:e.target.location,targetIntersection:e.target.intersection})),(({analysis:e,targetLocation:t,targetIntersection:s})=>{o(t)&&this._onTargetLocationChange(e,t,s)}))}_connectAnalysisToObserver(e){return m((()=>({analysis:e,observer:this.layerViewData.elevationAlignedObserver})),(({analysis:e})=>{this._onObserverChangeForAnalysis(e)}))}_connectAnalysisToObserverEngine(e){return m((()=>({analysis:e,observer:this._observerEngineLocation,observerIntersection:this.layer.intersection})),(({analysis:e,observer:t,observerIntersection:s})=>{this._onObserverEngineForAnalysis(e,t,s)}))}_connectAnalysisToCamera(e){return _((()=>({camera:this.view.state.camera,isDirty:this._isCameraDirty})),(({isDirty:t})=>{e.inputPoints.isValid&&!t||e.updateInputPoints()}))}_connectAnalysisToElevation(e){return this.view.elevationProvider.on(\"elevation-change\",(t=>{if(!this._canComputeAnalysis(e))return;const s=this.layer.observer;G(t.extent,t.spatialReference,s)&&this._onObserverChange(s);const r=e.target;o(r)&&G(t.extent,t.spatialReference,r.location)&&e.onElevationChange()}))}_connectAnalysisForCompute(e){let t=p;const s={analysis:e,interpolationInfo:{originalIntersection:w(),originalObserver:w(),originalTarget:w()}};return n([m((()=>this.getLineOfSightComputationDependencies(e)),(()=>{t=c(t),t=g((async e=>{await u(this._tasks.schedule((()=>this.computeAnalysis(s)),e))}))})),i((()=>t=c(t)))])}_connectAnalysis(e){const t=this._analysisHandles;t.has(e)||t.add([this._connectAnalysisToTarget(e),this._connectAnalysisToObserver(e),this._connectAnalysisToObserverEngine(e),this._connectAnalysisToCamera(e),this._connectAnalysisToElevation(e),this._connectAnalysisForCompute(e)])}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_onAnalysesCollectionChange(e){e.added.forEach((e=>this._connectAnalysis(e))),e.removed.forEach((e=>this._disconnectAnalysis(e)))}_onTargetsChange(e){return this._analyses.removeAll(),e.items.length>0&&e.forEach((e=>this._addTarget(e))),e.on(\"change\",(e=>this._onTargetCollectionChange(e)))}_onTargetCollectionChange(e){e.added.forEach((e=>this._addTarget(e))),e.removed.forEach((e=>this._removeTarget(e)))}_onCursorTargetChange(e,t){o(t)&&this._removeTarget(t),o(e)&&this._addTarget(e)}_addTarget(e){const t=this._analyses;t.some((t=>t.target===e))||t.add(new R({target:e}))}_removeTarget(e){const t=this._analyses,s=t.find((t=>t.target===e));t.remove(s)}_connectObserver(){return n([m((()=>this.layer.observer),(e=>this._onObserverChange(e)))])}_connectAnalyses(){let e=null;return n([m((()=>this._analyses),(t=>{e=h(e),e=t.on(\"change\",(e=>this._onAnalysesCollectionChange(e))),t.forEach((e=>this._connectAnalysis(e)))})),i((()=>e=h(e)))])}_connectTargets(){let e=null;return n([m((()=>this.layer.targets),(t=>{e=h(e),e=this._onTargetsChange(t)})),m((()=>this.layerViewData.cursorTarget),((e,t)=>{this._onCursorTargetChange(e,t)})),i((()=>{e=h(e)}))])}get _isCameraDirty(){const e=this.layerViewData.elevationAlignedObserver,{view:t}=this,{renderCoordsHelper:s}=t;if(a(e)||a(s))return!1;const r=U;s.toRenderCoords(e,r);const n=t.state.camera.computeScreenPixelSizeAt(r);return Math.abs((n-this._screenPixelSize)/this._screenPixelSize)>M}};function G(e,t,s){return!a(s)&&(j(e,t,Z,s.spatialReference),I(Z,s))}e([d({constructOnly:!0})],z.prototype,\"layer\",void 0),e([d({constructOnly:!0})],z.prototype,\"layerViewData\",void 0),e([d({constructOnly:!0})],z.prototype,\"view\",void 0),e([d()],z.prototype,\"updating\",null),e([d()],z.prototype,\"priority\",null),e([d()],z.prototype,\"_analyses\",null),e([d()],z.prototype,\"_observerEngineLocation\",null),e([d()],z.prototype,\"_screenPixelSize\",null),e([d()],z.prototype,\"_tasks\",void 0),e([d()],z.prototype,\"_isCameraDirty\",null),z=e([y(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightController\")],z);const M=.1,U=w(),B=P(),Z=S();export{z as LineOfSightController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import e from\"../../../../../Color.js\";import r from\"../../../../../core/Accessor.js\";import{property as t}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as i}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let s=class extends r{constructor(o){super(o),this.innerWidth=2,this.outerWidth=8,this.visibleInnerColor=new e([3,252,111,1]),this.visibleOuterColor=new e([3,252,111,.15]),this.occludedInnerColor=new e([252,3,69,1]),this.occludedOuterColor=new e([252,3,69,.1]),this.undefinedInnerColor=new e([255,255,255,1]),this.undefinedOuterColor=new e([127,127,127,.2])}};o([t({type:Number})],s.prototype,\"innerWidth\",void 0),o([t({type:Number})],s.prototype,\"outerWidth\",void 0),o([t({type:e})],s.prototype,\"visibleInnerColor\",void 0),o([t({type:e})],s.prototype,\"visibleOuterColor\",void 0),o([t({type:e})],s.prototype,\"occludedInnerColor\",void 0),o([t({type:e})],s.prototype,\"occludedOuterColor\",void 0),o([t({type:e})],s.prototype,\"undefinedInnerColor\",void 0),o([t({type:e})],s.prototype,\"undefinedOuterColor\",void 0),s=o([i(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightConfiguration\")],s);export{s as LineOfSightConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import r from\"../../../../../core/Accessor.js\";import e from\"../../../../../core/Collection.js\";import{property as s}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as t}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{c as i}from\"../../../../../chunks/vec3f64.js\";import{LineOfSightConfiguration as c}from\"./LineOfSightConfiguration.js\";let n=class extends r{constructor(){super(...arguments),this.analyses=new e,this.elevationAlignedObserver=null,this.configuration=new c,this.observerEngineLocation=i(),this.cursorTarget=null}};o([s()],n.prototype,\"analyses\",void 0),o([s()],n.prototype,\"elevationAlignedObserver\",void 0),o([s({type:c})],n.prototype,\"configuration\",void 0),o([s()],n.prototype,\"observerEngineLocation\",void 0),o([s()],n.prototype,\"cursorTarget\",void 0),n=o([t(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightLayerViewData\")],n);export{n as LineOfSightLayerViewData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import i from\"../../../../../Color.js\";import t from\"../../../../../core/Accessor.js\";import o from\"../../../../../core/Handles.js\";import{makeHandle as n,handlesGroup as s}from\"../../../../../core/handleUtils.js\";import{applyOpacity as l}from\"../../../../../core/mathUtils.js\";import{removeMaybe as r,destroyMaybe as a}from\"../../../../../core/maybe.js\";import{property as c}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as u}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as d,reaction as m}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{c as h}from\"../../../../../chunks/mat4f64.js\";import{f as p}from\"../../../../../chunks/vec3.js\";import{d as y,c as f}from\"../../../../../chunks/vec3f64.js\";import{LineVisualElement as v}from\"../../../interactive/visualElements/LineVisualElement.js\";let V=class extends t{constructor(e){super(e),this._handle=null,this._analysisHandles=new o}initialize(){this._handle=this._connectAnalyses()}destroy(){this._handle=r(this._handle),this._analysisHandles=a(this._analysisHandles)}get visible(){return this.layerView.visible&&!this.layerView.suspended}get _analyses(){return this.layerView.layerViewData.analyses}get _configuration(){return this.layerView.layerViewData.configuration}get _opacity(){return this.layerView.fullOpacity}createLineOfSightVisualization(){const e=this._configuration,t=this._opacity,o={view:this.view,attached:!0,width:e.outerWidth,innerWidth:e.innerWidth},n=i.toUnitRGBA(e.visibleOuterColor);l(n,n,t);const s=i.toUnitRGBA(e.visibleInnerColor);l(s,s,t);const r=i.toUnitRGBA(e.occludedOuterColor);l(r,r,t);const a=i.toUnitRGBA(e.occludedInnerColor);l(a,a,t);const c=i.toUnitRGBA(e.undefinedOuterColor);l(c,c,t);const u=i.toUnitRGBA(e.undefinedInnerColor);l(u,u,t);return{visibleLineVisualElement:new v({...o,color:n,innerColor:s}),occludedLineVisualElement:new v({...o,color:r,innerColor:a}),undefinedLineVisualElement:new v({...o,color:c,innerColor:u})}}destroyLineOfSightVisualization(e){e.visibleLineVisualElement=a(e.visibleLineVisualElement),e.occludedLineVisualElement=a(e.occludedLineVisualElement),e.undefinedLineVisualElement=a(e.undefinedLineVisualElement)}updateLineOfSightVisualization(e,t){const o=this.visible,n=this._configuration,{computationResult:s,inputPoints:r}=e,{start:a,end:c,intersection:u,isValid:d,isTargetVisible:m}=s,{observer:h}=r,f=C;f[12]=h[0],f[13]=h[1],f[14]=h[2];const v=p(g,a,h),V=p(_,c,h),L=p(b,u,h),{visibleLineVisualElement:O,occludedLineVisualElement:A,undefinedLineVisualElement:E}=t;if(!o)return O.visible=!1,A.visible=!1,void(E.visible=!1);if(O.visible=!0,A.visible=!0,E.visible=!0,O.geometry=null,A.geometry=null,E.geometry=null,d)if(m){O.geometry=[[y(v),y(V)]],O.transform=f;const e=i.toUnitRGBA(n.visibleOuterColor);O.color=l(e,e,this._opacity)}else{O.geometry=[[y(v),y(L)]],O.transform=f;const e=i.toUnitRGBA(n.occludedOuterColor);O.color=l(e,e,this._opacity),A.geometry=[[y(L),y(V)]],A.transform=f}else E.geometry=[[y(v),y(V)]],E.transform=f}updateVisualizationOpacity(e,t){const o=this._configuration,n=this._opacity,s=i.toUnitRGBA(o.visibleOuterColor);l(s,s,n);const r=i.toUnitRGBA(o.visibleInnerColor);l(r,r,n);const a=i.toUnitRGBA(o.occludedOuterColor);l(a,a,n);const c=i.toUnitRGBA(o.occludedInnerColor);l(c,c,n);const u=i.toUnitRGBA(o.undefinedOuterColor);l(u,u,n);const d=i.toUnitRGBA(o.undefinedInnerColor);l(d,d,n),t.visibleLineVisualElement.color=e.computationResult.isTargetVisible?s:a,t.visibleLineVisualElement.innerColor=r,t.occludedLineVisualElement.color=a,t.occludedLineVisualElement.innerColor=c,t.undefinedLineVisualElement.color=u,t.undefinedLineVisualElement.innerColor=d}getLineOfSightVisualizationDependencies(e){const{computationResult:i}=e,{occludedOuterColor:t,visibleOuterColor:o}=this._configuration;return{computationResult:i,occludedOuterColor:t,visibleOuterColor:o,visible:this.visible}}_connectAnalysis(e){const i=this._analysisHandles;if(i.has(e))return;const t=this.createLineOfSightVisualization();i.add([d((()=>this.getLineOfSightVisualizationDependencies(e)),(()=>this.updateLineOfSightVisualization(e,t))),m((()=>this._opacity),(()=>this.updateVisualizationOpacity(e,t))),n((()=>this.destroyLineOfSightVisualization(t)))],e)}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_connectAnalyses(){let e=null;return s([d((()=>this._analyses),(i=>{e=r(e),e=i.on(\"change\",(e=>this._onAnalysesCollectionChange(e))),this._onAnalysesCollectionChange({target:i,added:i.items,removed:[],moved:[]})})),n((()=>e=r(e)))])}_onAnalysesCollectionChange(e){e.added.forEach((e=>this._connectAnalysis(e))),e.removed.forEach((e=>this._disconnectAnalysis(e)))}};e([c({constructOnly:!0})],V.prototype,\"layer\",void 0),e([c({constructOnly:!0})],V.prototype,\"layerView\",void 0),e([c({constructOnly:!0})],V.prototype,\"view\",void 0),e([c({readOnly:!0})],V.prototype,\"visible\",null),e([c()],V.prototype,\"_analyses\",null),e([c()],V.prototype,\"_configuration\",null),e([c()],V.prototype,\"_opacity\",null),V=e([u(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightView\")],V);const g=f(),_=f(),b=f(),C=h();export{V as LineOfSightView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import{destroyMaybe as e,applySome as t,unwrapOr as s,mapOr as i}from\"../../../core/maybe.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as l}from\"./LayerView3D.js\";import{LineOfSightController as n}from\"./analysis/LineOfSight/LineOfSightController.js\";import{LineOfSightLayerViewData as y}from\"./analysis/LineOfSight/LineOfSightLayerViewData.js\";import{LineOfSightView as p}from\"./analysis/LineOfSight/LineOfSightView.js\";import h from\"../../layers/LayerView.js\";let u=class extends(l(h)){constructor(){super(...arguments),this.type=\"line-of-sight-3d\",this.layerViewData=new y}initialize(){const r=this.view,e=this.layer;this._analysisController=new n({layer:e,layerViewData:this.layerViewData,view:r}),this._analysisView=new p({layer:e,layerView:this,view:r}),this.handles.add([this._analysisController.on(\"result-changed\",(r=>{r.target!==this.layerViewData.cursorTarget&&this.emit(\"result-changed\",r)}))])}destroy(){this._analysisController=e(this._analysisController),this._analysisView=e(this._analysisView)}get results(){return this.layerViewData.analyses.map((r=>r.result))}get priority(){return this._analysisController.priority}set priority(r){this._analysisController.priority=r}getResultForTarget(r){const e=this.layerViewData.analyses.find((e=>e.target===r)),i=t(e,(r=>r.result));return s(i,null)}isUpdating(){return i(this._analysisController,!1,(r=>r.updating))}get testData(){return{view:this._analysisView,controller:this._analysisController}}};r([a({readOnly:!0})],u.prototype,\"type\",void 0),r([a()],u.prototype,\"layer\",void 0),r([a({readOnly:!0})],u.prototype,\"results\",null),r([a()],u.prototype,\"priority\",null),r([a()],u.prototype,\"layerViewData\",void 0),r([a()],u.prototype,\"_analysisController\",void 0),r([a()],u.prototype,\"_analysisView\",void 0),u=r([o(\"esri.views.3d.layers.LineOfSightLayerView3D\")],u);var w=u;export{u as LineOfSightLayerView3D,w as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as s}from\"../../../../core/maybe.js\";import{e as r}from\"../../../../chunks/mat4.js\";import{c as t}from\"../../../../chunks/mat4f64.js\";import{VisualElement as o}from\"./VisualElement.js\";import{Object3D as i}from\"../../webgl-engine/lib/Object3D.js\";import{WebGLLayer as a}from\"../../webgl-engine/lib/WebGLLayer.js\";class c extends o{constructor(e){super(e.view),this._resources=null,this._transform=t()}get object(){return e(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){r(this._transform,s),e(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(s(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new a({isPickable:!1,updatePolicy:1});e.add(s);const r=new i({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;!s(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){s(this._resources)||this._resources.object.setVisible(e)}}export{c as Object3DVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nclass t{constructor(t){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch(\"ready\",(t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())}))}applyProps(t){let e=!1;for(const s in t)s in this?\"attached\"===s?e=t[s]:this[s]=t[s]:console.error(\"Cannot set unknown property\",s);this.attached=e}destroy(){this.attached=!1}get attached(){return this._attached}set attached(t){t!==this._attached&&this.view._stage&&(this._attached=t,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.attached&&this.updateVisibility(t))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}export{t as VisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../core/maybe.js\";import{i as r,t as s}from\"../../../../chunks/mat4.js\";import{c as i}from\"../../../../chunks/mat4f64.js\";import{s as o}from\"../../../../chunks/vec3.js\";import{Z as n,c as h}from\"../../../../chunks/vec3f64.js\";import{g as l,c as a}from\"../../../../chunks/vec4.js\";import{f as p,c as d,a as f}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as _}from\"./Object3DVisualElement.js\";import{createGeometry as c}from\"../../layers/graphics/lineUtils.js\";import{RibbonLineMaterial as u}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";class m extends _{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=p(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stippleIntegerRepeats=!1,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromRenderSpacePoint(e){const t=1e3,r=[];r.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),r.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),r.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=r}setGeometryFromExtent(e){const t=this.view.spatialReference,r=h(),s=h(),i=100,n=[];o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),this.geometry=[n]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],r=e.origin,s=e.basis1,i=e.basis2,o=.5,n=h(),l=h(),a=h(),p=h();n[0]=r[0]-s[0]*o-i[0]*o,n[1]=r[1]-s[1]*o-i[1]*o,n[2]=r[2]-s[2]*o-i[2]*o,l[0]=r[0]-s[0]*o+i[0]*o,l[1]=r[1]-s[1]*o+i[1]*o,l[2]=r[2]-s[2]*o+i[2]*o,a[0]=r[0]+s[0]*o+i[0]*o,a[1]=r[1]+s[1]*o+i[1]*o,a[2]=r[2]+s[2]*o+i[2]*o,p[0]=r[0]+s[0]*o-i[0]*o,p[1]=r[1]+s[1]*o-i[1]*o,p[2]=r[2]+s[2]*o-i[2]*o,t.push([n[0],n[1],n[2]]),t.push([l[0],l[1],l[2]]),t.push([a[0],a[1],a[2]]),t.push([p[0],p[1],p[2]]),t.push([n[0],n[1],n[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;r(g),s(g,g,t),this.transform=g;const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=n){r(g),s(g,g,t),this.transform=g,this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){l(e,this._color)||(a(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(r){e(r)?!t(this._innerColor)&&l(r,this._innerColor)||(this._innerColor=a(d(),r),this._updateMaterial()):e(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const r=e(t)!==e(this._stipplePattern);this._stipplePattern=t,r?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(r){(t(r)||t(this._stippleOffColor)||!l(r,this._stippleOffColor))&&(this._stippleOffColor=e(r)?f(r):null,this._updateMaterial())}get stippleIntegerRepeats(){return this._stippleIntegerRepeats}set stippleIntegerRepeats(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new u(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){const t=this._createLineGeometries();if(0!==t.length)for(let r=0;r<t.length;++r){const s=c(t[r]);e.addGeometry(s,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameterValues(this.materialParameters)}_createLineGeometries(){const e=this.geometry;if(t(e)||0===e.length)return[];const r=[];return e.forEach((e=>{const t=e.length,s=new Float64Array(3*t);e.forEach(((e,t)=>{s[3*t+0]=e[0],s[3*t+1]=e[1],s[3*t+2]=e[2]}));const i={attributeData:{position:s},removeDuplicateStartEnd:0};r.push(i)})),r}}const g=i();export{m as LineVisualElement};\n"],"sourceRoot":""}