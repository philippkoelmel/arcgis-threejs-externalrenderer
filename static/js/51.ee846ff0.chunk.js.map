{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/ImageMaterial.js","../node_modules/@arcgis/core/views/3d/interactive/Manipulator3D.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/ShadedColorMaterial.js","../node_modules/@arcgis/core/views/3d/interactive/manipulatorUtils.js","../node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/sliceToolConfig.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/SlicePlaneMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/SlicePlaneMaterial.js","../node_modules/@arcgis/core/widgets/Slice/SlicePlane.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/SlicePlaneVisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/sliceToolUtils.js","../node_modules/@arcgis/core/views/3d/interactive/graphics/Slice/SliceController.js","../node_modules/@arcgis/core/views/3d/interactive/graphics/Slice/SliceView.js","../node_modules/@arcgis/core/views/3d/layers/analysis/Slice/SliceLayerViewData.js","../node_modules/@arcgis/core/views/3d/layers/SliceLayerView3D.js","../node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js","../node_modules/@arcgis/core/portal/support/resourceExtension.js","../node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js","../node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js","../node_modules/@arcgis/core/layers/support/I3SIndexInfo.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js","../node_modules/@arcgis/core/chunks/ShadedColorMaterial.glsl.js","../node_modules/@arcgis/core/chunks/SlicePlaneMaterial.glsl.js"],"names":["E","e","t","shader","get","r","this","configuration","i","build","output","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","OITEnabled","transparencyPassType","multipassTerrainEnabled","cullAboveGround","m","rctx","p","program","camera","projectionMatrix","setUniform1f","opacity","setUniform2fv","nearFar","inverseViewport","s","rebindTextures","P","blending","transparent","w","c","culling","v","cullFace","depthTest","func","u","depthWrite","writeDepth","j","d","colorWrite","S","stencilWrite","sceneHasOcludees","b","stencilTest","f","g","polygonOffset","h","enableOffset","_occludeePipelineState","setPipelineState","pipeline","o","a","y","T","O","arguments","l","n","count","prototype","supportsEdges","techniqueConfig","params","relativeElevation","material","updateParameters","_material","updateTexture","textureId","_technique","_techniqueRep","releaseAndAcquire","getTechniqueConfig","_output","hasOccludees","setParameterValues","_updateOccludeeState","bindTextures","bindTextureScale","bindPass","getPipelineState","initTextureTransparent","M","U","_","W","X","x","z","spatialReference","screenSizeEnabled","shadingEnabled","color","shadingTint","shadingDirection","setUniform4fv","blendColor","setUniform3fv","setUniformMatrix4fv","viewInverseTransposeMatrix","origin","Map","q","getPassParameters","C","screenSize","vec3f","vertexBufferLayout","createBuffer","indices","length","transformation","invTranspTransformation","vertexAttributes","has","Error","size","getField","data","Math","cos","backgroundColor","gridColor","gridWidth","constructionContext","_renderOccluded","_gridWidth","_gridColor","_backgroundColor","applyProps","_updateMaterial","materialParameters","createSquareGeometry","addGeometry","renderOccluded","type","position","heading","tilt","width","height","equals","readOnly","json","read","write","Number","nonNullable","range","min","max","normalize","xe","getLogger","De","worldUpAtPosition","B","basis1","mt","round","yt","L","st","Pe","view","attached","ne","writeDepthEnabled","geometry","D","basis2","dt","gt","toRenderCoords","worldBasisAtPosition","I","plane","F","G","error","wkid","PI","V","_handles","_internalChange","_currentSlicePlane","state","add","layerView","layerViewData","excludedLayers","on","item","title","id","preventDefault","includes","_initialize","set","all","activeController","push","watch","_updateSlicePlaneFromBoundedPlane","_updateLayerViews","_updateActiveController","_updateViewSlicePlane","allLayerViews","analysis","_updateBoundedPlaneFromSlicePlane","_set","active","lastIndexOf","splice","delete","destroy","slicePlane","hasZ","clone","Te","elevationProvider","renderCoordsHelper","console","warn","tiltEnabled","Fe","Ge","fromRenderCoords","visible","forEach","layers","indexOf","layer","sublayerViews","sublayer","basemapTerrain","excludeGroundSurface","_gridVisualElement","_outlineVisualElement","_updateMaterials","Oe","ce","le","fullOpacity","_updatePlane","N","k","transform","editable","stipplePattern","showGrid","value","_get","cast","analysisView","analysisController","_initialized","resolve","destroyed","promise","whenReady","controller","aliasOf","Blob","url","png","jpeg","jpg","bmp","gif","txt","xml","svg","zip","pbf","gz","origins","String","writer","resources","verifyItemRelativeUrls","writtenUrls","rootPath","originIdOf","portalItem","resourceFromPath","path","toUpdate","toKeep","resource","pendingOperations","then","itemRelativeUrl","catch","toAdd","content","finish","R","JSON","stringify","toJSON","default","responseType","_resources","_transform","object","createResources","_stage","removeMany","geometries","removeAllGeometries","createGeometries","setVisible","addMany","destroyResources","isPickable","updatePolicy","castShadow","createExternalResources","forEachExternalMaterial","remove","dispose","destroyExternalResources","_attached","_resourcesCreated","_visible","_createResources","_destroyResources","updateVisibility","_width","_color","_innerWidth","_innerColor","_stipplePattern","_stippleOffColor","_stippleIntegerRepeats","_writeDepthEnabled","_falloff","_polygonOffset","lines","endpoint","endRenderSpace","createRenderGeometry","points","map","_geometry","recreateGeometry","recreate","_createLineGeometries","stippleOffColor","isClosed","falloff","innerColor","innerWidth","stippleIntegerRepeats","Float64Array","attributeData","removeDuplicateStartEnd","include","linearDepth","vertex","uniforms","attributes","varyings","code","fragment","float","Object","freeze","__proto__","floor","rootIndex","nodesPerPage","query","token","signal","lodSelectionMetricType","rootPage","pageSize","lodMetric","urlPrefix","split","pop","rootNode","pageError","nodeError","perScreenPixelRatio","extensions"],"mappings":"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","file":"static/js/51.ee846ff0.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as r}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as i,bindView as s}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as a}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as n,ShaderTechniqueConfiguration as l}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as p}from\"../lib/DefaultVertexAttributeLocations.js\";import{OITBlending as c,OITDepthTest as u,OITDepthWrite as d,getOITPolygonOffset as h}from\"../lib/OrderIndependentTransparency.js\";import{Program as m}from\"../lib/Program.js\";import{stencilWriteMaskOn as b,stencilToolMaskBaseParams as f,stencilBaseAllZerosParams as g}from\"../lib/StencilUtils.js\";import{I as y}from\"../../../../chunks/ImageMaterial.glsl.js\";import{simpleBlendingParams as T,makePipelineState as P,cullingParams as v,defaultDepthWriteParams as j,defaultColorWriteParams as S}from\"../../../webgl/renderState.js\";class E extends o{initializeProgram(e){const t=E.shader.get(),r=this.configuration,i=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new m(e.rctx,i,p)}bindPass(e,t){i(this.program,t.camera.projectionMatrix),this.program.setUniform1f(\"opacity\",e.opacity),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),r(this.program,t))}bindDraw(e){s(this.program,e),t(this.program,this.configuration,e),this.program.rebindTextures()}setPipelineState(e,t){const r=this.configuration,i=3===e,s=2===e;return P({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?w:c(e),culling:v(r.cullFace),depthTest:{func:u(e)},depthWrite:i?r.writeDepth&&j:d(e),colorWrite:S,stencilWrite:r.sceneHasOcludees?b:null,stencilTest:r.sceneHasOcludees?t?f:g:null,polygonOffset:i||s?null:h(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}E.shader=new a(y,(()=>import(\"./ImageMaterial.glsl.js\")));const w=T(1,771);class O extends l{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([n({count:8})],O.prototype,\"output\",void 0),e([n({count:3})],O.prototype,\"cullFace\",void 0),e([n()],O.prototype,\"slicePlaneEnabled\",void 0),e([n()],O.prototype,\"transparent\",void 0),e([n()],O.prototype,\"enableOffset\",void 0),e([n()],O.prototype,\"writeDepth\",void 0),e([n()],O.prototype,\"sceneHasOcludees\",void 0),e([n({count:4})],O.prototype,\"transparencyPassType\",void 0),e([n()],O.prototype,\"multipassTerrainEnabled\",void 0),e([n()],O.prototype,\"cullAboveGround\",void 0);export{E as ImageMaterialTechnique,O as ImageMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../lib/GLMaterialTexture.js\";import{Material as t,materialParametersDefaults as i}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as s}from\"../lib/OrderIndependentTransparency.js\";import{DefaultBufferWriter as a,PositionUVLayout as r}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as n}from\"./internal/MaterialUtil.js\";import{ImageMaterialTechniqueConfiguration as u,ImageMaterialTechnique as h}from\"../shaders/ImageMaterialTechnique.js\";class c extends t{constructor(e){super(e,p),this.supportsEdges=!0,this.techniqueConfig=new u}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<s,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}intersect(e,t,i,s,a,r,u){n(e,t,s,a,r,void 0,u)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new l(e):void 0}createBufferWriter(){return new a(r)}}class l extends e{constructor(e){super({...e,...e.material.params}),this.updateParameters()}updateParameters(e){const t=this._material.params;this.updateTexture(t.textureId),this._technique=this._techniqueRep.releaseAndAcquire(h,this._material.getTechniqueConfig(this._output,e),this._technique)}beginSlot(e){if(23===e)return!0;if(4===this._output)return 3===e;return e===(this._technique.configuration.transparent?this._technique.configuration.writeDepth?5:8:3)}_updateOccludeeState(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&(this._material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}ensureParameters(e){0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e){this.bindTextures(this._technique.program),this.bindTextureScale(this._technique.program),this._technique.bindPass(this._material.params,e)}getPipelineState(e,t){return this._technique.getPipelineState(t)}}const p={transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0,...i};export{c as ImageMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport\"../../../geometry.js\";import{neverReached as e}from\"../../../core/compilerUtils.js\";import t from\"../../../core/Evented.js\";import{deg2rad as i}from\"../../../core/mathUtils.js\";import{isSome as s,isNone as o,unwrapOr as r,unwrap as n}from\"../../../core/maybe.js\";import{createScreenPointArray as a,createRenderScreenPointArray3 as c,screenPointObjectToArray as l,castRenderScreenPointArray as h}from\"../../../core/screenUtils.js\";import{once as d}from\"../../../core/accessorSupport/utils.js\";import{f as u}from\"../../../chunks/mat3.js\";import{c as _}from\"../../../chunks/mat3f64.js\";import{e as g,s as m,m as f,i as p}from\"../../../chunks/mat4.js\";import{c as v}from\"../../../chunks/mat4f64.js\";import{j as b}from\"../../../chunks/vec2.js\";import{b as y,t as j,m as L,a as S,g as R,h as w,s as O,f as T}from\"../../../chunks/vec3.js\";import{c as E,Z as A}from\"../../../chunks/vec3f64.js\";import{canProjectWithoutEngine as D,projectPoint as F,sphericalPCPFtoLonLatElevation as z,computeENUToSphericalPCPFLocalRotation as k}from\"../../../geometry/projection.js\";import{getReferenceEllipsoid as P}from\"../../../geometry/projectionEllipsoid.js\";import{containsPointObject as I}from\"../../../geometry/support/aaBoundingRect.js\";import{create as M,distance2 as C,fromPoints as x,closestRayDistance2 as B}from\"../../../geometry/support/lineSegment.js\";import{create as W,fromPositionAndNormal as V,intersectRay as H}from\"../../../geometry/support/plane.js\";import{create as U}from\"../../../geometry/support/ray.js\";import{sv3d as G}from\"../../../geometry/support/vectorStacks.js\";import{clonePoint as Z}from\"../../../layers/graphics/hydratedFeatures.js\";import{getElevationAtPoint as q}from\"../support/ElevationProvider.js\";import{fromScreen as J}from\"../support/geometryUtils/ray.js\";import K from\"../webgl-engine/lib/Camera.js\";import{Object3D as N}from\"../webgl-engine/lib/Object3D.js\";import{WebGLLayer as Q}from\"../webgl-engine/lib/WebGLLayer.js\";import X from\"../../../geometry/Point.js\";class Y{constructor(e){this.idHint=0,this.camera=new K,this._elevation={offset:0,override:null},this.collisionType={type:\"point\"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=v(),this._worldFrame=null,this._renderLocation=E(),this._renderLocationDirty=!0,this._location=new X({x:0,y:0,z:0}),this._elevationAlignedLocation=new X,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=0,this._focused=!1,this.events=new t.EventEmitter,this._screenLocation={screenPointArray:a(),renderScreenPointArray:c(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=e.view.spatialReference;for(const t in e)this[t]=e[t];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:d((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()}))}}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){$(e)&&(this._screenLocationDirty=!0),g(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=v()),ee(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){Z(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit(\"location-update\",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){Z(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit(\"location-update\",{location:this._location})}_updateElevationAlignedLocation(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;const e=s(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit(\"select-changed\",{action:e?\"select\":\"deselect\"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit(\"focus-changed\",{action:!0===e?\"focus\":\"unfocus\"}))}get focused(){return this._focused}get screenLocation(){return this.ensureScreenLocation(),this._screenLocation}ensureScreenLocation(){if(!this._screenLocationDirty)return;this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1;let e;if($(this._modelTransform)){const t=this._calculateModelTransformOffset(_e);e=y(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}intersectionDistance(t,i){if(!this.available)return null;const s=l(t,te),r=this._getCollisionRadius(i),n=-1*this.collisionPriority;switch(this.collisionType.type){case\"point\":if(b(this.screenLocation.screenPointArray,s)<r*r)return this.screenLocation.renderScreenPointArray[2]+n;break;case\"line\":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,ne),a=r*this.screenLocation.pixelSize,c=J(this.camera,s,se);if(o(c))return null;for(const s of e){if(0===s.length)continue;const e=L(ce,s[0],i);for(let t=1;t<s.length;t++){const o=L(le,s[t],i),r=B(x(e,o,ie),c);if(null!=r&&r<a*a){const t=y(G.get(),e,o);S(t,t,.5);const i=h(G.get());return this.camera.projectToRenderScreen(t,i),i[2]+n}R(e,o)}}break}case\"disc\":{var a;const e=this.collisionType.direction,t=null!=(a=this.collisionType.offset)?a:A,i=this._getWorldToScreenObjectScale(),c=this._calculateObjectTransform(i,ne),l=r*this.screenLocation.pixelSize,h=J(this.camera,s,se);if(o(h))return null;const d=u(oe,c),_=j(de,e,d),g=L(ue,t,c);V(g,_,ae);const m=he;if(H(ae,h,m)&&w(m,g)<l*l)return this.screenLocation.renderScreenPointArray[2]+n;break}case\"ribbon\":{const{paths:e,direction:t}=this.collisionType,i=this._getWorldToScreenObjectScale(),a=this._calculateObjectTransform(i,ne),c=r*this.camera.computeScreenPixelSizeAt(this.renderLocation),l=J(this.camera,s,se);if(o(l))return null;const d=u(oe,a),_=j(de,t,d),g=this._calculateModelTransformPosition(ue);V(g,_,ae);const m=he;if(!H(ae,l,m))break;for(const s of e){if(0===s.length)continue;const e=L(ce,s[0],a);for(let t=1;t<s.length;t++){const i=L(le,s[t],a),o=C(x(e,i,ie),m);if(null!=o&&o<c*c){const t=y(G.get(),e,i);S(t,t,.5);const s=h(G.get());return this.camera.projectToRenderScreen(t,s),s[2]+n}R(e,i)}}break}default:e(this.collisionType)}return null}attach(e={manipulator3D:{}}){var t;if(!this.view._stage)return;const i=e.manipulator3D;if(o(i.engineLayerId)){const e=new Q({isPickable:!1,updatePolicy:1});this.view._stage.add(e),i.engineLayerId=e.id,this._engineLayer=e}else null!=(t=this.view._stage)&&t.getObject&&(this._engineLayer=this.view._stage.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,o(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),D(this._location.spatialReference,this.view.spatialReference)||(this.location=new X({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){F(this.location,ge,e.spatialReference),I(e.extent,ge)&&(this.location=this._location)}_evaluateElevationAlignment(e=this.location){if(o(this.elevationInfo))return!1;let t=null,i=0;const s=r(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case\"on-the-ground\":t=r(q(this.view.elevationProvider,e,\"ground\"),0);break;case\"relative-to-ground\":i=r(q(this.view.elevationProvider,e,\"ground\"),0)+s;break;case\"relative-to-scene\":i=r(q(this.view.elevationProvider,e,\"scene\"),0)+s;break;case\"absolute-height\":i=s}return(i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=ne;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),s=(this.focused?2:1)|(this.selected?8:4),o=this._noDisplayCount>0;for(const{stateMask:r,objects:n}of i){if(o){for(const e of n)e.setVisible(!1);continue}const e=!(0!=(15&r))||(s&r)==(15&r),i=!(0!=(65520&r))||(this.state&r)==(65520&r);if(e&&i)for(const s of n)s.setVisible(!0),s.transformation=t;else for(const t of n)t.setVisible(!1)}}_ensureEngineResources(){if(o(this._engineResources)){const e=n(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach((({material:e})=>{i.has(e)||(t.push(e),i.add(e))}));const s=(e,t)=>{const{geometry:i,material:s,transform:o}=t;Array.isArray(i)?i.forEach((t=>e.addGeometry(t,s,o))):e.addGeometry(i,s,o)},o=new Map;this._renderObjects.forEach((e=>{const t=new N({castShadow:!1});s(t,e);const i=e.stateMask||0,r=o.get(i)||[];r.push(t),o.set(i,r)}));const r=[];o.forEach(((e,t)=>r.push({stateMask:t,objects:e}))),this._engineResources={objectsByState:r,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){if(this._engineResourcesAddedToStage||o(this._engineResources))return;const{objectsByState:e,layer:t,materials:i}=this._engineResources;i.forEach((e=>{const t=n(this._materialIdReferences),i=t.get(e.id)||0;0===i&&this.view._stage.add(e),t.set(e.id,i+1)})),e.forEach((({objects:e})=>{t.addMany(e),this.view._stage.addMany(e)})),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(e=!1){if(!this._engineResourcesAddedToStage||o(this._engineResources))return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;t.forEach((({objects:e})=>{i.removeMany(e),this.view._stage.removeMany(e)})),s.forEach((e=>{const t=n(this._materialIdReferences),i=t.get(e.id);1===i?(this.view._stage.remove(e),t.delete(e.id)):t.set(e.id,i-1)})),e&&this.view._stage.remove(i),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*(\"touch\"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,re);return O(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return T(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return m(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&f(t,t,this._worldFrame),f(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,s(this._applyObjectTransform)&&this._applyObjectTransform(t),t}get test(){let e=!1;if(s(this._engineResources))for(const t in this._engineResources.objectsByState){const i=this._engineResources.objectsByState[t];for(const t of i.objects)if(t.isVisible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function $(e){return 0!==e[12]||0!==e[13]||0!==e[14]}function ee(e,t,s){switch(e.viewingMode){case\"local\":return p(s),!0;case\"global\":{const o=P(e.renderCoordsHelper.spatialReference);return z(t,0,ce,0,o.radius),k(i(ce[0]),i(ce[1]),s),!0}}}const te=a(),ie=M(),se=U(),oe=_(),re=v(),ne=v(),ae=W(),ce=E(),le=E(),he=E(),de=E(),ue=E(),_e=E(),ge=new X({x:0,y:0,z:0,spatialReference:null});export{Y as Manipulator3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{c as r}from\"../../../../chunks/vec4f64.js\";import{bindScreenSizeScalingUniforms as i}from\"../core/shaderLibrary/ScreenSizeScaling.glsl.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as o}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as s,bindView as a,bindCameraPosition as n}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as l}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as p}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as d,ShaderTechniqueConfiguration as c}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{blendingDefault as h,OITBlending as m,OITDepthWrite as u,OITPolygonOffset as g}from\"../lib/OrderIndependentTransparency.js\";import{Program as b}from\"../lib/Program.js\";import{S as f}from\"../../../../chunks/ShadedColorMaterial.glsl.js\";import{makePipelineState as v,cullingParams as y,defaultDepthWriteParams as T,defaultColorWriteParams as E}from\"../../../webgl/renderState.js\";class S extends p{initializeProgram(e){const r=S.shader.get(),i=this.configuration,t=r.build({output:i.output,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:i.screenSizeEnabled,shadingEnabled:i.shadingEnabled,OITEnabled:0===i.transparencyPassType,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new b(e.rctx,t,P)}bindPass(e,r){const{screenSizeEnabled:t,shadingEnabled:a}=this.configuration,{color:n,shadingTint:l,shadingDirection:p}=e;s(this.program,r.camera.projectionMatrix),this.program.setUniform4fv(\"color\",n),r.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",r.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",r.inverseViewport),o(this.program,r)),a&&(this.program.setUniform4fv(\"shadedColor\",this.blendColor(w,l,n)),this.program.setUniform3fv(\"shadingDirection\",p),this.program.setUniformMatrix4fv(\"viewNormal\",r.camera.viewInverseTransposeMatrix)),t&&i(this.program,e,r)}bindDraw(e){a(this.program,e),n(this.program,e.origin,e.camera.viewInverseTransposeMatrix),t(this.program,this.configuration,e),this.program.rebindTextures()}blendColor(e,r,i){const t=1-r[3],o=r[3]+i[3]*t;return 0===o?(e[3]=o,e):(e[0]=(r[0]*r[3]+i[0]*i[3]*t)/o,e[1]=(r[1]*r[3]+i[1]*i[3]*t)/o,e[2]=(r[2]*r[3]+i[2]*i[3]*t)/o,e[3]=i[3],e)}setPipelineState(e){const r=this.configuration,i=3===e,t=2===e;return v({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?h:m(e),culling:y(r.cullFace),depthTest:{func:t?513:r.shadingEnabled?515:513},depthWrite:i?r.writeDepth&&T:u(e),colorWrite:E,polygonOffset:i||t?null:g})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}}S.shader=new l(f,(()=>import(\"./ShadedColorMaterial.glsl.js\")));class j extends c{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([d({count:8})],j.prototype,\"output\",void 0),e([d({count:3})],j.prototype,\"cullFace\",void 0),e([d()],j.prototype,\"slicePlaneEnabled\",void 0),e([d()],j.prototype,\"transparent\",void 0),e([d()],j.prototype,\"writeDepth\",void 0),e([d()],j.prototype,\"screenSizeEnabled\",void 0),e([d()],j.prototype,\"shadingEnabled\",void 0),e([d({count:4})],j.prototype,\"transparencyPassType\",void 0),e([d()],j.prototype,\"multipassTerrainEnabled\",void 0),e([d()],j.prototype,\"cullAboveGround\",void 0);const P=new Map([[\"position\",0],[\"normal\",1],[\"offset\",2]]),w=r();export{S as ShadedColorMaterialTechnique,j as ShadedColorMaterialTechniqueConfiguration,P as ShadedColorMaterialVertexAttrLocations};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{n as e,s as t,a as r,b as i}from\"../../../../chunks/vec3.js\";import{c as s}from\"../../../../chunks/vec3f64.js\";import{center as a,scale as n}from\"../../../../geometry/support/aaBoundingBox.js\";import{BufferViewVec3f as o}from\"../../../../geometry/support/buffer/BufferView.js\";import{newLayout as u}from\"../../support/buffer/InterleavedLayout.js\";import c from\"../lib/GLMaterial.js\";import{materialParametersDefaults as h,Material as f}from\"../lib/Material.js\";import{assert as l}from\"../lib/Util.js\";import{writeDefaultAttributes as p,writePosition as m}from\"./internal/bufferWriterUtils.js\";import{intersectTriangleGeometry as d}from\"./internal/MaterialUtil.js\";import{ShadedColorMaterialTechniqueConfiguration as b,ShadedColorMaterialVertexAttrLocations as g,ShadedColorMaterialTechnique as q}from\"../shaders/ShadedColorMaterialTechnique.js\";class v extends f{constructor(e){super(e,C),this.supportsEdges=!0,this.techniqueConfig=new b,this._vertexAttributeLocations=g}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.screenSizeEnabled=this.params.screenSizeEnabled,this.techniqueConfig.shadingEnabled=this.params.shadingEnabled,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}getPassParameters(){return this.params}intersect(e,s,o,u,c,h,f){if(this.params.screenSizeEnabled){const o=e.vertexAttributes.get(\"offset\"),l={applyToVertex:(e,s,a,n)=>{const c=t(P,o.data[3*n+0],o.data[3*n+1],o.data[3*n+2]),h=t(x,e,s,a);return r(c,c,this.params.screenSize*u.camera.computeRenderPixelSizeAt(c)),i(h,h,c),[h[0],h[1],h[2]]},applyToAabb:e=>{const t=a(e,P);return n(e,this.params.screenSize*u.camera.computeRenderPixelSizeAt(t))}};d(e,s,u,c,h,l,f)}else d(e,s,u,c,h,void 0,f)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new E(e):void 0}createBufferWriter(){return new S(this.params.screenSizeEnabled)}}class E extends c{constructor(e){super(e),this.updateParameters()}updateParameters(e){this._technique=this._techniqueRep.releaseAndAcquire(q,this._material.getTechniqueConfig(this._output,e),this._technique)}beginSlot(e){if(4===this._output)return 3===e;let t=3;return this._technique.configuration.transparent&&(t=this._technique.configuration.writeDepth?5:8),e===t||23===e}ensureParameters(e){this.updateParameters(e)}bind(e){this._technique.bindPass(this._material.getPassParameters(),e)}}const C={color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:e(s(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0,...h};class S{constructor(e){this.screenSizeEnabled=e;const t=u().vec3f(\"position\").vec3f(\"normal\");this.screenSizeEnabled&&t.vec3f(\"offset\"),this.vertexBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(\"position\").length}write(e,t,r,i){if(p(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,i),this.screenSizeEnabled){if(!t.vertexAttributes.has(\"offset\"))throw new Error(\"offset vertex attribute required for screenSizeEnabled ShadedColorMaterial\");{const s=t.vertexAttributes.get(\"offset\"),a=t.indices.get(\"offset\");l(3===s.size);const n=r.getField(\"offset\",o);if(!n)throw new Error(\"unable to acquire view for offset\");m(a,s.data,e.invTranspTransformation,n,i)}}}}const P=s(),x=s();export{v as ShadedColorMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../core/maybe.js\";import{b as r}from\"../../../chunks/mat4.js\";import{f as n,c as o,m as c,n as a}from\"../../../chunks/vec3.js\";import{f as i}from\"../../../chunks/vec4f64.js\";import{sv3d as s,sm4d as l}from\"../../../geometry/support/vectorStacks.js\";import{hydrateGeometry as m}from\"../../../layers/graphics/hydratedFeatures.js\";import{Manipulator3D as u}from\"./Manipulator3D.js\";import{computeCentroid as p}from\"../layers/graphics/graphicUtils.js\";import g from\"../webgl-engine/lib/GeometryUtil.js\";import{ColorMaterial as f}from\"../webgl-engine/materials/ColorMaterial.js\";import{ShadedColorMaterial as h}from\"../webgl-engine/materials/ShadedColorMaterial.js\";function d(e,t=4,r=!0){const n=i(e[0],e[1],e[2],e.length>3?e[3]:1),o=e[3]<1;return r?new h({color:n,transparent:o,writeDepth:!0,cullFace:2,renderOccluded:t}):new f({color:n,transparent:o,writeDepth:!0,cullFace:2,renderOccluded:t})}function j(e,t=4){const r=i(e[0],e[1],e[2],4===e.length?e[3]:1);return new f({color:r,transparent:!0,writeDepth:!0,cullFace:1,renderOccluded:t})}function w(e,t,r){return new u({view:e,renderObjects:[{geometry:g.createSphereGeometry(1,32,32),material:d(i(t[0],t[1],t[2],null!=r?r:1))}]})}function y(e,t,a,i){const m=n(s.get(),e,a),u=b(m,o(s.get(),i,m),a,l.get());r(u,u);const p=c(s.get(),t,u);return Math.atan2(p[1],p[0])}function b(e,t,r,n){const c=a(s.get(),e),i=a(s.get(),t),l=o(s.get(),c,i);return n[0]=c[0],n[1]=c[1],n[2]=c[2],n[3]=0,n[4]=i[0],n[5]=i[1],n[6]=i[2],n[7]=0,n[8]=l[0],n[9]=l[1],n[10]=l[2],n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n}function O(t,r){const n=t.getViewForGraphic(r);return e(n)&&\"computeAttachmentOrigin\"in n?n.computeAttachmentOrigin(r,t.spatialReference):null}function v(t,r,n){const o=O(t,n);e(o)?r.elevationAlignedLocation=o:F(r,n.geometry)}function F(e,r){if(t(r))return;const n=\"mesh\"===r.type?r.anchor:p(r);t(n)||(e.location=m(n))}export{y as calculateInputRotationTransform,b as calculateTranslateRotateFromBases,d as createManipulatorMaterial,j as createManipulatorOutlineMaterial,w as createSphereManipulator,O as getGraphicAttachmentOrigin,v as placeAtGraphic};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport o from\"../../../../../core/has.js\";import{deg2rad as t}from\"../../../../../core/mathUtils.js\";const r=o(\"mac\")?\"Meta\":\"Control\",s=\"Shift\",a=2,c=1.15,m=1.15,h=1.1,e=2500,i=.02,f=Math.cos(t(45)),p=Math.cos(t(5)),M=.95,j=.3,l=.7,n=[1,.5,0],x=2,C=1,S=[...n,l],U=[0,0,0,.04],b=[...n,.5],d=[...n,1],g=[1,1,1,1],k=[1,.8,.6,1],q=[1,.93,.86,1],u=[...n,1],v=[...n,1],w=3,y=11,z=22.5,A=40,B=48,D=2.25,E=4,F=1,G=.3,H=6,I=4,J=12,K=40,L=27,N=1600,O=.4;export{a as DISPLAY_FOCUS_MULTIPLIER,b as GRID_COLOR,n as HANDLE_COLOR,l as HANDLE_OPACITY,i as INITIAL_DEPTH_OFFSET_FRAC,O as INITIAL_PLANE_HALF_SIZE_VIEW_PROPORTION,U as PLANE_BACKGROUND_COLOR,N as PLANE_MIN_BASIS_SCREEN_LEN2,S as PLANE_OUTLINE_COLOR,C as PLANE_OUTLINE_WIDTH,x as PLANE_PREVIEW_OUTLINE_WIDTH,e as POINTER_MOVE_TIMER_MS,M as PREVIEW_FADE_DOT_THRESHOLD,j as PREVIEW_FADE_DURATION_SECONDS,H as RESIZE_HANDLE_CORNER_INPUT_RADIUS,E as RESIZE_HANDLE_CORNER_WIDTH,I as RESIZE_HANDLE_EDGE_INPUT_RADIUS,G as RESIZE_HANDLE_EDGE_PADDING_FRAC,F as RESIZE_HANDLE_EDGE_WIDTH,d as ROTATE_HEADING_CALLOUT_COLOR,L as ROTATE_HEADING_DISC_RADIUS,h as ROTATE_HEADING_DISC_RADIUS_FOCUS_MULTIPLIER,K as ROTATE_HEADING_OFFSET_DISTANCE,J as ROTATE_HEADING_TIP_LENGTH,k as SHIFT_RESTART_ARROW_CAP_COLOR,B as SHIFT_RESTART_ARROW_LENGTH,D as SHIFT_RESTART_ARROW_OUTLINE_WIDTH,g as SHIFT_RESTART_ARROW_TIP_COLOR,u as SHIFT_RESTART_CALLOUT_COLOR,A as SHIFT_RESTART_OFFSET_DISTANCE,v as SHIFT_RESTART_OUTLINE_COLOR,m as SHIFT_RESTART_TIP_FOCUS_MULTIPLIER,z as SHIFT_RESTART_TIP_LENGTH,y as SHIFT_RESTART_TIP_RADIUS,q as SHIFT_RESTART_TUBE_COLOR,c as SHIFT_RESTART_TUBE_FOCUS_MULTIPLIER,w as SHIFT_RESTART_TUBE_RADIUS,p as SMALL_ANGLE_DOT_THRESHOLD,f as VERTICAL_DOT_THRESHOLD,r as forceHorizontalModifier,s as forceVerticalModifier};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{bindProjectionMatrix as r,bindView as e}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as i}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{Default3D as t}from\"../lib/DefaultVertexAttributeLocations.js\";import{Program as a}from\"../lib/Program.js\";import{S as s}from\"../../../../chunks/SlicePlaneMaterial.glsl.js\";import{makePipelineState as l,separateBlendingParams as n,defaultColorWriteParams as m}from\"../../../webgl/renderState.js\";class d extends o{initializeProgram(r){const e=d.shader.get().build();return new a(r.rctx,e,t)}bindPass(e,i){r(this.program,i.camera.projectionMatrix),this.program.setUniform4fv(\"backgroundColor\",e.backgroundColor),this.program.setUniform4fv(\"gridColor\",e.gridColor),this.program.setUniform1f(\"gridWidth\",e.gridWidth)}bindDraw(r){e(this.program,r),this.program.rebindTextures()}initializePipeline(){return l({blending:n(1,1,771,771),depthTest:{func:513},colorWrite:m})}}d.shader=new i(s,(()=>import(\"./SlicePlaneMaterial.glsl.js\")));export{d as SlicePlaneMaterialTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import{autoDispose as r}from\"../lib/AutoDisposable.js\";import e from\"../lib/GLMaterial.js\";import{Material as i,materialParametersDefaults as s}from\"../lib/Material.js\";import{DefaultBufferWriter as o,PositionUVLayout as a}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as n}from\"./internal/MaterialUtil.js\";import{SlicePlaneMaterialTechnique as u}from\"../shaders/SlicePlaneMaterialTechnique.js\";class l extends i{constructor(t){super(t,m)}intersect(t,r,e,i,s,o,a){return n(t,r,i,s,o,void 0,a)}createBufferWriter(){return new o(a)}getGLMaterial(t){return 0===t.output?new c(t):void 0}}class c extends e{constructor(t){super(t),this._technique=new u(this._techniqueRep.constructionContext,null),this.updateParameters()}updateParameters(){}beginSlot(t){return 8===t}bind(t){this._technique.bindPass(this._material.params,t)}}t([r()],c.prototype,\"_technique\",void 0);const m={backgroundColor:[1,0,0,.5],gridColor:[0,1,0,.5],gridWidth:4,...s};export{l as SlicePlaneMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{JSONSupport as o}from\"../../core/JSONSupport.js\";import{clone as e}from\"../../core/lang.js\";import{isSome as i}from\"../../core/maybe.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{cast as s}from\"../../core/accessorSupport/decorators/cast.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{ensureNumber as a}from\"../../core/accessorSupport/ensureType.js\";import{persistable as h}from\"../../core/accessorSupport/decorators/persistable.js\";import{cyclicalDeg as n}from\"../../views/3d/support/mathUtils.js\";import m from\"../../geometry/Point.js\";var l;let c=l=class extends o{constructor(t){super(t),this.type=\"plane\",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}clone(){return new l({position:e(this.position),heading:this.heading,tilt:this.tilt,width:this.width,height:this.height})}equals(t){return this.heading===t.heading&&this.tilt===t.tilt&&i(this.position)&&i(t.position)&&this.position.equals(t.position)&&this.width===t.width&&this.height===t.height}};t([r({readOnly:!0,json:{read:!1,write:!0}})],c.prototype,\"type\",void 0),t([r({type:m}),h()],c.prototype,\"position\",void 0),t([r({type:Number,nonNullable:!0,range:{min:0,max:360}}),h(),s((t=>n.normalize(a(t),0,!0)))],c.prototype,\"heading\",void 0),t([r({type:Number,nonNullable:!0,range:{min:0,max:360}}),h(),s((t=>n.normalize(a(t),0,!0)))],c.prototype,\"tilt\",void 0),t([r({type:Number,nonNullable:!0}),h()],c.prototype,\"width\",void 0),t([r({type:Number,nonNullable:!0}),h()],c.prototype,\"height\",void 0),c=l=t([p(\"esri.widgets.Slice.SlicePlane\")],c);var d=c;export{d as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as r}from\"../../../../core/maybe.js\";import{c as e}from\"../../../../chunks/vec4.js\";import{f as t}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as i}from\"./Object3DVisualElement.js\";import a from\"../../webgl-engine/lib/GeometryUtil.js\";import{SlicePlaneMaterial as s}from\"../../webgl-engine/materials/SlicePlaneMaterial.js\";class d extends i{constructor(r){super(r),this._material=null,this._renderOccluded=4,this._gridWidth=1,this._gridColor=t(1,0,0,1),this._backgroundColor=t(1,0,0,1),this.applyProps(r)}get renderOccluded(){return this._renderOccluded}set renderOccluded(r){r!==this._renderOccluded&&(this._renderOccluded=r,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(r){this._gridWidth!==r&&(this._gridWidth=r,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(r){e(this._gridColor,r),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(r){e(this._backgroundColor,r),this._updateMaterial()}createExternalResources(){this._material=new s(this.materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(e){r(this._material)&&e(this._material)}createGeometries(e){if(r(this._material)){const r=a.createSquareGeometry();e.addGeometry(r,this._material)}}get materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){r(this._material)&&this._material.setParameterValues(this.materialParameters)}}export{d as SlicePlaneVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport\"../../../../../geometry.js\";import{neverReached as e}from\"../../../../../core/compilerUtils.js\";import t from\"../../../../../core/Logger.js\";import{rad2deg as i,deg2rad as s}from\"../../../../../core/mathUtils.js\";import{isNone as r,isSome as o,unwrapOr as n}from\"../../../../../core/maybe.js\";import{castRenderScreenPointArray3 as a}from\"../../../../../core/screenUtils.js\";import{r as c,i as l,f as m,m as d,c as g,t as u,x as p}from\"../../../../../chunks/mat4.js\";import{c as f}from\"../../../../../chunks/mat4f64.js\";import{r as b}from\"../../../../../chunks/quat.js\";import{a as h,g as w,d as y,c as j,n as M,b as k,l as v,f as P,p as O,s as T}from\"../../../../../chunks/vec3.js\";import{a as U,c as R,f as S}from\"../../../../../chunks/vec3f64.js\";import{r as L,f as A,i as E,a as C,n as F,u as G}from\"../../../../../chunks/boundedPlane.js\";import{fromPositionAndNormal as x,fromVectorsAndPoint as I}from\"../../../../../geometry/support/plane.js\";import{create as z}from\"../../../../../geometry/support/ray.js\";import{angleAroundAxis as D}from\"../../../../../geometry/support/vector.js\";import{sv3d as B,sm4d as H,sq4d as V}from\"../../../../../geometry/support/vectorStacks.js\";import{Manipulator3D as q}from\"../../Manipulator3D.js\";import{calculateTranslateRotateFromBases as N}from\"../../manipulatorUtils.js\";import{SHIFT_RESTART_TIP_RADIUS as W,RESIZE_HANDLE_EDGE_PADDING_FRAC as Z,SMALL_ANGLE_DOT_THRESHOLD as $,PLANE_MIN_BASIS_SCREEN_LEN2 as J,INITIAL_PLANE_HALF_SIZE_VIEW_PROPORTION as K,SHIFT_RESTART_OFFSET_DISTANCE as Q,SHIFT_RESTART_ARROW_OUTLINE_WIDTH as X,SHIFT_RESTART_ARROW_TIP_COLOR as Y,SHIFT_RESTART_ARROW_CAP_COLOR as _,SHIFT_RESTART_TUBE_COLOR as ee,SHIFT_RESTART_OUTLINE_COLOR as te,SHIFT_RESTART_CALLOUT_COLOR as ie,ROTATE_HEADING_OFFSET_DISTANCE as se,ROTATE_HEADING_DISC_RADIUS as re,ROTATE_HEADING_CALLOUT_COLOR as oe,PLANE_OUTLINE_COLOR as ne,PLANE_OUTLINE_WIDTH as ae,PLANE_BACKGROUND_COLOR as ce,GRID_COLOR as le,HANDLE_COLOR as me,RESIZE_HANDLE_CORNER_INPUT_RADIUS as de,RESIZE_HANDLE_EDGE_INPUT_RADIUS as ge,ROTATE_HEADING_TIP_LENGTH as ue,VERTICAL_DOT_THRESHOLD as pe,ROTATE_HEADING_DISC_RADIUS_FOCUS_MULTIPLIER as fe,DISPLAY_FOCUS_MULTIPLIER as be,RESIZE_HANDLE_EDGE_WIDTH as he,SHIFT_RESTART_ARROW_LENGTH as we,SHIFT_RESTART_TUBE_RADIUS as ye,SHIFT_RESTART_TIP_LENGTH as je,SHIFT_RESTART_TUBE_FOCUS_MULTIPLIER as Me,SHIFT_RESTART_TIP_FOCUS_MULTIPLIER as ke,RESIZE_HANDLE_CORNER_WIDTH as ve}from\"./sliceToolConfig.js\";import{LineVisualElement as Pe}from\"../../visualElements/LineVisualElement.js\";import{SlicePlaneVisualElement as Oe}from\"../../visualElements/SlicePlaneVisualElement.js\";import{getElevationAtPoint as Te}from\"../../../support/ElevationProvider.js\";import{fromRender as Ue}from\"../../../support/geometryUtils/ray.js\";import{Geometry as Re}from\"../../../webgl-engine/lib/Geometry.js\";import Se from\"../../../webgl-engine/lib/GeometryUtil.js\";import{ColorMaterial as Le}from\"../../../webgl-engine/materials/ColorMaterial.js\";import{ImageMaterial as Ae}from\"../../../webgl-engine/materials/ImageMaterial.js\";import{NativeLineMaterial as Ee}from\"../../../webgl-engine/materials/NativeLineMaterial.js\";import{RibbonLineMaterial as Ce}from\"../../../webgl-engine/materials/RibbonLineMaterial.js\";import Fe from\"../../../../../widgets/Slice/SlicePlane.js\";import Ge from\"../../../../../geometry/Point.js\";const xe=t.getLogger(\"esri.views.3d.interactive.analysisTools.slice.sliceToolUtils\");function Ie(e,t,i,s,r,o,n,a){return ze(t,n.worldUpAtPosition(e,B.get()),r,o,a.basis1,a.basis2),h(a.basis1,a.basis1,i),h(a.basis2,a.basis2,s),w(a.origin,e),I(a.basis2,a.basis1,a.origin,a.plane),a}function ze(e,t,i,s,r,o){const n=y(e,t),a=B.get(),c=B.get();switch(0===s?Math.abs(n)>pe?1:2:s){case 2:{const s=Math.abs(n)<=$?e:i.viewUp;j(a,s,t),w(c,t);break}case 1:j(a,i.viewUp,t),j(c,t,a);break;case 3:{const s=Math.abs(n)<=$?t:i.viewUp;j(a,s,e),j(c,e,a);break}}const l=j(B.get(),a,c);y(l,i.viewForward)>0&&h(c,c,-1),M(r,a),M(o,c)}function De(e,t,i){const s=t.worldUpAtPosition(e.origin,B.get()),r=e.basis1,o=mt(e,s),n=Math.round(o/yt)*yt;return L(e,n-o,r,i)}function Be(e,t,i,s,r,o){const n=w(B.get(),r.origin);k(n,n,h(B.get(),r.basis1,e.direction[0]<0?1:-1)),k(n,n,h(B.get(),r.basis2,e.direction[1]<0?1:-1));const a=v(r.basis1),c=v(r.basis2),l=P(B.get(),i,n),m=P(B.get(),t,n);let d=0,g=0;if(et(e)){const t=_e(r),i=_e(o);d=a-.5*e.direction[0]*y(r.basis1,m)/a,g=c-.5*e.direction[1]*y(r.basis2,m)/c;const s=i/t;d*=s,g*=s}const u=d+.5*e.direction[0]*y(r.basis1,l)/a,p=g+.5*e.direction[1]*y(r.basis2,l)/c,f=h(B.get(),r.basis1,u/a),b=h(B.get(),r.basis2,p/c);(u<=0||Xe(o.origin,f,s)<=J)&&w(f,o.basis1),(p<=0||Xe(o.origin,b,s)<=J)&&w(b,o.basis2);const j=w(B.get(),n);return k(j,j,h(B.get(),f,e.direction[0]<0?-1:1)),k(j,j,h(B.get(),b,e.direction[1]<0?-1:1)),A(j,f,b,o)}function He(e,t){return K*Math.min(t.width,t.height)*t.computeRenderPixelSizeAt(e)}function Ve(e,t,i,s){const r=j(B.get(),t,i);return j(r,r,t),x(e,r,s)}function qe(e,t){return N(e.basis1,e.basis2,e.origin,t)}function Ne(e,t,i,s){const r=t.worldUpAtPosition(e.origin,B.get()),o=B.get();switch(i){case 1:w(o,r);break;case 2:w(o,e.basis1)}return x(e.origin,o,s)}function We(e,t,i,s){const r=Qe(i,2),o=H.get();c(o,t,r.edge*Math.PI/2);const n=M(B.get(),r.basis);let l=h(B.get(),n,r.direction*s.computeScreenPixelSizeAt(r.position)*Q);k(l,l,r.position);const m=s.projectToRenderScreen(l,a(B.get())),d=Ze(s,m);Ue(s,m,wt),M(wt.direction,wt.direction);const g=B.get();!d&&E(i,wt,g)&&(l=g),o[12]=0,o[13]=0,o[14]=0,e.modelTransform=o,e.renderLocation=U(l),d?e.state|=ht:e.state&=~ht}function Ze(e,t){const[i,s,r,o]=e.viewport,n=Math.min(r,o)/16;let a=!0;return t[0]<i+n?(t[0]=i+n,a=!1):t[0]>i+r-n&&(t[0]=i+r-n,a=!1),t[1]<s+n?(t[1]=s+n,a=!1):t[1]>s+o-n&&(t[1]=s+o-n,a=!1),a}function $e(e,t,i,s){const r=v(s.basis1),o=v(s.basis2),n=Ye(s),a=_e(s),g=T(B.get(),0,0,0);k(g,h(B.get(),s.basis1,t.direction[0]),h(B.get(),s.basis2,t.direction[1])),k(g,s.origin,g);let u=0,p=1;if(et(t))1===t.direction[0]&&-1===t.direction[1]?u=yt:1===t.direction[0]&&1===t.direction[1]?u=Math.PI:-1===t.direction[0]&&1===t.direction[1]&&(u=3*Math.PI/2),p=a;else{const e=0!==t.direction[0]?1:2;u=1===e?yt:0,p=(1===e?o:r)-n}const f=l(H.get());c(f,f,u),m(f,f,T(B.get(),p,p,p)),d(f,i,f),f[12]=0,f[13]=0,f[14]=0,e.modelTransform=f,e.renderLocation=g}function Je(e,t,i,s){const r=s.worldUpAtPosition(i.origin,B.get()),o=Qe(i,0),n=l(H.get());c(n,n,o.edge*Math.PI/2),g(n,n,-mt(i,r)),d(n,t,n),n[12]=0,n[13]=0,n[14]=0,e.modelTransform=n,e.renderLocation=o.position}function Ke(e,t,i){const s=Qe(i,1),r=l(H.get());c(r,r,s.edge*Math.PI/2),g(r,r,yt),d(r,t,r),r[12]=0,r[13]=0,r[14]=0,e.modelTransform=r,e.renderLocation=s.position}function Qe(e,t){switch(t){case 0:return{basis:e.basis1,direction:1,position:k(B.get(),e.origin,e.basis1),edge:t};case 1:return{basis:e.basis2,direction:1,position:k(B.get(),e.origin,e.basis2),edge:t};case 2:return{basis:e.basis1,direction:-1,position:P(B.get(),e.origin,e.basis1),edge:t};case 3:return{basis:e.basis2,direction:-1,position:P(B.get(),e.origin,e.basis2),edge:t}}}function Xe(e,t,i){const s=i.projectToRenderScreen(k(B.get(),e,t),a(B.get())),r=i.projectToRenderScreen(P(B.get(),e,t),a(B.get()));return O(P(s,s,r))}function Ye(e){const t=v(e.basis1),i=v(e.basis2);return Z*Math.min(t,i)}function _e(e){return Ye(e)}function et(e){return 0!==e.direction[0]&&0!==e.direction[1]}function tt(e,t=1){const i=0===t?Q:0,s=[S(i,0,-we/2),S(i,0,we/2)],r=ct(s,!0),o=(e,t)=>nt(s,s,{tubeRadius:ye,tipRadius:W,tipLength:je,tubeFocusMultiplier:Me,tipFocusMultiplier:ke,padding:e,bothEnds:!0,flat:null,focusTipLength:!0,addCap:t}),n=o(0,!1),a=o(X,!0),c=new Le({color:Y,cullFace:2,renderOccluded:16}),l=new Le({color:_,cullFace:2,renderOccluded:16}),m=new Le({color:ee,cullFace:2,renderOccluded:16}),d=new Le({color:te,transparent:!0,writeDepth:!1,cullFace:1,renderOccluded:2}),g=Se.createPolylineGeometry([[i,0,0],[i-Q,0,0]]),u=Se.createPolylineGeometry([[i,0,0],[i-Q,0,0]]),p=new Ee({color:ie,renderOccluded:4});return new q({view:e,renderObjects:[...n.normal.map((({part:e,geometry:t,transform:i})=>({geometry:t,material:\"tip\"===e?c:\"cap\"===e?l:m,transform:i,stateMask:1|bt}))),...a.normal.map((({geometry:e,transform:t})=>({geometry:e,material:d,transform:t,stateMask:1|bt}))),{geometry:g,material:p,stateMask:1|bt|ht},...n.focused.map((({part:e,geometry:t,transform:i})=>({geometry:t,material:\"tip\"===e?c:\"cap\"===e?l:m,transform:i,stateMask:2|bt}))),...a.focused.map((({geometry:e,transform:t})=>({geometry:e,material:d,transform:t,stateMask:2|bt}))),{geometry:u,material:p,stateMask:2|bt|ht}],autoScaleRenderObjects:!1,collisionType:{type:\"line\",paths:[r]},collisionPriority:1,radius:W,state:bt})}function it(e,t){const i=new Ae({transparent:!0,writeDepth:!1,textureId:t.id,renderOccluded:16}),s=se,r=re,o=r*fe,n=e=>{const t=new Uint32Array([0,1,2,2,3,0]);return new Re([[\"position\",{size:3,data:[s-e,-e,0,s+e,-e,0,s+e,e,0,s-e,e,0],exclusive:!0}],[\"uv0\",{size:2,data:[0,0,1,0,1,1,0,1]}]],[[\"position\",t],[\"uv0\",t]])},a=Se.createPolylineGeometry([[0,0,0],[s-r,0,0]]),c=Se.createPolylineGeometry([[0,0,0],[s-o,0,0]]),l=new Ee({color:oe,renderOccluded:4}),m=[{geometry:n(r),material:i,stateMask:1|bt},{geometry:a,material:l,stateMask:1|bt},{geometry:n(o),material:i,stateMask:2|bt},{geometry:c,material:l,stateMask:2|bt}];return new q({view:e,renderObjects:m,autoScaleRenderObjects:!1,collisionType:{type:\"disc\",direction:[0,0,1],offset:[s,0,0]},collisionPriority:1,radius:r/2,state:bt})}function st(e){return new Pe({view:e,attached:!0,color:ne,width:ae,writeDepthEnabled:!1,renderOccluded:4,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]]})}function rt(e){return new Oe({view:e,attached:!0,backgroundColor:[...ce],gridColor:le,gridWidth:4,renderOccluded:4})}function ot(e,t){const i=et(t),s=i?[S(1,0,0),S(0,0,0),S(0,1,0)]:[S(1,0,0),S(-1,0,0)],r=Se.createPolylineGeometry(s),o=[...me,1],n=e=>new Ce({color:o,width:e,renderOccluded:4}),a=()=>new Ee({color:o,renderOccluded:4}),c=i?ve:he,l=c*be,m=he,d=e=>e>1?n(e):a(),g=[{geometry:r,material:d(c),stateMask:1|jt},{geometry:r,material:d(l),stateMask:2|jt},{geometry:r,material:d(m),stateMask:Mt}],u=new q({view:e,renderObjects:g,collisionType:{type:\"line\",paths:[s]},autoScaleRenderObjects:!1,worldSized:!0,radius:i?de:ge,idHint:i?1:2});return u.state=jt,u}function nt(e,t,i){const s=s=>{const r=(s?t:e).slice(0),n=P(B.get(),r[0],r[1]);M(n,n);const a=P(B.get(),r[r.length-1],r[r.length-2]);if(M(a,a),i.padding>0){const e=h(R(),a,-i.padding);if(r[r.length-1]=k(e,e,r[r.length-1]),i.bothEnds){const e=h(R(),n,-i.padding);r[0]=k(e,e,r[0])}}const c=s?i.tipFocusMultiplier:1,g=i.tipLength*(i.focusTipLength?c:1),w=i.tipRadius*c,y=l(H.get());if(i.padding>0){const e=g/4,t=T(B.get(),0,e,0),s=1+i.padding/e;u(y,y,t),m(y,y,T(B.get(),s,s,s)),u(y,y,h(t,t,-1/s))}const j=l(f()),v=S(0,1,0),O=p(f(),b(V.get(),v,a));O[12]=r[r.length-1][0],O[13]=r[r.length-1][1],O[14]=r[r.length-1][2],d(O,O,y);const U=[{part:\"tube\",geometry:at(i.tubeRadius*(s?i.tubeFocusMultiplier:1)+i.padding,i.flat,r),transform:j}];let L,A;if(o(i.flat)?L=Se.createExtrudedTriangle(g,w,w,i.flat.thickness):(L=Se.createConeGeometry(g,w,24,!1,!1,!0),A=Se.createConeGeometry(g,w,24,!1,!0,!1)),U.push({part:\"tip\",geometry:L,transform:O}),A&&U.push({part:\"cap\",geometry:A,transform:O}),i.bothEnds){const e=p(f(),b(V.get(),v,n));e[12]=r[0][0],e[13]=r[0][1],e[14]=r[0][2],d(e,e,y),U.push({part:\"tip\",geometry:L,transform:e}),A&&U.push({part:\"cap\",geometry:A,transform:e})}return U};return{normal:s(!1),focused:s(!0)}}function at(e,t,i){const s=[];if(o(t))s.push([e,t.thickness/2],[-e,t.thickness/2],[-e,-t.thickness/2],[e,-t.thickness/2]);else{const t=12;for(let i=0;i<t;i++){const r=i/t*2*Math.PI;s.push([Math.cos(r)*e,Math.sin(r)*e])}}return Se.createPathExtrusionGeometry(s,i,[],[],!1)}function ct(e,t){const i=P(R(),e[e.length-1],e[e.length-2]);if(M(i,i),h(i,i,ue),k(i,i,e[e.length-1]),t){const t=P(R(),e[0],e[1]);return M(t,t),h(t,t,ue),k(t,t,e[0]),[t,...e,i]}return[...e,i]}function lt(e,t,s,n=new Fe){if(r(e))return null;const a=o(n.position)?n.position:new Ge;t.fromRenderCoords(e.origin,a,s),n.position=a;const c=t.worldUpAtPosition(e.origin,B.get()),l=t.worldBasisAtPosition(e.origin,1,B.get());return n.width=2*v(e.basis1),n.height=2*v(e.basis2),n.tilt=i(mt(e,c)),n.heading=i(dt(e,c,l)),n}function mt(e,t){return D(t,e.basis2,e.basis1)+yt}function dt(e,t,i){return D(e.basis1,i,t)-yt}function gt(e,t,i,r,o,n,a=C()){return n.toRenderCoords(e,a.origin)?(n.worldBasisAtPosition(a.origin,0,a.basis1),n.worldBasisAtPosition(a.origin,1,a.basis2),I(a.basis2,a.basis1,a.origin,a.plane),L(a,-s(t),F(a),a),L(a,s(i),a.basis1,a),h(a.basis1,a.basis1,r/2),h(a.basis2,a.basis2,o/2),G(a),a):(xe.error(`Failed to project slice plane position, projection from ${e.spatialReference.wkid} is not supported`),null)}function ut(e,t,i=C()){return r(e)||r(e.position)?null:gt(e.position,e.heading,e.tilt,e.width,e.height,t,i)}function pt(e,t,i=C()){if(r(e)||r(e.position))return null;let s=e.position;return e.position.hasZ||(s=e.position.clone(),s.z=n(Te(t.elevationProvider,e.position),0)),gt(s,e.heading,e.tilt,e.width,e.height,t.renderCoordsHelper,i)}function ft(t){switch(t.type){case\"building-scene\":case\"csv\":case\"direct-line-measurement\":case\"area-measurement\":case\"feature\":case\"geo-rss\":case\"geojson\":case\"graphics\":case\"group\":case\"integrated-mesh\":case\"kml\":case\"line-of-sight\":case\"map-notes\":case\"ogc-feature\":case\"point-cloud\":case\"route\":case\"slice\":case\"scene\":case\"stream\":case\"voxel\":case\"subtype-group\":case\"unknown\":case\"unsupported\":case\"wfs\":case null:return!1;case\"base-dynamic\":case\"base-elevation\":case\"base-tile\":case\"bing-maps\":case\"elevation\":case\"imagery\":case\"imagery-tile\":case\"map-image\":case\"open-street-map\":case\"tile\":case\"vector-tile\":case\"wcs\":case\"web-tile\":case\"wms\":case\"wmts\":return!0;default:return e(t.type),!1}}const bt=16,ht=32,wt=z(),yt=Math.PI/2,jt=16,Mt=32;export{bt as DidPointerMoveRecentlyFlag,ht as IsShiftEdgeOnScreenFlag,ct as addArrowTips,qe as calculateBoundedPlaneTranslateRotate,_e as calculateDiagonalResizeHandleScale,He as calculatePlaneHalfSize,Ye as calculateResizeHandlePadding,Xe as calculateScreenSpaceBasisLength2,nt as createArrowGeometry,rt as createGridVisualElement,st as createOutlineVisualElement,Ie as createPlane,ot as createResizeManipulator,it as createRotateManipulator,Ne as createRotatePlane,tt as createShiftManipulator,Ve as createShiftPlane,De as forceHorizontalOrVertical,ft as isAlwaysDrapedLayer,et as isDiagonalResizeHandle,ze as normalToBases,lt as planeToShape,jt as resizeNormal,Mt as resizeOutlineOnly,Be as resizePlane,pt as shapeToElevationAlignedPlane,ut as shapeToPlane,$e as updateResizeHandle,Je as updateRotateHeadingHandle,Ke as updateRotateTiltHandle,We as updateShiftRestartHandle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import i from\"../../../../../core/Accessor.js\";import t from\"../../../../../core/Handles.js\";import a from\"../../../../../core/Logger.js\";import{isNone as r,isSome as l}from\"../../../../../core/maybe.js\";import{whenOnce as s}from\"../../../../../core/watchUtils.js\";import{property as n}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{a as c}from\"../../../../../chunks/boundedPlane.js\";import h from\"../../../../../layers/Layer.js\";import d from\"../../../../../layers/buildingSublayers/BuildingComponentSublayer.js\";import{isAlwaysDrapedLayer as y,shapeToElevationAlignedPlane as u,forceHorizontalOrVertical as p,planeToShape as w}from\"../../analysisTools/slice/sliceToolUtils.js\";import v from\"../../../../../widgets/Slice/SlicePlane.js\";const V=a.getLogger(\"esri.views.3d.interactive.graphics.Slice.SliceController\");let f=class extends i{constructor(e){super(e),this._handles=new t,this._internalChange=!1,this._currentSlicePlane=null,this.state=\"pending\"}get ready(){return\"ready\"===this.state}initialize(){this._handles.add(this.layerView.layerViewData.excludedLayers.on(\"before-add\",(e=>{const i=e.item;null!=i&&(i instanceof h||i instanceof d)?i instanceof h&&y(i)?(V.error(\"excludedLayers\",`Layer '${i.title}, id:${i.id}' of type '${i.type}' can not be individually excluded from slicing. Use 'excludeGroundSurface' instead.`),e.preventDefault()):this.layerView.layerViewData.excludedLayers.includes(i)&&e.preventDefault():(V.error(\"excludedLayers\",\"Invalid layer type, layer must derive from Layer or BuildingComponentSublayer\"),e.preventDefault())}))),this._handles.add(s(this.view,\"ready\",(()=>this._initialize()),!0))}_initialize(){switch(this.state){case\"pending\":break;case\"destroyed\":return;case\"ready\":throw new Error(\"state error\")}C(this.view,this),this._handles.add([this.layerView.layerViewData.watch(\"plane\",(()=>{this._internalChange||this._updateSlicePlaneFromBoundedPlane(),this._updateLayerViews()}),!0),this.layerView.layerViewData.watch(\"excludeGroundSurface\",(()=>this._updateLayerViews()),!0),this.layerView.layerViewData.excludedLayers.on(\"change\",(()=>this._updateLayerViews())),this.layerView.watch([\"active\",\"visible\"],(()=>{this._updateActiveController(),this._updateViewSlicePlane()}),!0),this.view.allLayerViews.on(\"change\",(()=>this._updateLayerViews()))]),this._handles.add([this.analysis.watch(\"plane\",(()=>{this._internalChange||(this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane())}),!0)],\"analysis\"),this._set(\"state\",\"ready\"),this._updateActiveController(),this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane()}destroy(){switch(this.state){case\"destroyed\":case\"pending\":return}this.layerView.active=!1,P(this.view,this),this._handles.destroy(),this.view.slicePlane=null,this.set(\"view\",null),this._set(\"state\",\"destroyed\")}async whenReady(){return await s(this,\"ready\"),this}_updateBoundedPlaneFromSlicePlane(){const e=this.analysis.plane,i=this._currentSlicePlane;if(r(i)&&r(e)||l(i)&&l(e)&&e.equals(i))return;let t=null,a=null;l(e)&&(t=u(e,this.view,c()),l(t)?a={heading:e.heading,tilt:e.tilt,position:e.position,width:e.width,height:e.height}:console.warn(\"Failed slice plane conversion.\")),this._currentSlicePlane=a,l(t)&&!this.analysis.tiltEnabled&&p(t,this.view.renderCoordsHelper,t),this._internalChange=!0,this.layerView.layerViewData.plane=t,this._internalChange=!1}_updateSlicePlaneFromBoundedPlane(){const e=this.layerView.layerViewData.plane,i=w(e,this.view.renderCoordsHelper,this.view.spatialReference,new v);let t=null;l(i)&&(t={heading:i.heading,tilt:i.tilt,position:i.position,width:i.width,height:i.height}),this._currentSlicePlane=t,l(e)&&(this.analysis.tiltEnabled||p(e,this.view.renderCoordsHelper,e)),this._internalChange=!0,this.analysis.plane=i,this._internalChange=!1,this._updateViewSlicePlane()}_updateActiveController(){if(_)return;const e=S(this.view);if(this.layerView.active)l(e.activeController)&&e.activeController!==this?(_=!0,e.activeController.layerView.active=!1,_=!1):l(e.activeController)&&e.activeController,this._updateLayerViews(),e.activeController=this;else{if(l(e.activeController)&&e.activeController!==this)return;l(e.activeController)&&e.activeController===this&&(e.activeController=null,this._updateLayerViews())}}_updateViewSlicePlane(){\"ready\"===this.state&&g(this.view)}_updateLayerViews(){const e=l(this.layerView.layerViewData.plane)&&this.layerView.visible&&this.layerView.active,i=[],t=e=>{\"layers\"in e?e.layers.forEach(t):i.push(e)};this.layerView.layerViewData.excludedLayers.forEach(t),this.view.allLayerViews.forEach((t=>{\"slicePlaneEnabled\"in t&&(t.slicePlaneEnabled=e&&i.indexOf(t.layer)<0),\"sublayerViews\"in t&&t.sublayerViews.forEach((t=>{t.slicePlaneEnabled=e&&i.indexOf(t.sublayer)<0}))})),null!=this.view.basemapTerrain&&(this.view.basemapTerrain.slicePlaneEnabled=e&&!this.layerView.layerViewData.excludeGroundSurface)}};e([n({readOnly:!0})],f.prototype,\"state\",void 0),e([n()],f.prototype,\"view\",void 0),e([n()],f.prototype,\"analysis\",void 0),e([n()],f.prototype,\"layerView\",void 0),e([n()],f.prototype,\"ready\",null),f=e([o(\"esri.views.3d.interactive.graphics.Slice.SliceController\")],f);const m=new Map;let _=!1;function g(e){const i=S(e).activeController;l(i)&&l(i.layerView.layerViewData.plane)&&i.layerView.visible?e.slicePlane=i.layerView.layerViewData.plane:e.slicePlane=null}function C(e,i){m.has(e)||m.set(e,{all:[],activeController:null}),m.get(e).all.push(i)}function S(e){return m.get(e)}function P(e,i){if(!m.has(e))throw new Error(\"view expected in global slice register\");const t=m.get(e),a=t.all.lastIndexOf(i);if(-1===a)throw new Error(\"controller expected in global slice register\");t.all.splice(a,1),0===t.all.length&&m.delete(e)}export{f as SliceController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import i from\"../../../../../core/Handles.js\";import{applyOpacity as s}from\"../../../../../core/mathUtils.js\";import{isNone as a,destroyMaybe as r,isSome as l}from\"../../../../../core/maybe.js\";import{whenOnce as o}from\"../../../../../core/watchUtils.js\";import{property as n}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as h}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as c}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{w as p,m as d}from\"../../../../../chunks/mat4.js\";import{s as u,l as m}from\"../../../../../chunks/vec3.js\";import{c as y}from\"../../../../../chunks/vec4f64.js\";import{sm4d as w,sv3d as _}from\"../../../../../geometry/support/vectorStacks.js\";import{PLANE_OUTLINE_WIDTH as V,PLANE_OUTLINE_COLOR as g,PLANE_PREVIEW_OUTLINE_WIDTH as f,PLANE_BACKGROUND_COLOR as v,GRID_COLOR as j}from\"../../analysisTools/slice/sliceToolConfig.js\";import{createGridVisualElement as E,createOutlineVisualElement as b,calculateBoundedPlaneTranslateRotate as k}from\"../../analysisTools/slice/sliceToolUtils.js\";import{createStipplePatternSimple as S}from\"../../../webgl-engine/materials/lineStippleUtils.js\";let M=class extends t{constructor(e){super(e),this._handles=new i,this._gridVisualElement=null,this._outlineVisualElement=null,this.state=\"pending\"}get ready(){return\"ready\"===this.state}set showGrid(e){this._set(\"showGrid\",e),this._updateMaterials()}set editable(e){this._set(\"editable\",e),this._updateMaterials()}initialize(){this._initialize()}async _initialize(){switch(this.state){case\"pending\":break;case\"destroyed\":return;case\"ready\":throw new Error(\"state error\")}if(await o(this.view,\"ready\",!0),a(this.layerView.layerViewData))throw new Error(\"expected internal object to be valid\");this._gridVisualElement=E(this.view),this._outlineVisualElement=b(this.view),this._handles.add(c((()=>this.layerView.fullOpacity),(()=>this._updateMaterials())),\"layer\"),this._handles.add([this.layerView.watch(\"visible\",(()=>this._updateMaterials()),!0),this.layerView.layerViewData.watch(\"plane\",(()=>this._updatePlane()),!0),this.layerView.watch(\"active\",(()=>this._updateMaterials()),!0)],\"internal\"),this._updatePlane(),this._set(\"state\",\"ready\")}destroy(){switch(this.state){case\"destroyed\":case\"pending\":return}this._handles.destroy(),this._gridVisualElement=r(this._gridVisualElement),this._outlineVisualElement=r(this._outlineVisualElement),this.set(\"view\",null),this._set(\"state\",\"destroyed\")}async whenReady(){return await o(this,\"ready\"),this}_update(){switch(this.state){case\"pending\":case\"destroyed\":return}}_updatePlane(){const e=this.layerView.layerViewData.plane,t=l(e)?k(e,w.get()):null;if(this._outlineVisualElement.width=V,l(e)){const i=u(_.get(),m(e.basis1),m(e.basis2),1),s=p(w.get(),i),a=d(s,t,s);this._outlineVisualElement.transform=a,this._gridVisualElement.transform=a}this._updateMaterials()}_updateMaterials(){const e=this.layerView.layerViewData.plane&&this.layerView.visible,t=this.layerView.active,i=this.layerView.fullOpacity,a=s(D,g,i);this._outlineVisualElement.color=a,this._outlineVisualElement.width=this.editable?V:f,this._outlineVisualElement.stipplePattern=t?null:S(5);const r=s(D,v,i),o=!!l(this.layerView.layerViewData)&&this.showGrid?j:[0,0,0,0];this._gridVisualElement.backgroundColor=r,this._gridVisualElement.gridColor=o,this._gridVisualElement.visible=e,this._outlineVisualElement.visible=e}};e([n({readOnly:!0})],M.prototype,\"state\",void 0),e([n()],M.prototype,\"view\",void 0),e([n()],M.prototype,\"layer\",void 0),e([n()],M.prototype,\"layerView\",void 0),e([n()],M.prototype,\"ready\",null),e([n({value:!1})],M.prototype,\"showGrid\",null),e([n({value:!0})],M.prototype,\"editable\",null),M=e([h(\"esri.views.3d.interactive.graphics.Slice.SliceView\")],M);const D=y();export{M as SliceView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import r from\"../../../../../core/Accessor.js\";import o from\"../../../../../core/Collection.js\";import{castForReferenceSetter as s,referenceSetter as t}from\"../../../../../core/collectionUtils.js\";import{property as c}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as p}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let i=class extends r{constructor(){super(...arguments),this.plane=null,this.excludeGroundSurface=!1}get excludedLayers(){return this._get(\"excludedLayers\")||new o}set excludedLayers(e){this._set(\"excludedLayers\",t(e,this._get(\"excludedLayers\")))}};e([c()],i.prototype,\"plane\",void 0),e([c()],i.prototype,\"excludeGroundSurface\",void 0),e([c({cast:s})],i.prototype,\"excludedLayers\",null),i=e([p(\"esri.views.3d.interactive.graphics.Slice.SliceInternal\")],i);export{i as SliceLayerViewData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as i}from\"../../../chunks/tslib.es6.js\";import{createDeferred as e}from\"../../../core/promiseUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as t}from\"../../../core/accessorSupport/decorators/subclass.js\";import{SliceController as r}from\"../interactive/graphics/Slice/SliceController.js\";import{SliceView as a}from\"../interactive/graphics/Slice/SliceView.js\";import{LayerView3D as o}from\"./LayerView3D.js\";import{SliceLayerViewData as l}from\"./analysis/Slice/SliceLayerViewData.js\";import n from\"../../layers/LayerView.js\";let y=class extends(o(n)){constructor(){super(...arguments),this.type=\"slice-3d\",this.analysisView=null,this.analysisController=null,this._initialized=e(),this.layerViewData=new l,this.active=!0,this.showGrid=!1,this.editable=!1}initialize(){this.analysisView=new a({view:this.view,layer:this.layer,layerView:this}),this.analysisController=new r({view:this.view,analysis:this.layer,layerView:this}),this._initialized.resolve()}destroy(){this.analysisView.destroy(),this.analysisView=null,this.analysisController.destroy(),this.analysisController=null}async when(){return this.destroyed?null:(await this._initialized.promise,this.destroyed?null:(await this.analysisView.whenReady(),this.destroyed?null:(await this.analysisController.whenReady(),this)))}get testData(){return{view:this.analysisView,controller:this.analysisController}}};i([s()],y.prototype,\"type\",void 0),i([s()],y.prototype,\"layerViewData\",void 0),i([s()],y.prototype,\"layer\",void 0),i([s()],y.prototype,\"active\",void 0),i([s({aliasOf:\"analysisView.showGrid\"})],y.prototype,\"showGrid\",void 0),i([s({aliasOf:\"analysisView.editable\"})],y.prototype,\"editable\",void 0),y=i([t(\"esri.views.3d.layers.SliceLayerView3D\")],y);var p=y;export{y as SliceLayerView3D,p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nfunction i(i){return i&&\"getAtOrigin\"in i&&\"originOf\"in i}export{i as isMultiOriginJSONMixin};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{getPathExtension as i}from\"../../core/urlUtils.js\";function p(i){return o[n(i)]||e}function n(i){return i instanceof Blob?i.type:t(i.url)}function t(p){const n=i(p);return g[n]||a}const o={},a=\"text/plain\",e=o[a],g={png:\"image/png\",jpeg:\"image/jpeg\",jpg:\"image/jpg\",bmp:\"image/bmp\",gif:\"image/gif\",json:\"application/json\",txt:\"text/plain\",xml:\"application/xml\",svg:\"image/svg+xml\",zip:\"application/zip\",pbf:\"application/vnd.mapbox-vector-tile\",gz:\"application/gzip\"};for(const l in g)o[g[l]]=l;export{p as getResourceContentExtension};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as t,isNone as r,get as e}from\"../../maybe.js\";import{isMultiOriginJSONMixin as o}from\"../../multiOriginJSONSupportUtils.js\";import{isAbsolute as i,isBlobProtocol as n,join as s,getPathExtension as u}from\"../../urlUtils.js\";import{generateUUID as p}from\"../../uuid.js\";import{getOwnPropertyMetadata as a}from\"../metadata.js\";import{nameToId as c}from\"../PropertyOrigin.js\";import{propertyJSONMeta as l}from\"./property.js\";import{getResourceContentExtension as f}from\"../../../portal/support/resourceExtension.js\";import{r as m,t as y,i as h,p as d}from\"../../../chunks/persistableUrlUtils.js\";function g(r){const e=t(r)&&r.origins?r.origins:[void 0];return(t,o)=>{const i=w(r,t,o);for(const r of e){const e=l(t,r,o);for(const t in i)e[t]=i[t]}}}function w(r,e,o){if(t(r)&&\"resource\"===r.type)return v(r,e,o);switch(t(r)&&r.type?r.type:\"other\"){case\"other\":return{read:!0,write:!0};case\"url\":{const{read:t,write:r}=d;return{read:t,write:r}}}}function v(e,s,u){const p=a(s,u);return{type:String,read:(t,r,e)=>{const o=m(t,r,e);return p.type===String?o:\"function\"==typeof p.type?new p.type({url:o}):void 0},write:{writer(s,a,l,f){if(!f||!f.resources)return\"string\"==typeof s?void(a[l]=y(s,f)):void(a[l]=s.write({},f));const m=P(s),d=m?y(m,{...f,verifyItemRelativeUrls:f&&f.verifyItemRelativeUrls?{writtenUrls:f.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null},1):null,g=p.type!==String&&(!o(this)||f&&f.origin&&this.originIdOf(u)>c(f.origin));f&&f.portalItem&&t(d)&&!i(d)?g?j(this,u,s,d,a,l,f,e):I(d,a,l,f):f&&f.portalItem&&(r(d)||t(h(d))||n(d)||g)?U(this,u,s,d,a,l,f,e):a[l]=d}}}}function U(t,r,o,i,u,a,c,l){const m=p(),y=S(o,i,c),h=s(e(l,\"prefix\"),m),d=`${h}.${f(y)}`,g=c.portalItem.resourceFromPath(d);n(i)&&c.resources.pendingOperations.push(b(i).then((t=>{g.path=`${h}.${f(t)}`,u[a]=g.itemRelativeUrl})).catch((()=>{}))),O(t,r,g,y,c.resources.toAdd),u[a]=g.itemRelativeUrl}function j(t,r,e,o,i,n,s,p){const a=s.portalItem.resourceFromPath(o),c=S(e,o,s);f(c)===u(a.path)?(O(t,r,a,c,s.resources.toUpdate),i[n]=o):U(t,r,e,o,i,n,s,p)}function I(t,r,e,o){o.resources.toKeep.push({resource:o.portalItem.resourceFromPath(t)}),r[e]=t}function O(t,r,e,o,i){i.push({resource:e,content:o,finish:e=>{R(t,r,e)}})}function S(t,r,e){return\"string\"==typeof t?{url:r}:new Blob([JSON.stringify(t.toJSON(e))],{type:\"application/json\"})}async function b(t){const r=(await import(\"../../../request.js\")).default,{data:e}=await r(t,{responseType:\"blob\"});return e}function P(t){return r(t)?null:\"string\"==typeof t?t:t.url}function R(t,r,e){\"string\"==typeof t[r]?t[r]=e.url:t[r].url=e.url}export{g as persistable};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as s}from\"../../../../core/maybe.js\";import{e as r}from\"../../../../chunks/mat4.js\";import{c as t}from\"../../../../chunks/mat4f64.js\";import{VisualElement as o}from\"./VisualElement.js\";import{Object3D as i}from\"../../webgl-engine/lib/Object3D.js\";import{WebGLLayer as a}from\"../../webgl-engine/lib/WebGLLayer.js\";class c extends o{constructor(e){super(e.view),this._resources=null,this._transform=t()}get object(){return e(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){r(this._transform,s),e(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(s(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new a({isPickable:!1,updatePolicy:1});e.add(s);const r=new i({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;!s(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){s(this._resources)||this._resources.object.setVisible(e)}}export{c as Object3DVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nclass t{constructor(t){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch(\"ready\",(t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())}))}applyProps(t){let e=!1;for(const s in t)s in this?\"attached\"===s?e=t[s]:this[s]=t[s]:console.error(\"Cannot set unknown property\",s);this.attached=e}destroy(){this.attached=!1}get attached(){return this._attached}set attached(t){t!==this._attached&&this.view._stage&&(this._attached=t,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.attached&&this.updateVisibility(t))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}export{t as VisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../core/maybe.js\";import{i as r,t as s}from\"../../../../chunks/mat4.js\";import{c as i}from\"../../../../chunks/mat4f64.js\";import{s as o}from\"../../../../chunks/vec3.js\";import{Z as n,c as h}from\"../../../../chunks/vec3f64.js\";import{g as l,c as a}from\"../../../../chunks/vec4.js\";import{f as p,c as d,a as f}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as _}from\"./Object3DVisualElement.js\";import{createGeometry as c}from\"../../layers/graphics/lineUtils.js\";import{RibbonLineMaterial as u}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";class m extends _{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=p(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stippleIntegerRepeats=!1,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromRenderSpacePoint(e){const t=1e3,r=[];r.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),r.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),r.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=r}setGeometryFromExtent(e){const t=this.view.spatialReference,r=h(),s=h(),i=100,n=[];o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),this.geometry=[n]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],r=e.origin,s=e.basis1,i=e.basis2,o=.5,n=h(),l=h(),a=h(),p=h();n[0]=r[0]-s[0]*o-i[0]*o,n[1]=r[1]-s[1]*o-i[1]*o,n[2]=r[2]-s[2]*o-i[2]*o,l[0]=r[0]-s[0]*o+i[0]*o,l[1]=r[1]-s[1]*o+i[1]*o,l[2]=r[2]-s[2]*o+i[2]*o,a[0]=r[0]+s[0]*o+i[0]*o,a[1]=r[1]+s[1]*o+i[1]*o,a[2]=r[2]+s[2]*o+i[2]*o,p[0]=r[0]+s[0]*o-i[0]*o,p[1]=r[1]+s[1]*o-i[1]*o,p[2]=r[2]+s[2]*o-i[2]*o,t.push([n[0],n[1],n[2]]),t.push([l[0],l[1],l[2]]),t.push([a[0],a[1],a[2]]),t.push([p[0],p[1],p[2]]),t.push([n[0],n[1],n[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;r(g),s(g,g,t),this.transform=g;const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=n){r(g),s(g,g,t),this.transform=g,this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){l(e,this._color)||(a(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(r){e(r)?!t(this._innerColor)&&l(r,this._innerColor)||(this._innerColor=a(d(),r),this._updateMaterial()):e(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const r=e(t)!==e(this._stipplePattern);this._stipplePattern=t,r?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(r){(t(r)||t(this._stippleOffColor)||!l(r,this._stippleOffColor))&&(this._stippleOffColor=e(r)?f(r):null,this._updateMaterial())}get stippleIntegerRepeats(){return this._stippleIntegerRepeats}set stippleIntegerRepeats(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new u(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){const t=this._createLineGeometries();if(0!==t.length)for(let r=0;r<t.length;++r){const s=c(t[r]);e.addGeometry(s,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameterValues(this.materialParameters)}_createLineGeometries(){const e=this.geometry;if(t(e)||0===e.length)return[];const r=[];return e.forEach((e=>{const t=e.length,s=new Float64Array(3*t);e.forEach(((e,t)=>{s[3*t+0]=e[0],s[3*t+1]=e[1],s[3*t+2]=e[2]}));const i={attributeData:{position:s},removeDuplicateStartEnd:0};r.push(i)})),r}}const g=i();export{m as LineVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{Slice as e}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as a}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as o}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{defaultMaskAlphaCutoff as i}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as t}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as l}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function s(s){const n=new l;return n.include(r,{linearDepth:!1}),n.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),n.attributes.add(\"position\",\"vec3\"),n.attributes.add(\"uv0\",\"vec2\"),n.varyings.add(\"vpos\",\"vec3\"),s.multipassTerrainEnabled&&n.varyings.add(\"depth\",\"float\"),n.vertex.uniforms.add(\"textureCoordinateScaleFactor\",\"vec2\"),n.vertex.code.add(t`\n    void main(void) {\n      vpos = position;\n      ${s.multipassTerrainEnabled?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  `),n.include(e,s),s.multipassTerrainEnabled&&(n.fragment.include(a),n.include(o,s)),n.fragment.uniforms.add(\"tex\",\"sampler2D\"),n.fragment.uniforms.add(\"opacity\",\"float\"),n.varyings.add(\"vTexCoord\",\"vec2\"),7===s.output?n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    `):(n.fragment.include(d),n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ${s.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n    }\n    `)),n}var n=Object.freeze({__proto__:null,build:s});export{n as I,s as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import o from\"../../core/Error.js\";import{isSome as r}from\"../../core/maybe.js\";async function n(n,t,s,a,i,d){let l=null;if(r(s)){const o=`${n}/nodepages/`,t=o+Math.floor(s.rootIndex/s.nodesPerPage);try{return{type:\"page\",rootPage:(await e(t,{query:{f:\"json\",token:a},responseType:\"json\",signal:d})).data,rootIndex:s.rootIndex,pageSize:s.nodesPerPage,lodMetric:s.lodSelectionMetricType,urlPrefix:o}}catch(f){r(i)&&i.warn(\"#fetchIndexInfo()\",\"Failed to load root node page. Falling back to node documents.\",t,f),l=f}}if(!t)return null;const p=`${n}/nodes/`,c=p+(t&&t.split(\"/\").pop());try{return{type:\"node\",rootNode:(await e(c,{query:{f:\"json\",token:a},responseType:\"json\",signal:d})).data,urlPrefix:p}}catch(f){throw new o(\"sceneservice:root-node-missing\",\"Root node missing.\",{pageError:l,nodeError:f,url:c})}}export{n as fetchIndexInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../shaderModules/interfaces.js\";function i(i){i.vertex.uniforms.add(\"camPos\",\"vec3\").add(\"perScreenPixelRatio\",\"float\").add(\"screenSize\",\"float\"),i.vertex.code.add(e`float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - camPos));\nreturn viewDirectionDistance*perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;\n}`)}function r(e,i,r){e.setUniform1f(\"perScreenPixelRatio\",r.camera.perScreenPixelRatio),e.setUniform1f(\"screenSize\",i.screenSize)}export{i as ScreenSizeScaling,r as bindScreenSizeScalingUniforms};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{ScreenSizeScaling as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js\";import{Slice as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as o}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as i}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as a}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{symbolAlphaCutoff as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as n}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as s}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function t(t){const c=new s;return c.include(o,{linearDepth:!1}),c.include(e,{}),c.include(r,t),c.fragment.include(l),c.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),c.fragment.uniforms.add(\"color\",\"vec4\"),c.attributes.add(\"position\",\"vec3\"),c.varyings.add(\"vWorldPosition\",\"vec3\"),t.multipassTerrainEnabled&&c.varyings.add(\"depth\",\"float\"),t.screenSizeEnabled&&c.attributes.add(\"offset\",\"vec3\"),t.shadingEnabled&&(c.vertex.uniforms.add(\"viewNormal\",\"mat4\"),c.fragment.uniforms.add(\"shadedColor\",\"vec4\").add(\"shadingDirection\",\"vec3\"),c.attributes.add(\"normal\",\"vec3\"),c.varyings.add(\"vViewNormal\",\"vec3\")),c.vertex.code.add(n`\n    void main(void) {\n      vWorldPosition = ${t.screenSizeEnabled?\"screenSizeScaling(offset, position)\":\"position\"};\n  `),t.shadingEnabled&&c.vertex.code.add(n`vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),c.vertex.code.add(n`\n    ${t.multipassTerrainEnabled?\"depth = (view * vec4(vWorldPosition, 1.0)).z;\":\"\"}\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  `),t.multipassTerrainEnabled&&(c.fragment.include(i),c.include(a,t)),c.fragment.code.add(n`\n    void main() {\n      discardBySlice(vWorldPosition);\n      ${t.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n    `),t.shadingEnabled?c.fragment.code.add(n`vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(color, shadedColor, shadingFactor);`):c.fragment.code.add(n`vec4 finalColor = color;`),c.fragment.code.add(n`\n      if (finalColor.a < ${n.float(d)}) {\n        discard;\n      }\n      ${7===t.output?n`gl_FragColor = vec4(finalColor.a);`:\"\"}\n\n      ${0===t.output?n`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${t.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}`:\"\"}\n    }\n    `),c}var c=Object.freeze({__proto__:null,build:t});export{c as S,t as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{glsl as d}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as e}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function r(){const r=new e;return r.extensions.add(\"GL_OES_standard_derivatives\"),r.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),r.attributes.add(\"position\",\"vec3\"),r.attributes.add(\"uv0\",\"vec2\"),r.varyings.add(\"vUV\",\"vec2\"),r.vertex.code.add(d`void main(void) {\nvUV = uv0;\ngl_Position = proj * view * vec4(position, 1.0);\n}`),r.fragment.uniforms.add(\"backgroundColor\",\"vec4\").add(\"gridColor\",\"vec4\").add(\"ratio\",\"float\").add(\"gridWidth\",\"float\"),r.fragment.code.add(d`void main() {\nconst float LINE_WIDTH = 1.0;\nvec2 uvScaled = vUV * gridWidth;\nvec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));\nvec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);\ngrid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);\ngrid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);\nfloat gridFade = max(grid.x, grid.y);\nfloat gridAlpha = gridColor.a * gridFade;\ngl_FragColor =\nvec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +\nvec4(gridColor.rgb, 1.0) * gridAlpha;\n}`),r}var a=Object.freeze({__proto__:null,build:r});export{a as S,r as b};\n"],"sourceRoot":""}