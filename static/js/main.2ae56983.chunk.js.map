{"version":3,"sources":["../node_modules/@stencil/core/internal/client lazy /^/.//.*$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","Example.tsx","../../dist/index.es.js","ArcGIS.tsx","index.tsx"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","Example","clock","Clock","mesh","radiansPerSecond","MathUtils","degToRad","context","renderer","scene","geometry","BoxGeometry","material","MeshStandardMaterial","color","flatShading","WGS84Position","view","goTo","target","zoom","map","ground","queryElevation","Point","longitude","latitude","returnSampleInfo","result","elevation","z","transformation","Array","externalRenderers","SpatialReference","WGS84","Mesh","add","applyMatrix4","Matrix4","fromArray","catch","error","console","clockDelta","this","getDelta","undefined","rotateY","dispose","ExternalRendererThree","ExternalRendererThreeClass","THREE","camera","ambient","sun","Object","defineProperty","get","instance","enumerable","configurable","prototype","start","threeMain","setup","gl","premultipliedAlpha","preserveDrawingBuffer","setPixelRatio","window","devicePixelRatio","setViewport","width","height","autoClear","resetWebGLState","render","position","set","eye","up","lookAt","center","projectionMatrix","sunLight","direction","intensity","diffuse","resetState","bindRenderTarget","remove","Instance","ArcGIS","config","apiKey","process","Map","basemap","SceneView","container","viewingMode","x","y","spatialReference","wkid","heading","tilt","environment","lighting","cameraTrackingEnabled","className","Component","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2ae56983.chunk.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 770;","import * as externalRenderers from \"@arcgis/core/views/3d/externalRenderers\";\r\nimport { WebGLRenderer, Scene, Matrix4, BoxGeometry, Mesh, Clock, MathUtils, MeshStandardMaterial, Material, BufferGeometry } from \"three\";\r\nimport SpatialReference from \"@arcgis/core/geometry/SpatialReference\"\r\nimport Point from \"@arcgis/core/geometry/Point\"\r\nimport { ExternalRendererThreeCallback } from \"@philippkoelmel/arcgis-threejs-externalrenderer\";\r\n\r\nclass Example implements ExternalRendererThreeCallback {\r\n\r\n    private clock: Clock = new Clock();\r\n    private mesh?: Mesh<BufferGeometry, Material>;\r\n\r\n    private radiansPerSecond: number = MathUtils.degToRad(30);;\r\n\r\n    setup(context: any, renderer: WebGLRenderer, scene: Scene): void {\r\n        let geometry = new BoxGeometry(100, 100, 100);\r\n        let material = new MeshStandardMaterial({\r\n            color: 0xFF0000,\r\n            flatShading: true,\r\n        });\r\n\r\n        let WGS84Position = [10.544538805374891, 46.50861247649143, 0];\r\n\r\n        context.view.goTo({\r\n            target: [WGS84Position[0], WGS84Position[1]],\r\n            zoom: 14,\r\n        });\r\n\r\n        context.view.map.ground.queryElevation(new Point({\r\n            longitude: WGS84Position[0],\r\n            latitude: WGS84Position[1]\r\n        }), {\r\n            returnSampleInfo: true\r\n        }).then((result: any) => {\r\n            let elevation: number = result.geometry.z;\r\n            WGS84Position[2] = elevation;\r\n\r\n            let transformation = new Array(16);\r\n            externalRenderers.renderCoordinateTransformAt(context.view, WGS84Position, SpatialReference.WGS84, transformation);\r\n\r\n            this.mesh = new Mesh(geometry, material);\r\n            scene.add(this.mesh);\r\n\r\n            this.mesh.applyMatrix4(new Matrix4().fromArray(transformation));\r\n\r\n        }).catch((error: any) => {\r\n            console.error(\"Failed to query elevation:\", error);\r\n        });;\r\n    }\r\n\r\n    render(context: any): void {\r\n        const clockDelta = this.clock.getDelta();\r\n\r\n        if (this.mesh !== undefined) {\r\n            this.mesh.geometry.rotateY(this.radiansPerSecond * clockDelta);\r\n        }\r\n    }\r\n\r\n    dispose(context: any): void {\r\n        if (this.mesh !== undefined) {\r\n            this.mesh.material.dispose();\r\n            this.mesh.geometry.dispose();\r\n        }\r\n    }\r\n}\r\n\r\nexport default Example;","import * as THREE from 'three';\nimport * as externalRenderers from '@arcgis/core/views/3d/externalRenderers';\n\nvar ExternalRendererThreeClass = (function () {\n    function ExternalRendererThreeClass() {\n        this.scene = new THREE.Scene();\n        this.camera = new THREE.PerspectiveCamera();\n        this.ambient = new THREE.AmbientLight(0xffffff, 0.5);\n        this.sun = new THREE.DirectionalLight(0xffffff, 0.5);\n    }\n    Object.defineProperty(ExternalRendererThreeClass, \"Instance\", {\n        get: function () {\n            return this.instance || (this.instance = new this());\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ExternalRendererThreeClass.prototype.start = function (view, threeMain) {\n        this.threeMain = threeMain;\n        externalRenderers.add(view, this);\n    };\n    ExternalRendererThreeClass.prototype.setup = function (context) {\n        if (!context) {\n            throw new Error(\"no context passed to setup, cannot work that way\");\n        }\n        if (this.threeMain === undefined) {\n            throw new Error(\"no implementation for the actual Three content found, intentional? Did not call start?\");\n        }\n        this.renderer = new THREE.WebGLRenderer({\n            context: context.gl,\n            premultipliedAlpha: false,\n            preserveDrawingBuffer: true,\n        });\n        this.renderer.setPixelRatio(window.devicePixelRatio);\n        this.renderer.setViewport(0, 0, context.view.width, context.view.height);\n        this.renderer.autoClear = false;\n        this.scene.add(this.ambient);\n        this.scene.add(this.sun);\n        this.threeMain.setup(context, this.renderer, this.scene);\n        context.resetWebGLState();\n    };\n    ExternalRendererThreeClass.prototype.render = function (context) {\n        this.camera.position.set(context.camera.eye[0], context.camera.eye[1], context.camera.eye[2]);\n        this.camera.up.set(context.camera.up[0], context.camera.up[1], context.camera.up[2]);\n        this.camera.lookAt(new THREE.Vector3(context.camera.center[0], context.camera.center[1], context.camera.center[2]));\n        this.camera.projectionMatrix.fromArray(context.camera.projectionMatrix);\n        var sunLight = context.sunLight;\n        this.sun.position.set(sunLight.direction[0], sunLight.direction[1], sunLight.direction[2]);\n        this.sun.intensity = sunLight.diffuse.intensity;\n        this.sun.color = new THREE.Color(sunLight.diffuse.color[0], sunLight.diffuse.color[1], sunLight.diffuse.color[2]);\n        this.ambient.intensity = sunLight.ambient.intensity;\n        this.ambient.color = new THREE.Color(sunLight.ambient.color[0], sunLight.ambient.color[1], sunLight.ambient.color[2]);\n        this.threeMain.render(context);\n        this.renderer.resetState();\n        context.bindRenderTarget();\n        this.renderer.render(this.scene, this.camera);\n        externalRenderers.requestRender(context.view);\n        context.resetWebGLState();\n    };\n    ExternalRendererThreeClass.prototype.dispose = function (context) {\n        this.threeMain.dispose(context);\n        this.scene.remove(this.ambient);\n        this.scene.remove(this.sun);\n        this.ambient.dispose();\n        this.sun.dispose();\n        this.renderer.dispose();\n    };\n    return ExternalRendererThreeClass;\n}());\nvar ExternalRendererThree = ExternalRendererThreeClass.Instance;\n\nexport { ExternalRendererThree };\n","import React, { Component } from 'react';\r\nimport './ArcGIS.css';\r\nimport Map from \"@arcgis/core/Map\";\r\nimport SceneView from \"@arcgis/core/views/SceneView\";\r\nimport config from \"@arcgis/core/config\";\r\nimport Example from './Example';\r\nimport { ExternalRendererThree } from \"@philippkoelmel/arcgis-threejs-externalrenderer\";\r\n\r\nexport default class ArcGIS extends Component<{}> {\r\n\r\n  componentDidMount() {\r\n\r\n    if (process.env.REACT_APP_ARCGIS_APIKEY === undefined) {\r\n      console.error(\"Please add your ARCGIS API key to the environment (see .env.local.example)\");\r\n      return;\r\n    }\r\n\r\n    config.apiKey = process.env.REACT_APP_ARCGIS_APIKEY;\r\n\r\n    const map = new Map({\r\n      basemap: \"arcgis-topographic\",\r\n      ground: \"world-elevation\"\r\n    });\r\n\r\n    const view = new SceneView({\r\n      container: \"arcgis_view\",\r\n      map: map,\r\n      viewingMode: \"global\",\r\n      camera: {\r\n        // ??\r\n        position: {\r\n          x: -9932671,\r\n          y: 2380007,\r\n          z: 1687219,\r\n          spatialReference: { wkid: 102100 }\r\n        },\r\n        heading: 0,\r\n        tilt: 35\r\n      },\r\n    });\r\n\r\n    if (view.environment.lighting !== undefined) {\r\n      view.environment.lighting.cameraTrackingEnabled = true;\r\n      //view.environment.lighting.date = new Date();\r\n    }\r\n\r\n    ExternalRendererThree.start(view, new Example());\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div id=\"arcgis_view\" className=\"map\" data-testid=\"arcgis_element\">\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport ArcGIS from './ArcGIS';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <ArcGIS />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}