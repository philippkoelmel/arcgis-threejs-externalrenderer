{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/TileLayerView3D.js","../node_modules/@arcgis/core/views/layers/TileLayerView.js","../node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","../node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","../node_modules/@arcgis/core/views/support/drapedUtils.js"],"names":["c","arguments","type","this","layer","tileInfo","format","e","lods","r","scale","t","length","levelRangeFromScaleRange","minLevel","maxLevel","get","o","s","originOf","fullExtent","addResolvingPromise","Promise","reject","_addTilingSchemeMatchPromise","f","view","a","suspended","emit","p","l","i","allSublayers","toArray","filter","minScale","maxScale","popupTemplate","popupEnabled","visible","map","createQuery","event","renderer","geometry","createFetchPopupFeaturesQueryGeometry","getRequiredFields","outFields","queryFeatures","features","then","concat","value","Boolean","prototype","m","n","readOnly","aliasOf","y","handles","add","doRefresh","catch","getLogger","declaredClass","error","xoffset","Math","max","abs","yoffset","stops","size","maxSize","minSize","floor","pointerType","visualVariables","symbol","uniqueValueInfos","forEach","classBreakInfos","resolution","overlayPixelSizeInMapUnits","basemapSpatialReference","equals","spatialReference","x","xmin","min","ymin","xmax","ymax"],"mappings":"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","file":"static/js/78.767baf5b.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Error.js\";import{isNone as t}from\"../../../core/maybe.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import{canProjectWithoutEngine as s}from\"../../../geometry/projection.js\";import{LayerView3D as a}from\"./LayerView3D.js\";import{TiledLayerView3D as l}from\"./TiledLayerView3D.js\";import n from\"../../layers/LayerView.js\";import{RefreshableLayerView as p}from\"../../layers/RefreshableLayerView.js\";import{TileLayerView as m}from\"../../layers/TileLayerView.js\";import{createQueryGeometry as f}from\"../../support/drapedUtils.js\";let c=class extends(p(l(m(a(n))))){constructor(){super(...arguments),this.type=\"tile-3d\"}get imageFormatIsOpaque(){return\"jpg\"===this.layer.tileInfo.format}get hasMixedImageFormats(){return\"mixed\"===this.layer.tileInfo.format}get dataLevelRange(){if(this.tileInfo){const e=this.tileInfo.lods,r=e[0].scale,t=e[e.length-1].scale;return this.levelRangeFromScaleRange(r,t)}return{minLevel:0,maxLevel:0}}initialize(){if(\"web-tile\"===this.layer.type){const e=this.layer.get(\"fullExtent.spatialReference\"),o=this.layer.get(\"tileInfo.spatialReference\");if(t(e)||t(o)||!s(e,o)){const e=\"defaults\"===this.layer.originOf(\"fullExtent\")||t(this.layer.fullExtent)?\"SceneView requires fullExtent to be specified by the user on WebTileLayer\":\"SceneView requires fullExtent to be specified in the same spatial reference as tileInfo on WebTileLayer\";this.addResolvingPromise(Promise.reject(new r(\"layerview:incompatible-fullextent\",e)))}}this._addTilingSchemeMatchPromise()}createFetchPopupFeaturesQueryGeometry(e,r){return f(e,r,this.view)}async doRefresh(e){this.suspended||this.emit(\"data-changed\")}};e([o({readOnly:!0})],c.prototype,\"imageFormatIsOpaque\",null),e([o({readOnly:!0})],c.prototype,\"hasMixedImageFormats\",null),e([o({aliasOf:\"layer.fullExtent\"})],c.prototype,\"fullExtent\",void 0),e([o()],c.prototype,\"layer\",void 0),e([o({aliasOf:\"layer.tileInfo\"})],c.prototype,\"tileInfo\",void 0),e([o({readOnly:!0})],c.prototype,\"dataLevelRange\",null),c=e([i(\"esri.views.3d.layers.TileLayerView3D\")],c);var y=c;export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{calculateTolerance as p}from\"../../renderers/support/clickToleranceUtils.js\";const i=i=>{let c=class extends i{async fetchPopupFeatures(e,s){const{layer:a}=this;if(!e)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:a}));if(\"tile\"!==a.type)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Layer type should be 'tile'\",{type:a.type}));const i=this.get(\"view.scale\"),c=a.allSublayers.toArray().filter((e=>{const r=0===e.minScale||i<=e.minScale,t=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&r&&t}));return o(c.map((async r=>{const o=r.createQuery(),a=t(s)?s.event:null,i=p({renderer:r.renderer,event:a});o.geometry=this.createFetchPopupFeaturesQueryGeometry(e,i),o.outFields=await r.popupTemplate.getRequiredFields();return(await r.queryFeatures(o)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return e([s()],c.prototype,\"layer\",void 0),c=e([a(\"esri.layers.mixins.TileLayerView\")],c),c};export{i as TileLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/watchUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";const a=a=>{let c=class extends a{initialize(){this.handles.add(o(this,\"layer\",\"refresh\",(()=>{this.doRefresh().catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([i(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{a as RefreshableLayerView,a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{isSome as e,isNone as t}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{calculateTolerance as n}from\"../../renderers/support/clickToleranceUtils.js\";import i from\"../../geometry/Extent.js\";function a(t,n,a,o=new i){let s;if(\"2d\"===a.type)s=n*a.resolution;else if(\"3d\"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?r(o)/r(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if(t(o))return!1;return a(o,n(),i,s).intersects(r)}const s=new i;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"sourceRoot":""}