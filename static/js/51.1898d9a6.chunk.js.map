{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/interactive/Manipulator3D.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/ShadedColorMaterial.js","../node_modules/@arcgis/core/views/3d/interactive/manipulatorUtils.js","../node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/sliceToolConfig.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/SlicePlaneMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/SlicePlaneMaterial.js","../node_modules/@arcgis/core/widgets/Slice/SlicePlane.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/SlicePlaneVisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/sliceToolUtils.js","../node_modules/@arcgis/core/views/3d/interactive/graphics/Slice/SliceController.js","../node_modules/@arcgis/core/views/3d/interactive/graphics/Slice/SliceView.js","../node_modules/@arcgis/core/views/3d/layers/analysis/Slice/SliceLayerViewData.js","../node_modules/@arcgis/core/views/3d/layers/SliceLayerView3D.js","../node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js","../node_modules/@arcgis/core/portal/support/resourceExtension.js","../node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js","../node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js","../node_modules/@arcgis/core/layers/support/I3SIndexInfo.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js","../node_modules/@arcgis/core/chunks/ShadedColorMaterial.glsl.js","../node_modules/@arcgis/core/chunks/SlicePlaneMaterial.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/ImageMaterial.js"],"names":["a","M","U","_","v","W","E","X","x","y","z","spatialReference","S","e","r","shader","get","i","this","configuration","t","build","output","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","screenSizeEnabled","shadingEnabled","OITEnabled","transparencyPassType","multipassTerrainEnabled","cullAboveGround","b","rctx","P","n","color","l","shadingTint","p","shadingDirection","s","program","camera","projectionMatrix","setUniform4fv","setUniform2fv","nearFar","inverseViewport","o","blendColor","w","setUniform3fv","setUniformMatrix4fv","viewInverseTransposeMatrix","origin","rebindTextures","blending","transparent","h","m","culling","cullFace","depthTest","func","depthWrite","writeDepth","T","u","colorWrite","polygonOffset","g","setPipelineState","f","j","arguments","c","d","count","prototype","Map","updateParameters","_technique","_techniqueRep","releaseAndAcquire","q","_material","getTechniqueConfig","_output","bindPass","getPassParameters","C","screenSize","vec3f","vertexBufferLayout","createBuffer","indices","length","transformation","invTranspTransformation","vertexAttributes","has","Error","size","getField","data","Math","cos","backgroundColor","gridColor","setUniform1f","gridWidth","constructionContext","params","_renderOccluded","_gridWidth","_gridColor","_backgroundColor","applyProps","_updateMaterial","materialParameters","createSquareGeometry","addGeometry","renderOccluded","setParameterValues","type","position","heading","tilt","width","height","equals","readOnly","json","read","write","Number","nonNullable","range","min","max","normalize","xe","getLogger","De","worldUpAtPosition","B","basis1","mt","round","yt","L","st","Pe","view","attached","ne","writeDepthEnabled","geometry","D","basis2","dt","gt","toRenderCoords","worldBasisAtPosition","I","plane","F","G","error","wkid","PI","V","_handles","_internalChange","_currentSlicePlane","state","add","layerView","layerViewData","excludedLayers","on","item","title","id","preventDefault","includes","_initialize","set","all","activeController","push","watch","_updateSlicePlaneFromBoundedPlane","_updateLayerViews","_updateActiveController","_updateViewSlicePlane","allLayerViews","analysis","_updateBoundedPlaneFromSlicePlane","_set","active","lastIndexOf","splice","delete","destroy","slicePlane","hasZ","clone","Te","elevationProvider","renderCoordsHelper","console","warn","tiltEnabled","Fe","Ge","fromRenderCoords","visible","forEach","layers","indexOf","layer","sublayerViews","sublayer","basemapTerrain","excludeGroundSurface","_gridVisualElement","_outlineVisualElement","_updateMaterials","Oe","ce","le","fullOpacity","_updatePlane","N","k","transform","editable","stipplePattern","showGrid","value","_get","cast","analysisView","analysisController","_initialized","resolve","destroyed","promise","whenReady","controller","aliasOf","Blob","url","png","jpeg","jpg","bmp","gif","txt","xml","svg","zip","pbf","gz","origins","String","writer","resources","verifyItemRelativeUrls","writtenUrls","rootPath","originIdOf","portalItem","resourceFromPath","path","O","toUpdate","toKeep","resource","pendingOperations","then","itemRelativeUrl","catch","toAdd","content","finish","R","JSON","stringify","toJSON","default","responseType","_resources","_transform","object","createResources","_stage","removeMany","geometries","removeAllGeometries","createGeometries","setVisible","addMany","destroyResources","isPickable","updatePolicy","castShadow","createExternalResources","forEachExternalMaterial","remove","dispose","destroyExternalResources","_attached","_resourcesCreated","_visible","_createResources","_destroyResources","updateVisibility","_width","_color","_innerWidth","_innerColor","_stipplePattern","_stippleOffColor","_stippleIntegerRepeats","_writeDepthEnabled","_falloff","_polygonOffset","lines","endpoint","endRenderSpace","createRenderGeometry","points","map","_geometry","recreateGeometry","recreate","_createLineGeometries","stippleOffColor","isClosed","falloff","innerColor","innerWidth","stippleIntegerRepeats","Float64Array","attributeData","removeDuplicateStartEnd","include","linearDepth","vertex","uniforms","attributes","varyings","code","fragment","float","Object","freeze","__proto__","floor","rootIndex","nodesPerPage","query","token","signal","lodSelectionMetricType","rootPage","pageSize","lodMetric","urlPrefix","split","pop","rootNode","pageError","nodeError","perScreenPixelRatio","extensions","opacity","stencilWrite","sceneHasOcludees","stencilTest","enableOffset","_occludeePipelineState","pipeline","supportsEdges","techniqueConfig","relativeElevation","material","updateTexture","textureId","hasOccludees","_updateOccludeeState","bindTextures","bindTextureScale","getPipelineState","initTextureTransparent"],"mappings":"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","file":"static/js/51.1898d9a6.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport\"../../../geometry.js\";import{neverReached as e}from\"../../../core/compilerUtils.js\";import t from\"../../../core/Evented.js\";import{deg2rad as i}from\"../../../core/mathUtils.js\";import{isSome as s,isNone as o,unwrapOr as r,unwrap as n}from\"../../../core/maybe.js\";import{createScreenPointArray as a,createRenderScreenPointArray3 as c,screenPointObjectToArray as l,castRenderScreenPointArray as h}from\"../../../core/screenUtils.js\";import{once as d}from\"../../../core/accessorSupport/utils.js\";import{f as u}from\"../../../chunks/mat3.js\";import{c as _}from\"../../../chunks/mat3f64.js\";import{e as g,s as m,m as f,i as p}from\"../../../chunks/mat4.js\";import{c as v}from\"../../../chunks/mat4f64.js\";import{j as b}from\"../../../chunks/vec2.js\";import{b as y,t as j,m as L,a as S,g as R,h as w,s as O,f as T}from\"../../../chunks/vec3.js\";import{c as E,Z as A}from\"../../../chunks/vec3f64.js\";import{canProjectWithoutEngine as D,projectPoint as F,sphericalPCPFtoLonLatElevation as z,computeENUToSphericalPCPFLocalRotation as k}from\"../../../geometry/projection.js\";import{getReferenceEllipsoid as P}from\"../../../geometry/projectionEllipsoid.js\";import{containsPointObject as I}from\"../../../geometry/support/aaBoundingRect.js\";import{create as M,distance2 as C,fromPoints as x,closestRayDistance2 as B}from\"../../../geometry/support/lineSegment.js\";import{create as W,fromPositionAndNormal as V,intersectRay as H}from\"../../../geometry/support/plane.js\";import{create as U}from\"../../../geometry/support/ray.js\";import{sv3d as G}from\"../../../geometry/support/vectorStacks.js\";import{clonePoint as Z}from\"../../../layers/graphics/hydratedFeatures.js\";import{getElevationAtPoint as q}from\"../support/ElevationProvider.js\";import{fromScreen as J}from\"../support/geometryUtils/ray.js\";import K from\"../webgl-engine/lib/Camera.js\";import{Object3D as N}from\"../webgl-engine/lib/Object3D.js\";import{WebGLLayer as Q}from\"../webgl-engine/lib/WebGLLayer.js\";import X from\"../../../geometry/Point.js\";class Y{constructor(e){this.idHint=0,this.camera=new K,this._elevation={offset:0,override:null},this.collisionType={type:\"point\"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=v(),this._worldFrame=null,this._renderLocation=E(),this._renderLocationDirty=!0,this._location=new X({x:0,y:0,z:0}),this._elevationAlignedLocation=new X,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=0,this._focused=!1,this.events=new t.EventEmitter,this._screenLocation={screenPointArray:a(),renderScreenPointArray:c(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=e.view.spatialReference;for(const t in e)this[t]=e[t];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:d((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()}))}}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){$(e)&&(this._screenLocationDirty=!0),g(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=v()),ee(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){Z(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit(\"location-update\",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){Z(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit(\"location-update\",{location:this._location})}_updateElevationAlignedLocation(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;const e=s(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit(\"select-changed\",{action:e?\"select\":\"deselect\"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit(\"focus-changed\",{action:!0===e?\"focus\":\"unfocus\"}))}get focused(){return this._focused}get screenLocation(){return this.ensureScreenLocation(),this._screenLocation}ensureScreenLocation(){if(!this._screenLocationDirty)return;this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1;let e;if($(this._modelTransform)){const t=this._calculateModelTransformOffset(_e);e=y(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}intersectionDistance(t,i){if(!this.available)return null;const s=l(t,te),r=this._getCollisionRadius(i),n=-1*this.collisionPriority;switch(this.collisionType.type){case\"point\":if(b(this.screenLocation.screenPointArray,s)<r*r)return this.screenLocation.renderScreenPointArray[2]+n;break;case\"line\":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,ne),a=r*this.screenLocation.pixelSize,c=J(this.camera,s,se);if(o(c))return null;for(const s of e){if(0===s.length)continue;const e=L(ce,s[0],i);for(let t=1;t<s.length;t++){const o=L(le,s[t],i),r=B(x(e,o,ie),c);if(null!=r&&r<a*a){const t=y(G.get(),e,o);S(t,t,.5);const i=h(G.get());return this.camera.projectToRenderScreen(t,i),i[2]+n}R(e,o)}}break}case\"disc\":{var a;const e=this.collisionType.direction,t=null!=(a=this.collisionType.offset)?a:A,i=this._getWorldToScreenObjectScale(),c=this._calculateObjectTransform(i,ne),l=r*this.screenLocation.pixelSize,h=J(this.camera,s,se);if(o(h))return null;const d=u(oe,c),_=j(de,e,d),g=L(ue,t,c);V(g,_,ae);const m=he;if(H(ae,h,m)&&w(m,g)<l*l)return this.screenLocation.renderScreenPointArray[2]+n;break}case\"ribbon\":{const{paths:e,direction:t}=this.collisionType,i=this._getWorldToScreenObjectScale(),a=this._calculateObjectTransform(i,ne),c=r*this.camera.computeScreenPixelSizeAt(this.renderLocation),l=J(this.camera,s,se);if(o(l))return null;const d=u(oe,a),_=j(de,t,d),g=this._calculateModelTransformPosition(ue);V(g,_,ae);const m=he;if(!H(ae,l,m))break;for(const s of e){if(0===s.length)continue;const e=L(ce,s[0],a);for(let t=1;t<s.length;t++){const i=L(le,s[t],a),o=C(x(e,i,ie),m);if(null!=o&&o<c*c){const t=y(G.get(),e,i);S(t,t,.5);const s=h(G.get());return this.camera.projectToRenderScreen(t,s),s[2]+n}R(e,i)}}break}default:e(this.collisionType)}return null}attach(e={manipulator3D:{}}){var t;if(!this.view._stage)return;const i=e.manipulator3D;if(o(i.engineLayerId)){const e=new Q({isPickable:!1,updatePolicy:1});this.view._stage.add(e),i.engineLayerId=e.id,this._engineLayer=e}else null!=(t=this.view._stage)&&t.getObject&&(this._engineLayer=this.view._stage.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,o(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),D(this._location.spatialReference,this.view.spatialReference)||(this.location=new X({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){F(this.location,ge,e.spatialReference),I(e.extent,ge)&&(this.location=this._location)}_evaluateElevationAlignment(e=this.location){if(o(this.elevationInfo))return!1;let t=null,i=0;const s=r(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case\"on-the-ground\":t=r(q(this.view.elevationProvider,e,\"ground\"),0);break;case\"relative-to-ground\":i=r(q(this.view.elevationProvider,e,\"ground\"),0)+s;break;case\"relative-to-scene\":i=r(q(this.view.elevationProvider,e,\"scene\"),0)+s;break;case\"absolute-height\":i=s}return(i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=ne;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),s=(this.focused?2:1)|(this.selected?8:4),o=this._noDisplayCount>0;for(const{stateMask:r,objects:n}of i){if(o){for(const e of n)e.setVisible(!1);continue}const e=!(0!=(15&r))||(s&r)==(15&r),i=!(0!=(65520&r))||(this.state&r)==(65520&r);if(e&&i)for(const s of n)s.setVisible(!0),s.transformation=t;else for(const t of n)t.setVisible(!1)}}_ensureEngineResources(){if(o(this._engineResources)){const e=n(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach((({material:e})=>{i.has(e)||(t.push(e),i.add(e))}));const s=(e,t)=>{const{geometry:i,material:s,transform:o}=t;Array.isArray(i)?i.forEach((t=>e.addGeometry(t,s,o))):e.addGeometry(i,s,o)},o=new Map;this._renderObjects.forEach((e=>{const t=new N({castShadow:!1});s(t,e);const i=e.stateMask||0,r=o.get(i)||[];r.push(t),o.set(i,r)}));const r=[];o.forEach(((e,t)=>r.push({stateMask:t,objects:e}))),this._engineResources={objectsByState:r,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){if(this._engineResourcesAddedToStage||o(this._engineResources))return;const{objectsByState:e,layer:t,materials:i}=this._engineResources;i.forEach((e=>{const t=n(this._materialIdReferences),i=t.get(e.id)||0;0===i&&this.view._stage.add(e),t.set(e.id,i+1)})),e.forEach((({objects:e})=>{t.addMany(e),this.view._stage.addMany(e)})),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(e=!1){if(!this._engineResourcesAddedToStage||o(this._engineResources))return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;t.forEach((({objects:e})=>{i.removeMany(e),this.view._stage.removeMany(e)})),s.forEach((e=>{const t=n(this._materialIdReferences),i=t.get(e.id);1===i?(this.view._stage.remove(e),t.delete(e.id)):t.set(e.id,i-1)})),e&&this.view._stage.remove(i),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*(\"touch\"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,re);return O(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return T(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return m(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&f(t,t,this._worldFrame),f(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,s(this._applyObjectTransform)&&this._applyObjectTransform(t),t}get test(){let e=!1;if(s(this._engineResources))for(const t in this._engineResources.objectsByState){const i=this._engineResources.objectsByState[t];for(const t of i.objects)if(t.isVisible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function $(e){return 0!==e[12]||0!==e[13]||0!==e[14]}function ee(e,t,s){switch(e.viewingMode){case\"local\":return p(s),!0;case\"global\":{const o=P(e.renderCoordsHelper.spatialReference);return z(t,0,ce,0,o.radius),k(i(ce[0]),i(ce[1]),s),!0}}}const te=a(),ie=M(),se=U(),oe=_(),re=v(),ne=v(),ae=W(),ce=E(),le=E(),he=E(),de=E(),ue=E(),_e=E(),ge=new X({x:0,y:0,z:0,spatialReference:null});export{Y as Manipulator3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{c as r}from\"../../../../chunks/vec4f64.js\";import{bindScreenSizeScalingUniforms as i}from\"../core/shaderLibrary/ScreenSizeScaling.glsl.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as o}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as s,bindView as a,bindCameraPosition as n}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as l}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as p}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as d,ShaderTechniqueConfiguration as c}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{blendingDefault as h,OITBlending as m,OITDepthWrite as u,OITPolygonOffset as g}from\"../lib/OrderIndependentTransparency.js\";import{Program as b}from\"../lib/Program.js\";import{S as f}from\"../../../../chunks/ShadedColorMaterial.glsl.js\";import{makePipelineState as v,cullingParams as y,defaultDepthWriteParams as T,defaultColorWriteParams as E}from\"../../../webgl/renderState.js\";class S extends p{initializeProgram(e){const r=S.shader.get(),i=this.configuration,t=r.build({output:i.output,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:i.screenSizeEnabled,shadingEnabled:i.shadingEnabled,OITEnabled:0===i.transparencyPassType,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new b(e.rctx,t,P)}bindPass(e,r){const{screenSizeEnabled:t,shadingEnabled:a}=this.configuration,{color:n,shadingTint:l,shadingDirection:p}=e;s(this.program,r.camera.projectionMatrix),this.program.setUniform4fv(\"color\",n),r.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",r.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",r.inverseViewport),o(this.program,r)),a&&(this.program.setUniform4fv(\"shadedColor\",this.blendColor(w,l,n)),this.program.setUniform3fv(\"shadingDirection\",p),this.program.setUniformMatrix4fv(\"viewNormal\",r.camera.viewInverseTransposeMatrix)),t&&i(this.program,e,r)}bindDraw(e){a(this.program,e),n(this.program,e.origin,e.camera.viewInverseTransposeMatrix),t(this.program,this.configuration,e),this.program.rebindTextures()}blendColor(e,r,i){const t=1-r[3],o=r[3]+i[3]*t;return 0===o?(e[3]=o,e):(e[0]=(r[0]*r[3]+i[0]*i[3]*t)/o,e[1]=(r[1]*r[3]+i[1]*i[3]*t)/o,e[2]=(r[2]*r[3]+i[2]*i[3]*t)/o,e[3]=i[3],e)}setPipelineState(e){const r=this.configuration,i=3===e,t=2===e;return v({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?h:m(e),culling:y(r.cullFace),depthTest:{func:t?513:r.shadingEnabled?515:513},depthWrite:i?r.writeDepth&&T:u(e),colorWrite:E,polygonOffset:i||t?null:g})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}}S.shader=new l(f,(()=>import(\"./ShadedColorMaterial.glsl.js\")));class j extends c{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([d({count:8})],j.prototype,\"output\",void 0),e([d({count:3})],j.prototype,\"cullFace\",void 0),e([d()],j.prototype,\"slicePlaneEnabled\",void 0),e([d()],j.prototype,\"transparent\",void 0),e([d()],j.prototype,\"writeDepth\",void 0),e([d()],j.prototype,\"screenSizeEnabled\",void 0),e([d()],j.prototype,\"shadingEnabled\",void 0),e([d({count:4})],j.prototype,\"transparencyPassType\",void 0),e([d()],j.prototype,\"multipassTerrainEnabled\",void 0),e([d()],j.prototype,\"cullAboveGround\",void 0);const P=new Map([[\"position\",0],[\"normal\",1],[\"offset\",2]]),w=r();export{S as ShadedColorMaterialTechnique,j as ShadedColorMaterialTechniqueConfiguration,P as ShadedColorMaterialVertexAttrLocations};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{n as e,s as t,a as r,b as i}from\"../../../../chunks/vec3.js\";import{c as s}from\"../../../../chunks/vec3f64.js\";import{center as a,scale as n}from\"../../../../geometry/support/aaBoundingBox.js\";import{BufferViewVec3f as o}from\"../../../../geometry/support/buffer/BufferView.js\";import{newLayout as u}from\"../../support/buffer/InterleavedLayout.js\";import c from\"../lib/GLMaterial.js\";import{materialParametersDefaults as h,Material as f}from\"../lib/Material.js\";import{assert as l}from\"../lib/Util.js\";import{writeDefaultAttributes as p,writePosition as m}from\"./internal/bufferWriterUtils.js\";import{intersectTriangleGeometry as d}from\"./internal/MaterialUtil.js\";import{ShadedColorMaterialTechniqueConfiguration as b,ShadedColorMaterialVertexAttrLocations as g,ShadedColorMaterialTechnique as q}from\"../shaders/ShadedColorMaterialTechnique.js\";class v extends f{constructor(e){super(e,C),this.supportsEdges=!0,this.techniqueConfig=new b,this._vertexAttributeLocations=g}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.screenSizeEnabled=this.params.screenSizeEnabled,this.techniqueConfig.shadingEnabled=this.params.shadingEnabled,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}getPassParameters(){return this.params}intersect(e,s,o,u,c,h,f){if(this.params.screenSizeEnabled){const o=e.vertexAttributes.get(\"offset\"),l={applyToVertex:(e,s,a,n)=>{const c=t(P,o.data[3*n+0],o.data[3*n+1],o.data[3*n+2]),h=t(x,e,s,a);return r(c,c,this.params.screenSize*u.camera.computeRenderPixelSizeAt(c)),i(h,h,c),[h[0],h[1],h[2]]},applyToAabb:e=>{const t=a(e,P);return n(e,this.params.screenSize*u.camera.computeRenderPixelSizeAt(t))}};d(e,s,u,c,h,l,f)}else d(e,s,u,c,h,void 0,f)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new E(e):void 0}createBufferWriter(){return new S(this.params.screenSizeEnabled)}}class E extends c{constructor(e){super(e),this.updateParameters()}updateParameters(e){this._technique=this._techniqueRep.releaseAndAcquire(q,this._material.getTechniqueConfig(this._output,e),this._technique)}beginSlot(e){if(4===this._output)return 3===e;let t=3;return this._technique.configuration.transparent&&(t=this._technique.configuration.writeDepth?5:8),e===t||23===e}ensureParameters(e){this.updateParameters(e)}bind(e){this._technique.bindPass(this._material.getPassParameters(),e)}}const C={color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:e(s(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0,...h};class S{constructor(e){this.screenSizeEnabled=e;const t=u().vec3f(\"position\").vec3f(\"normal\");this.screenSizeEnabled&&t.vec3f(\"offset\"),this.vertexBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(\"position\").length}write(e,t,r,i){if(p(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,i),this.screenSizeEnabled){if(!t.vertexAttributes.has(\"offset\"))throw new Error(\"offset vertex attribute required for screenSizeEnabled ShadedColorMaterial\");{const s=t.vertexAttributes.get(\"offset\"),a=t.indices.get(\"offset\");l(3===s.size);const n=r.getField(\"offset\",o);if(!n)throw new Error(\"unable to acquire view for offset\");m(a,s.data,e.invTranspTransformation,n,i)}}}}const P=s(),x=s();export{v as ShadedColorMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../core/maybe.js\";import{b as r}from\"../../../chunks/mat4.js\";import{f as n,c as o,m as c,n as a}from\"../../../chunks/vec3.js\";import{f as i}from\"../../../chunks/vec4f64.js\";import{sv3d as s,sm4d as l}from\"../../../geometry/support/vectorStacks.js\";import{hydrateGeometry as m}from\"../../../layers/graphics/hydratedFeatures.js\";import{Manipulator3D as u}from\"./Manipulator3D.js\";import{computeCentroid as p}from\"../layers/graphics/graphicUtils.js\";import g from\"../webgl-engine/lib/GeometryUtil.js\";import{ColorMaterial as f}from\"../webgl-engine/materials/ColorMaterial.js\";import{ShadedColorMaterial as h}from\"../webgl-engine/materials/ShadedColorMaterial.js\";function d(e,t=4,r=!0){const n=i(e[0],e[1],e[2],e.length>3?e[3]:1),o=e[3]<1;return r?new h({color:n,transparent:o,writeDepth:!0,cullFace:2,renderOccluded:t}):new f({color:n,transparent:o,writeDepth:!0,cullFace:2,renderOccluded:t})}function j(e,t=4){const r=i(e[0],e[1],e[2],4===e.length?e[3]:1);return new f({color:r,transparent:!0,writeDepth:!0,cullFace:1,renderOccluded:t})}function w(e,t,r){return new u({view:e,renderObjects:[{geometry:g.createSphereGeometry(1,32,32),material:d(i(t[0],t[1],t[2],null!=r?r:1))}]})}function y(e,t,a,i){const m=n(s.get(),e,a),u=b(m,o(s.get(),i,m),a,l.get());r(u,u);const p=c(s.get(),t,u);return Math.atan2(p[1],p[0])}function b(e,t,r,n){const c=a(s.get(),e),i=a(s.get(),t),l=o(s.get(),c,i);return n[0]=c[0],n[1]=c[1],n[2]=c[2],n[3]=0,n[4]=i[0],n[5]=i[1],n[6]=i[2],n[7]=0,n[8]=l[0],n[9]=l[1],n[10]=l[2],n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n}function O(t,r){const n=t.getViewForGraphic(r);return e(n)&&\"computeAttachmentOrigin\"in n?n.computeAttachmentOrigin(r,t.spatialReference):null}function v(t,r,n){const o=O(t,n);e(o)?r.elevationAlignedLocation=o:F(r,n.geometry)}function F(e,r){if(t(r))return;const n=\"mesh\"===r.type?r.anchor:p(r);t(n)||(e.location=m(n))}export{y as calculateInputRotationTransform,b as calculateTranslateRotateFromBases,d as createManipulatorMaterial,j as createManipulatorOutlineMaterial,w as createSphereManipulator,O as getGraphicAttachmentOrigin,v as placeAtGraphic};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport o from\"../../../../../core/has.js\";import{deg2rad as t}from\"../../../../../core/mathUtils.js\";const r=o(\"mac\")?\"Meta\":\"Control\",s=\"Shift\",a=2,c=1.15,m=1.15,h=1.1,e=2500,i=.02,f=Math.cos(t(45)),p=Math.cos(t(5)),M=.95,j=.3,l=.7,n=[1,.5,0],x=2,C=1,S=[...n,l],U=[0,0,0,.04],b=[...n,.5],d=[...n,1],g=[1,1,1,1],k=[1,.8,.6,1],q=[1,.93,.86,1],u=[...n,1],v=[...n,1],w=3,y=11,z=22.5,A=40,B=48,D=2.25,E=4,F=1,G=.3,H=6,I=4,J=12,K=40,L=27,N=1600,O=.4;export{a as DISPLAY_FOCUS_MULTIPLIER,b as GRID_COLOR,n as HANDLE_COLOR,l as HANDLE_OPACITY,i as INITIAL_DEPTH_OFFSET_FRAC,O as INITIAL_PLANE_HALF_SIZE_VIEW_PROPORTION,U as PLANE_BACKGROUND_COLOR,N as PLANE_MIN_BASIS_SCREEN_LEN2,S as PLANE_OUTLINE_COLOR,C as PLANE_OUTLINE_WIDTH,x as PLANE_PREVIEW_OUTLINE_WIDTH,e as POINTER_MOVE_TIMER_MS,M as PREVIEW_FADE_DOT_THRESHOLD,j as PREVIEW_FADE_DURATION_SECONDS,H as RESIZE_HANDLE_CORNER_INPUT_RADIUS,E as RESIZE_HANDLE_CORNER_WIDTH,I as RESIZE_HANDLE_EDGE_INPUT_RADIUS,G as RESIZE_HANDLE_EDGE_PADDING_FRAC,F as RESIZE_HANDLE_EDGE_WIDTH,d as ROTATE_HEADING_CALLOUT_COLOR,L as ROTATE_HEADING_DISC_RADIUS,h as ROTATE_HEADING_DISC_RADIUS_FOCUS_MULTIPLIER,K as ROTATE_HEADING_OFFSET_DISTANCE,J as ROTATE_HEADING_TIP_LENGTH,k as SHIFT_RESTART_ARROW_CAP_COLOR,B as SHIFT_RESTART_ARROW_LENGTH,D as SHIFT_RESTART_ARROW_OUTLINE_WIDTH,g as SHIFT_RESTART_ARROW_TIP_COLOR,u as SHIFT_RESTART_CALLOUT_COLOR,A as SHIFT_RESTART_OFFSET_DISTANCE,v as SHIFT_RESTART_OUTLINE_COLOR,m as SHIFT_RESTART_TIP_FOCUS_MULTIPLIER,z as SHIFT_RESTART_TIP_LENGTH,y as SHIFT_RESTART_TIP_RADIUS,q as SHIFT_RESTART_TUBE_COLOR,c as SHIFT_RESTART_TUBE_FOCUS_MULTIPLIER,w as SHIFT_RESTART_TUBE_RADIUS,p as SMALL_ANGLE_DOT_THRESHOLD,f as VERTICAL_DOT_THRESHOLD,r as forceHorizontalModifier,s as forceVerticalModifier};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{bindProjectionMatrix as r,bindView as e}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as i}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{Default3D as t}from\"../lib/DefaultVertexAttributeLocations.js\";import{Program as a}from\"../lib/Program.js\";import{S as s}from\"../../../../chunks/SlicePlaneMaterial.glsl.js\";import{makePipelineState as l,separateBlendingParams as n,defaultColorWriteParams as m}from\"../../../webgl/renderState.js\";class d extends o{initializeProgram(r){const e=d.shader.get().build();return new a(r.rctx,e,t)}bindPass(e,i){r(this.program,i.camera.projectionMatrix),this.program.setUniform4fv(\"backgroundColor\",e.backgroundColor),this.program.setUniform4fv(\"gridColor\",e.gridColor),this.program.setUniform1f(\"gridWidth\",e.gridWidth)}bindDraw(r){e(this.program,r),this.program.rebindTextures()}initializePipeline(){return l({blending:n(1,1,771,771),depthTest:{func:513},colorWrite:m})}}d.shader=new i(s,(()=>import(\"./SlicePlaneMaterial.glsl.js\")));export{d as SlicePlaneMaterialTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import{autoDispose as r}from\"../lib/AutoDisposable.js\";import e from\"../lib/GLMaterial.js\";import{Material as i,materialParametersDefaults as s}from\"../lib/Material.js\";import{DefaultBufferWriter as o,PositionUVLayout as a}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as n}from\"./internal/MaterialUtil.js\";import{SlicePlaneMaterialTechnique as u}from\"../shaders/SlicePlaneMaterialTechnique.js\";class l extends i{constructor(t){super(t,m)}intersect(t,r,e,i,s,o,a){return n(t,r,i,s,o,void 0,a)}createBufferWriter(){return new o(a)}getGLMaterial(t){return 0===t.output?new c(t):void 0}}class c extends e{constructor(t){super(t),this._technique=new u(this._techniqueRep.constructionContext,null),this.updateParameters()}updateParameters(){}beginSlot(t){return 8===t}bind(t){this._technique.bindPass(this._material.params,t)}}t([r()],c.prototype,\"_technique\",void 0);const m={backgroundColor:[1,0,0,.5],gridColor:[0,1,0,.5],gridWidth:4,...s};export{l as SlicePlaneMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{JSONSupport as o}from\"../../core/JSONSupport.js\";import{clone as e}from\"../../core/lang.js\";import{isSome as i}from\"../../core/maybe.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{cast as s}from\"../../core/accessorSupport/decorators/cast.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{ensureNumber as a}from\"../../core/accessorSupport/ensureType.js\";import{persistable as h}from\"../../core/accessorSupport/decorators/persistable.js\";import{cyclicalDeg as n}from\"../../views/3d/support/mathUtils.js\";import m from\"../../geometry/Point.js\";var l;let c=l=class extends o{constructor(t){super(t),this.type=\"plane\",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}clone(){return new l({position:e(this.position),heading:this.heading,tilt:this.tilt,width:this.width,height:this.height})}equals(t){return this.heading===t.heading&&this.tilt===t.tilt&&i(this.position)&&i(t.position)&&this.position.equals(t.position)&&this.width===t.width&&this.height===t.height}};t([r({readOnly:!0,json:{read:!1,write:!0}})],c.prototype,\"type\",void 0),t([r({type:m}),h()],c.prototype,\"position\",void 0),t([r({type:Number,nonNullable:!0,range:{min:0,max:360}}),h(),s((t=>n.normalize(a(t),0,!0)))],c.prototype,\"heading\",void 0),t([r({type:Number,nonNullable:!0,range:{min:0,max:360}}),h(),s((t=>n.normalize(a(t),0,!0)))],c.prototype,\"tilt\",void 0),t([r({type:Number,nonNullable:!0}),h()],c.prototype,\"width\",void 0),t([r({type:Number,nonNullable:!0}),h()],c.prototype,\"height\",void 0),c=l=t([p(\"esri.widgets.Slice.SlicePlane\")],c);var d=c;export{d as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as r}from\"../../../../core/maybe.js\";import{c as e}from\"../../../../chunks/vec4.js\";import{f as t}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as i}from\"./Object3DVisualElement.js\";import a from\"../../webgl-engine/lib/GeometryUtil.js\";import{SlicePlaneMaterial as s}from\"../../webgl-engine/materials/SlicePlaneMaterial.js\";class d extends i{constructor(r){super(r),this._material=null,this._renderOccluded=4,this._gridWidth=1,this._gridColor=t(1,0,0,1),this._backgroundColor=t(1,0,0,1),this.applyProps(r)}get renderOccluded(){return this._renderOccluded}set renderOccluded(r){r!==this._renderOccluded&&(this._renderOccluded=r,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(r){this._gridWidth!==r&&(this._gridWidth=r,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(r){e(this._gridColor,r),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(r){e(this._backgroundColor,r),this._updateMaterial()}createExternalResources(){this._material=new s(this.materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(e){r(this._material)&&e(this._material)}createGeometries(e){if(r(this._material)){const r=a.createSquareGeometry();e.addGeometry(r,this._material)}}get materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){r(this._material)&&this._material.setParameterValues(this.materialParameters)}}export{d as SlicePlaneVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport\"../../../../../geometry.js\";import{neverReached as e}from\"../../../../../core/compilerUtils.js\";import t from\"../../../../../core/Logger.js\";import{rad2deg as i,deg2rad as s}from\"../../../../../core/mathUtils.js\";import{isNone as r,isSome as o,unwrapOr as n}from\"../../../../../core/maybe.js\";import{castRenderScreenPointArray3 as a}from\"../../../../../core/screenUtils.js\";import{r as c,i as l,f as m,m as d,c as g,t as u,x as p}from\"../../../../../chunks/mat4.js\";import{c as f}from\"../../../../../chunks/mat4f64.js\";import{r as b}from\"../../../../../chunks/quat.js\";import{a as h,g as w,d as y,c as j,n as M,b as k,l as v,f as P,p as O,s as T}from\"../../../../../chunks/vec3.js\";import{a as U,c as R,f as S}from\"../../../../../chunks/vec3f64.js\";import{r as L,f as A,i as E,a as C,n as F,u as G}from\"../../../../../chunks/boundedPlane.js\";import{fromPositionAndNormal as x,fromVectorsAndPoint as I}from\"../../../../../geometry/support/plane.js\";import{create as z}from\"../../../../../geometry/support/ray.js\";import{angleAroundAxis as D}from\"../../../../../geometry/support/vector.js\";import{sv3d as B,sm4d as H,sq4d as V}from\"../../../../../geometry/support/vectorStacks.js\";import{Manipulator3D as q}from\"../../Manipulator3D.js\";import{calculateTranslateRotateFromBases as N}from\"../../manipulatorUtils.js\";import{SHIFT_RESTART_TIP_RADIUS as W,RESIZE_HANDLE_EDGE_PADDING_FRAC as Z,SMALL_ANGLE_DOT_THRESHOLD as $,PLANE_MIN_BASIS_SCREEN_LEN2 as J,INITIAL_PLANE_HALF_SIZE_VIEW_PROPORTION as K,SHIFT_RESTART_OFFSET_DISTANCE as Q,SHIFT_RESTART_ARROW_OUTLINE_WIDTH as X,SHIFT_RESTART_ARROW_TIP_COLOR as Y,SHIFT_RESTART_ARROW_CAP_COLOR as _,SHIFT_RESTART_TUBE_COLOR as ee,SHIFT_RESTART_OUTLINE_COLOR as te,SHIFT_RESTART_CALLOUT_COLOR as ie,ROTATE_HEADING_OFFSET_DISTANCE as se,ROTATE_HEADING_DISC_RADIUS as re,ROTATE_HEADING_CALLOUT_COLOR as oe,PLANE_OUTLINE_COLOR as ne,PLANE_OUTLINE_WIDTH as ae,PLANE_BACKGROUND_COLOR as ce,GRID_COLOR as le,HANDLE_COLOR as me,RESIZE_HANDLE_CORNER_INPUT_RADIUS as de,RESIZE_HANDLE_EDGE_INPUT_RADIUS as ge,ROTATE_HEADING_TIP_LENGTH as ue,VERTICAL_DOT_THRESHOLD as pe,ROTATE_HEADING_DISC_RADIUS_FOCUS_MULTIPLIER as fe,DISPLAY_FOCUS_MULTIPLIER as be,RESIZE_HANDLE_EDGE_WIDTH as he,SHIFT_RESTART_ARROW_LENGTH as we,SHIFT_RESTART_TUBE_RADIUS as ye,SHIFT_RESTART_TIP_LENGTH as je,SHIFT_RESTART_TUBE_FOCUS_MULTIPLIER as Me,SHIFT_RESTART_TIP_FOCUS_MULTIPLIER as ke,RESIZE_HANDLE_CORNER_WIDTH as ve}from\"./sliceToolConfig.js\";import{LineVisualElement as Pe}from\"../../visualElements/LineVisualElement.js\";import{SlicePlaneVisualElement as Oe}from\"../../visualElements/SlicePlaneVisualElement.js\";import{getElevationAtPoint as Te}from\"../../../support/ElevationProvider.js\";import{fromRender as Ue}from\"../../../support/geometryUtils/ray.js\";import{Geometry as Re}from\"../../../webgl-engine/lib/Geometry.js\";import Se from\"../../../webgl-engine/lib/GeometryUtil.js\";import{ColorMaterial as Le}from\"../../../webgl-engine/materials/ColorMaterial.js\";import{ImageMaterial as Ae}from\"../../../webgl-engine/materials/ImageMaterial.js\";import{NativeLineMaterial as Ee}from\"../../../webgl-engine/materials/NativeLineMaterial.js\";import{RibbonLineMaterial as Ce}from\"../../../webgl-engine/materials/RibbonLineMaterial.js\";import Fe from\"../../../../../widgets/Slice/SlicePlane.js\";import Ge from\"../../../../../geometry/Point.js\";const xe=t.getLogger(\"esri.views.3d.interactive.analysisTools.slice.sliceToolUtils\");function Ie(e,t,i,s,r,o,n,a){return ze(t,n.worldUpAtPosition(e,B.get()),r,o,a.basis1,a.basis2),h(a.basis1,a.basis1,i),h(a.basis2,a.basis2,s),w(a.origin,e),I(a.basis2,a.basis1,a.origin,a.plane),a}function ze(e,t,i,s,r,o){const n=y(e,t),a=B.get(),c=B.get();switch(0===s?Math.abs(n)>pe?1:2:s){case 2:{const s=Math.abs(n)<=$?e:i.viewUp;j(a,s,t),w(c,t);break}case 1:j(a,i.viewUp,t),j(c,t,a);break;case 3:{const s=Math.abs(n)<=$?t:i.viewUp;j(a,s,e),j(c,e,a);break}}const l=j(B.get(),a,c);y(l,i.viewForward)>0&&h(c,c,-1),M(r,a),M(o,c)}function De(e,t,i){const s=t.worldUpAtPosition(e.origin,B.get()),r=e.basis1,o=mt(e,s),n=Math.round(o/yt)*yt;return L(e,n-o,r,i)}function Be(e,t,i,s,r,o){const n=w(B.get(),r.origin);k(n,n,h(B.get(),r.basis1,e.direction[0]<0?1:-1)),k(n,n,h(B.get(),r.basis2,e.direction[1]<0?1:-1));const a=v(r.basis1),c=v(r.basis2),l=P(B.get(),i,n),m=P(B.get(),t,n);let d=0,g=0;if(et(e)){const t=_e(r),i=_e(o);d=a-.5*e.direction[0]*y(r.basis1,m)/a,g=c-.5*e.direction[1]*y(r.basis2,m)/c;const s=i/t;d*=s,g*=s}const u=d+.5*e.direction[0]*y(r.basis1,l)/a,p=g+.5*e.direction[1]*y(r.basis2,l)/c,f=h(B.get(),r.basis1,u/a),b=h(B.get(),r.basis2,p/c);(u<=0||Xe(o.origin,f,s)<=J)&&w(f,o.basis1),(p<=0||Xe(o.origin,b,s)<=J)&&w(b,o.basis2);const j=w(B.get(),n);return k(j,j,h(B.get(),f,e.direction[0]<0?-1:1)),k(j,j,h(B.get(),b,e.direction[1]<0?-1:1)),A(j,f,b,o)}function He(e,t){return K*Math.min(t.width,t.height)*t.computeRenderPixelSizeAt(e)}function Ve(e,t,i,s){const r=j(B.get(),t,i);return j(r,r,t),x(e,r,s)}function qe(e,t){return N(e.basis1,e.basis2,e.origin,t)}function Ne(e,t,i,s){const r=t.worldUpAtPosition(e.origin,B.get()),o=B.get();switch(i){case 1:w(o,r);break;case 2:w(o,e.basis1)}return x(e.origin,o,s)}function We(e,t,i,s){const r=Qe(i,2),o=H.get();c(o,t,r.edge*Math.PI/2);const n=M(B.get(),r.basis);let l=h(B.get(),n,r.direction*s.computeScreenPixelSizeAt(r.position)*Q);k(l,l,r.position);const m=s.projectToRenderScreen(l,a(B.get())),d=Ze(s,m);Ue(s,m,wt),M(wt.direction,wt.direction);const g=B.get();!d&&E(i,wt,g)&&(l=g),o[12]=0,o[13]=0,o[14]=0,e.modelTransform=o,e.renderLocation=U(l),d?e.state|=ht:e.state&=~ht}function Ze(e,t){const[i,s,r,o]=e.viewport,n=Math.min(r,o)/16;let a=!0;return t[0]<i+n?(t[0]=i+n,a=!1):t[0]>i+r-n&&(t[0]=i+r-n,a=!1),t[1]<s+n?(t[1]=s+n,a=!1):t[1]>s+o-n&&(t[1]=s+o-n,a=!1),a}function $e(e,t,i,s){const r=v(s.basis1),o=v(s.basis2),n=Ye(s),a=_e(s),g=T(B.get(),0,0,0);k(g,h(B.get(),s.basis1,t.direction[0]),h(B.get(),s.basis2,t.direction[1])),k(g,s.origin,g);let u=0,p=1;if(et(t))1===t.direction[0]&&-1===t.direction[1]?u=yt:1===t.direction[0]&&1===t.direction[1]?u=Math.PI:-1===t.direction[0]&&1===t.direction[1]&&(u=3*Math.PI/2),p=a;else{const e=0!==t.direction[0]?1:2;u=1===e?yt:0,p=(1===e?o:r)-n}const f=l(H.get());c(f,f,u),m(f,f,T(B.get(),p,p,p)),d(f,i,f),f[12]=0,f[13]=0,f[14]=0,e.modelTransform=f,e.renderLocation=g}function Je(e,t,i,s){const r=s.worldUpAtPosition(i.origin,B.get()),o=Qe(i,0),n=l(H.get());c(n,n,o.edge*Math.PI/2),g(n,n,-mt(i,r)),d(n,t,n),n[12]=0,n[13]=0,n[14]=0,e.modelTransform=n,e.renderLocation=o.position}function Ke(e,t,i){const s=Qe(i,1),r=l(H.get());c(r,r,s.edge*Math.PI/2),g(r,r,yt),d(r,t,r),r[12]=0,r[13]=0,r[14]=0,e.modelTransform=r,e.renderLocation=s.position}function Qe(e,t){switch(t){case 0:return{basis:e.basis1,direction:1,position:k(B.get(),e.origin,e.basis1),edge:t};case 1:return{basis:e.basis2,direction:1,position:k(B.get(),e.origin,e.basis2),edge:t};case 2:return{basis:e.basis1,direction:-1,position:P(B.get(),e.origin,e.basis1),edge:t};case 3:return{basis:e.basis2,direction:-1,position:P(B.get(),e.origin,e.basis2),edge:t}}}function Xe(e,t,i){const s=i.projectToRenderScreen(k(B.get(),e,t),a(B.get())),r=i.projectToRenderScreen(P(B.get(),e,t),a(B.get()));return O(P(s,s,r))}function Ye(e){const t=v(e.basis1),i=v(e.basis2);return Z*Math.min(t,i)}function _e(e){return Ye(e)}function et(e){return 0!==e.direction[0]&&0!==e.direction[1]}function tt(e,t=1){const i=0===t?Q:0,s=[S(i,0,-we/2),S(i,0,we/2)],r=ct(s,!0),o=(e,t)=>nt(s,s,{tubeRadius:ye,tipRadius:W,tipLength:je,tubeFocusMultiplier:Me,tipFocusMultiplier:ke,padding:e,bothEnds:!0,flat:null,focusTipLength:!0,addCap:t}),n=o(0,!1),a=o(X,!0),c=new Le({color:Y,cullFace:2,renderOccluded:16}),l=new Le({color:_,cullFace:2,renderOccluded:16}),m=new Le({color:ee,cullFace:2,renderOccluded:16}),d=new Le({color:te,transparent:!0,writeDepth:!1,cullFace:1,renderOccluded:2}),g=Se.createPolylineGeometry([[i,0,0],[i-Q,0,0]]),u=Se.createPolylineGeometry([[i,0,0],[i-Q,0,0]]),p=new Ee({color:ie,renderOccluded:4});return new q({view:e,renderObjects:[...n.normal.map((({part:e,geometry:t,transform:i})=>({geometry:t,material:\"tip\"===e?c:\"cap\"===e?l:m,transform:i,stateMask:1|bt}))),...a.normal.map((({geometry:e,transform:t})=>({geometry:e,material:d,transform:t,stateMask:1|bt}))),{geometry:g,material:p,stateMask:1|bt|ht},...n.focused.map((({part:e,geometry:t,transform:i})=>({geometry:t,material:\"tip\"===e?c:\"cap\"===e?l:m,transform:i,stateMask:2|bt}))),...a.focused.map((({geometry:e,transform:t})=>({geometry:e,material:d,transform:t,stateMask:2|bt}))),{geometry:u,material:p,stateMask:2|bt|ht}],autoScaleRenderObjects:!1,collisionType:{type:\"line\",paths:[r]},collisionPriority:1,radius:W,state:bt})}function it(e,t){const i=new Ae({transparent:!0,writeDepth:!1,textureId:t.id,renderOccluded:16}),s=se,r=re,o=r*fe,n=e=>{const t=new Uint32Array([0,1,2,2,3,0]);return new Re([[\"position\",{size:3,data:[s-e,-e,0,s+e,-e,0,s+e,e,0,s-e,e,0],exclusive:!0}],[\"uv0\",{size:2,data:[0,0,1,0,1,1,0,1]}]],[[\"position\",t],[\"uv0\",t]])},a=Se.createPolylineGeometry([[0,0,0],[s-r,0,0]]),c=Se.createPolylineGeometry([[0,0,0],[s-o,0,0]]),l=new Ee({color:oe,renderOccluded:4}),m=[{geometry:n(r),material:i,stateMask:1|bt},{geometry:a,material:l,stateMask:1|bt},{geometry:n(o),material:i,stateMask:2|bt},{geometry:c,material:l,stateMask:2|bt}];return new q({view:e,renderObjects:m,autoScaleRenderObjects:!1,collisionType:{type:\"disc\",direction:[0,0,1],offset:[s,0,0]},collisionPriority:1,radius:r/2,state:bt})}function st(e){return new Pe({view:e,attached:!0,color:ne,width:ae,writeDepthEnabled:!1,renderOccluded:4,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]]})}function rt(e){return new Oe({view:e,attached:!0,backgroundColor:[...ce],gridColor:le,gridWidth:4,renderOccluded:4})}function ot(e,t){const i=et(t),s=i?[S(1,0,0),S(0,0,0),S(0,1,0)]:[S(1,0,0),S(-1,0,0)],r=Se.createPolylineGeometry(s),o=[...me,1],n=e=>new Ce({color:o,width:e,renderOccluded:4}),a=()=>new Ee({color:o,renderOccluded:4}),c=i?ve:he,l=c*be,m=he,d=e=>e>1?n(e):a(),g=[{geometry:r,material:d(c),stateMask:1|jt},{geometry:r,material:d(l),stateMask:2|jt},{geometry:r,material:d(m),stateMask:Mt}],u=new q({view:e,renderObjects:g,collisionType:{type:\"line\",paths:[s]},autoScaleRenderObjects:!1,worldSized:!0,radius:i?de:ge,idHint:i?1:2});return u.state=jt,u}function nt(e,t,i){const s=s=>{const r=(s?t:e).slice(0),n=P(B.get(),r[0],r[1]);M(n,n);const a=P(B.get(),r[r.length-1],r[r.length-2]);if(M(a,a),i.padding>0){const e=h(R(),a,-i.padding);if(r[r.length-1]=k(e,e,r[r.length-1]),i.bothEnds){const e=h(R(),n,-i.padding);r[0]=k(e,e,r[0])}}const c=s?i.tipFocusMultiplier:1,g=i.tipLength*(i.focusTipLength?c:1),w=i.tipRadius*c,y=l(H.get());if(i.padding>0){const e=g/4,t=T(B.get(),0,e,0),s=1+i.padding/e;u(y,y,t),m(y,y,T(B.get(),s,s,s)),u(y,y,h(t,t,-1/s))}const j=l(f()),v=S(0,1,0),O=p(f(),b(V.get(),v,a));O[12]=r[r.length-1][0],O[13]=r[r.length-1][1],O[14]=r[r.length-1][2],d(O,O,y);const U=[{part:\"tube\",geometry:at(i.tubeRadius*(s?i.tubeFocusMultiplier:1)+i.padding,i.flat,r),transform:j}];let L,A;if(o(i.flat)?L=Se.createExtrudedTriangle(g,w,w,i.flat.thickness):(L=Se.createConeGeometry(g,w,24,!1,!1,!0),A=Se.createConeGeometry(g,w,24,!1,!0,!1)),U.push({part:\"tip\",geometry:L,transform:O}),A&&U.push({part:\"cap\",geometry:A,transform:O}),i.bothEnds){const e=p(f(),b(V.get(),v,n));e[12]=r[0][0],e[13]=r[0][1],e[14]=r[0][2],d(e,e,y),U.push({part:\"tip\",geometry:L,transform:e}),A&&U.push({part:\"cap\",geometry:A,transform:e})}return U};return{normal:s(!1),focused:s(!0)}}function at(e,t,i){const s=[];if(o(t))s.push([e,t.thickness/2],[-e,t.thickness/2],[-e,-t.thickness/2],[e,-t.thickness/2]);else{const t=12;for(let i=0;i<t;i++){const r=i/t*2*Math.PI;s.push([Math.cos(r)*e,Math.sin(r)*e])}}return Se.createPathExtrusionGeometry(s,i,[],[],!1)}function ct(e,t){const i=P(R(),e[e.length-1],e[e.length-2]);if(M(i,i),h(i,i,ue),k(i,i,e[e.length-1]),t){const t=P(R(),e[0],e[1]);return M(t,t),h(t,t,ue),k(t,t,e[0]),[t,...e,i]}return[...e,i]}function lt(e,t,s,n=new Fe){if(r(e))return null;const a=o(n.position)?n.position:new Ge;t.fromRenderCoords(e.origin,a,s),n.position=a;const c=t.worldUpAtPosition(e.origin,B.get()),l=t.worldBasisAtPosition(e.origin,1,B.get());return n.width=2*v(e.basis1),n.height=2*v(e.basis2),n.tilt=i(mt(e,c)),n.heading=i(dt(e,c,l)),n}function mt(e,t){return D(t,e.basis2,e.basis1)+yt}function dt(e,t,i){return D(e.basis1,i,t)-yt}function gt(e,t,i,r,o,n,a=C()){return n.toRenderCoords(e,a.origin)?(n.worldBasisAtPosition(a.origin,0,a.basis1),n.worldBasisAtPosition(a.origin,1,a.basis2),I(a.basis2,a.basis1,a.origin,a.plane),L(a,-s(t),F(a),a),L(a,s(i),a.basis1,a),h(a.basis1,a.basis1,r/2),h(a.basis2,a.basis2,o/2),G(a),a):(xe.error(`Failed to project slice plane position, projection from ${e.spatialReference.wkid} is not supported`),null)}function ut(e,t,i=C()){return r(e)||r(e.position)?null:gt(e.position,e.heading,e.tilt,e.width,e.height,t,i)}function pt(e,t,i=C()){if(r(e)||r(e.position))return null;let s=e.position;return e.position.hasZ||(s=e.position.clone(),s.z=n(Te(t.elevationProvider,e.position),0)),gt(s,e.heading,e.tilt,e.width,e.height,t.renderCoordsHelper,i)}function ft(t){switch(t.type){case\"building-scene\":case\"csv\":case\"direct-line-measurement\":case\"area-measurement\":case\"feature\":case\"geo-rss\":case\"geojson\":case\"graphics\":case\"group\":case\"integrated-mesh\":case\"kml\":case\"line-of-sight\":case\"map-notes\":case\"ogc-feature\":case\"point-cloud\":case\"route\":case\"slice\":case\"scene\":case\"stream\":case\"voxel\":case\"subtype-group\":case\"unknown\":case\"unsupported\":case\"wfs\":case null:return!1;case\"base-dynamic\":case\"base-elevation\":case\"base-tile\":case\"bing-maps\":case\"elevation\":case\"imagery\":case\"imagery-tile\":case\"map-image\":case\"open-street-map\":case\"tile\":case\"vector-tile\":case\"wcs\":case\"web-tile\":case\"wms\":case\"wmts\":return!0;default:return e(t.type),!1}}const bt=16,ht=32,wt=z(),yt=Math.PI/2,jt=16,Mt=32;export{bt as DidPointerMoveRecentlyFlag,ht as IsShiftEdgeOnScreenFlag,ct as addArrowTips,qe as calculateBoundedPlaneTranslateRotate,_e as calculateDiagonalResizeHandleScale,He as calculatePlaneHalfSize,Ye as calculateResizeHandlePadding,Xe as calculateScreenSpaceBasisLength2,nt as createArrowGeometry,rt as createGridVisualElement,st as createOutlineVisualElement,Ie as createPlane,ot as createResizeManipulator,it as createRotateManipulator,Ne as createRotatePlane,tt as createShiftManipulator,Ve as createShiftPlane,De as forceHorizontalOrVertical,ft as isAlwaysDrapedLayer,et as isDiagonalResizeHandle,ze as normalToBases,lt as planeToShape,jt as resizeNormal,Mt as resizeOutlineOnly,Be as resizePlane,pt as shapeToElevationAlignedPlane,ut as shapeToPlane,$e as updateResizeHandle,Je as updateRotateHeadingHandle,Ke as updateRotateTiltHandle,We as updateShiftRestartHandle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import i from\"../../../../../core/Accessor.js\";import t from\"../../../../../core/Handles.js\";import a from\"../../../../../core/Logger.js\";import{isNone as r,isSome as l}from\"../../../../../core/maybe.js\";import{whenOnce as s}from\"../../../../../core/watchUtils.js\";import{property as n}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{a as c}from\"../../../../../chunks/boundedPlane.js\";import h from\"../../../../../layers/Layer.js\";import d from\"../../../../../layers/buildingSublayers/BuildingComponentSublayer.js\";import{isAlwaysDrapedLayer as y,shapeToElevationAlignedPlane as u,forceHorizontalOrVertical as p,planeToShape as w}from\"../../analysisTools/slice/sliceToolUtils.js\";import v from\"../../../../../widgets/Slice/SlicePlane.js\";const V=a.getLogger(\"esri.views.3d.interactive.graphics.Slice.SliceController\");let f=class extends i{constructor(e){super(e),this._handles=new t,this._internalChange=!1,this._currentSlicePlane=null,this.state=\"pending\"}get ready(){return\"ready\"===this.state}initialize(){this._handles.add(this.layerView.layerViewData.excludedLayers.on(\"before-add\",(e=>{const i=e.item;null!=i&&(i instanceof h||i instanceof d)?i instanceof h&&y(i)?(V.error(\"excludedLayers\",`Layer '${i.title}, id:${i.id}' of type '${i.type}' can not be individually excluded from slicing. Use 'excludeGroundSurface' instead.`),e.preventDefault()):this.layerView.layerViewData.excludedLayers.includes(i)&&e.preventDefault():(V.error(\"excludedLayers\",\"Invalid layer type, layer must derive from Layer or BuildingComponentSublayer\"),e.preventDefault())}))),this._handles.add(s(this.view,\"ready\",(()=>this._initialize()),!0))}_initialize(){switch(this.state){case\"pending\":break;case\"destroyed\":return;case\"ready\":throw new Error(\"state error\")}C(this.view,this),this._handles.add([this.layerView.layerViewData.watch(\"plane\",(()=>{this._internalChange||this._updateSlicePlaneFromBoundedPlane(),this._updateLayerViews()}),!0),this.layerView.layerViewData.watch(\"excludeGroundSurface\",(()=>this._updateLayerViews()),!0),this.layerView.layerViewData.excludedLayers.on(\"change\",(()=>this._updateLayerViews())),this.layerView.watch([\"active\",\"visible\"],(()=>{this._updateActiveController(),this._updateViewSlicePlane()}),!0),this.view.allLayerViews.on(\"change\",(()=>this._updateLayerViews()))]),this._handles.add([this.analysis.watch(\"plane\",(()=>{this._internalChange||(this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane())}),!0)],\"analysis\"),this._set(\"state\",\"ready\"),this._updateActiveController(),this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane()}destroy(){switch(this.state){case\"destroyed\":case\"pending\":return}this.layerView.active=!1,P(this.view,this),this._handles.destroy(),this.view.slicePlane=null,this.set(\"view\",null),this._set(\"state\",\"destroyed\")}async whenReady(){return await s(this,\"ready\"),this}_updateBoundedPlaneFromSlicePlane(){const e=this.analysis.plane,i=this._currentSlicePlane;if(r(i)&&r(e)||l(i)&&l(e)&&e.equals(i))return;let t=null,a=null;l(e)&&(t=u(e,this.view,c()),l(t)?a={heading:e.heading,tilt:e.tilt,position:e.position,width:e.width,height:e.height}:console.warn(\"Failed slice plane conversion.\")),this._currentSlicePlane=a,l(t)&&!this.analysis.tiltEnabled&&p(t,this.view.renderCoordsHelper,t),this._internalChange=!0,this.layerView.layerViewData.plane=t,this._internalChange=!1}_updateSlicePlaneFromBoundedPlane(){const e=this.layerView.layerViewData.plane,i=w(e,this.view.renderCoordsHelper,this.view.spatialReference,new v);let t=null;l(i)&&(t={heading:i.heading,tilt:i.tilt,position:i.position,width:i.width,height:i.height}),this._currentSlicePlane=t,l(e)&&(this.analysis.tiltEnabled||p(e,this.view.renderCoordsHelper,e)),this._internalChange=!0,this.analysis.plane=i,this._internalChange=!1,this._updateViewSlicePlane()}_updateActiveController(){if(_)return;const e=S(this.view);if(this.layerView.active)l(e.activeController)&&e.activeController!==this?(_=!0,e.activeController.layerView.active=!1,_=!1):l(e.activeController)&&e.activeController,this._updateLayerViews(),e.activeController=this;else{if(l(e.activeController)&&e.activeController!==this)return;l(e.activeController)&&e.activeController===this&&(e.activeController=null,this._updateLayerViews())}}_updateViewSlicePlane(){\"ready\"===this.state&&g(this.view)}_updateLayerViews(){const e=l(this.layerView.layerViewData.plane)&&this.layerView.visible&&this.layerView.active,i=[],t=e=>{\"layers\"in e?e.layers.forEach(t):i.push(e)};this.layerView.layerViewData.excludedLayers.forEach(t),this.view.allLayerViews.forEach((t=>{\"slicePlaneEnabled\"in t&&(t.slicePlaneEnabled=e&&i.indexOf(t.layer)<0),\"sublayerViews\"in t&&t.sublayerViews.forEach((t=>{t.slicePlaneEnabled=e&&i.indexOf(t.sublayer)<0}))})),null!=this.view.basemapTerrain&&(this.view.basemapTerrain.slicePlaneEnabled=e&&!this.layerView.layerViewData.excludeGroundSurface)}};e([n({readOnly:!0})],f.prototype,\"state\",void 0),e([n()],f.prototype,\"view\",void 0),e([n()],f.prototype,\"analysis\",void 0),e([n()],f.prototype,\"layerView\",void 0),e([n()],f.prototype,\"ready\",null),f=e([o(\"esri.views.3d.interactive.graphics.Slice.SliceController\")],f);const m=new Map;let _=!1;function g(e){const i=S(e).activeController;l(i)&&l(i.layerView.layerViewData.plane)&&i.layerView.visible?e.slicePlane=i.layerView.layerViewData.plane:e.slicePlane=null}function C(e,i){m.has(e)||m.set(e,{all:[],activeController:null}),m.get(e).all.push(i)}function S(e){return m.get(e)}function P(e,i){if(!m.has(e))throw new Error(\"view expected in global slice register\");const t=m.get(e),a=t.all.lastIndexOf(i);if(-1===a)throw new Error(\"controller expected in global slice register\");t.all.splice(a,1),0===t.all.length&&m.delete(e)}export{f as SliceController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import i from\"../../../../../core/Handles.js\";import{applyOpacity as s}from\"../../../../../core/mathUtils.js\";import{isNone as a,destroyMaybe as r,isSome as l}from\"../../../../../core/maybe.js\";import{whenOnce as o}from\"../../../../../core/watchUtils.js\";import{property as n}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as h}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as c}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{w as p,m as d}from\"../../../../../chunks/mat4.js\";import{s as u,l as m}from\"../../../../../chunks/vec3.js\";import{c as y}from\"../../../../../chunks/vec4f64.js\";import{sm4d as w,sv3d as _}from\"../../../../../geometry/support/vectorStacks.js\";import{PLANE_OUTLINE_WIDTH as V,PLANE_OUTLINE_COLOR as g,PLANE_PREVIEW_OUTLINE_WIDTH as f,PLANE_BACKGROUND_COLOR as v,GRID_COLOR as j}from\"../../analysisTools/slice/sliceToolConfig.js\";import{createGridVisualElement as E,createOutlineVisualElement as b,calculateBoundedPlaneTranslateRotate as k}from\"../../analysisTools/slice/sliceToolUtils.js\";import{createStipplePatternSimple as S}from\"../../../webgl-engine/materials/lineStippleUtils.js\";let M=class extends t{constructor(e){super(e),this._handles=new i,this._gridVisualElement=null,this._outlineVisualElement=null,this.state=\"pending\"}get ready(){return\"ready\"===this.state}set showGrid(e){this._set(\"showGrid\",e),this._updateMaterials()}set editable(e){this._set(\"editable\",e),this._updateMaterials()}initialize(){this._initialize()}async _initialize(){switch(this.state){case\"pending\":break;case\"destroyed\":return;case\"ready\":throw new Error(\"state error\")}if(await o(this.view,\"ready\",!0),a(this.layerView.layerViewData))throw new Error(\"expected internal object to be valid\");this._gridVisualElement=E(this.view),this._outlineVisualElement=b(this.view),this._handles.add(c((()=>this.layerView.fullOpacity),(()=>this._updateMaterials())),\"layer\"),this._handles.add([this.layerView.watch(\"visible\",(()=>this._updateMaterials()),!0),this.layerView.layerViewData.watch(\"plane\",(()=>this._updatePlane()),!0),this.layerView.watch(\"active\",(()=>this._updateMaterials()),!0)],\"internal\"),this._updatePlane(),this._set(\"state\",\"ready\")}destroy(){switch(this.state){case\"destroyed\":case\"pending\":return}this._handles.destroy(),this._gridVisualElement=r(this._gridVisualElement),this._outlineVisualElement=r(this._outlineVisualElement),this.set(\"view\",null),this._set(\"state\",\"destroyed\")}async whenReady(){return await o(this,\"ready\"),this}_update(){switch(this.state){case\"pending\":case\"destroyed\":return}}_updatePlane(){const e=this.layerView.layerViewData.plane,t=l(e)?k(e,w.get()):null;if(this._outlineVisualElement.width=V,l(e)){const i=u(_.get(),m(e.basis1),m(e.basis2),1),s=p(w.get(),i),a=d(s,t,s);this._outlineVisualElement.transform=a,this._gridVisualElement.transform=a}this._updateMaterials()}_updateMaterials(){const e=this.layerView.layerViewData.plane&&this.layerView.visible,t=this.layerView.active,i=this.layerView.fullOpacity,a=s(D,g,i);this._outlineVisualElement.color=a,this._outlineVisualElement.width=this.editable?V:f,this._outlineVisualElement.stipplePattern=t?null:S(5);const r=s(D,v,i),o=!!l(this.layerView.layerViewData)&&this.showGrid?j:[0,0,0,0];this._gridVisualElement.backgroundColor=r,this._gridVisualElement.gridColor=o,this._gridVisualElement.visible=e,this._outlineVisualElement.visible=e}};e([n({readOnly:!0})],M.prototype,\"state\",void 0),e([n()],M.prototype,\"view\",void 0),e([n()],M.prototype,\"layer\",void 0),e([n()],M.prototype,\"layerView\",void 0),e([n()],M.prototype,\"ready\",null),e([n({value:!1})],M.prototype,\"showGrid\",null),e([n({value:!0})],M.prototype,\"editable\",null),M=e([h(\"esri.views.3d.interactive.graphics.Slice.SliceView\")],M);const D=y();export{M as SliceView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import r from\"../../../../../core/Accessor.js\";import o from\"../../../../../core/Collection.js\";import{castForReferenceSetter as s,referenceSetter as t}from\"../../../../../core/collectionUtils.js\";import{property as c}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as p}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let i=class extends r{constructor(){super(...arguments),this.plane=null,this.excludeGroundSurface=!1}get excludedLayers(){return this._get(\"excludedLayers\")||new o}set excludedLayers(e){this._set(\"excludedLayers\",t(e,this._get(\"excludedLayers\")))}};e([c()],i.prototype,\"plane\",void 0),e([c()],i.prototype,\"excludeGroundSurface\",void 0),e([c({cast:s})],i.prototype,\"excludedLayers\",null),i=e([p(\"esri.views.3d.interactive.graphics.Slice.SliceInternal\")],i);export{i as SliceLayerViewData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as i}from\"../../../chunks/tslib.es6.js\";import{createDeferred as e}from\"../../../core/promiseUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as t}from\"../../../core/accessorSupport/decorators/subclass.js\";import{SliceController as r}from\"../interactive/graphics/Slice/SliceController.js\";import{SliceView as a}from\"../interactive/graphics/Slice/SliceView.js\";import{LayerView3D as o}from\"./LayerView3D.js\";import{SliceLayerViewData as l}from\"./analysis/Slice/SliceLayerViewData.js\";import n from\"../../layers/LayerView.js\";let y=class extends(o(n)){constructor(){super(...arguments),this.type=\"slice-3d\",this.analysisView=null,this.analysisController=null,this._initialized=e(),this.layerViewData=new l,this.active=!0,this.showGrid=!1,this.editable=!1}initialize(){this.analysisView=new a({view:this.view,layer:this.layer,layerView:this}),this.analysisController=new r({view:this.view,analysis:this.layer,layerView:this}),this._initialized.resolve()}destroy(){this.analysisView.destroy(),this.analysisView=null,this.analysisController.destroy(),this.analysisController=null}async when(){return this.destroyed?null:(await this._initialized.promise,this.destroyed?null:(await this.analysisView.whenReady(),this.destroyed?null:(await this.analysisController.whenReady(),this)))}get testData(){return{view:this.analysisView,controller:this.analysisController}}};i([s()],y.prototype,\"type\",void 0),i([s()],y.prototype,\"layerViewData\",void 0),i([s()],y.prototype,\"layer\",void 0),i([s()],y.prototype,\"active\",void 0),i([s({aliasOf:\"analysisView.showGrid\"})],y.prototype,\"showGrid\",void 0),i([s({aliasOf:\"analysisView.editable\"})],y.prototype,\"editable\",void 0),y=i([t(\"esri.views.3d.layers.SliceLayerView3D\")],y);var p=y;export{y as SliceLayerView3D,p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nfunction i(i){return i&&\"getAtOrigin\"in i&&\"originOf\"in i}export{i as isMultiOriginJSONMixin};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{getPathExtension as i}from\"../../core/urlUtils.js\";function p(i){return o[n(i)]||e}function n(i){return i instanceof Blob?i.type:t(i.url)}function t(p){const n=i(p);return g[n]||a}const o={},a=\"text/plain\",e=o[a],g={png:\"image/png\",jpeg:\"image/jpeg\",jpg:\"image/jpg\",bmp:\"image/bmp\",gif:\"image/gif\",json:\"application/json\",txt:\"text/plain\",xml:\"application/xml\",svg:\"image/svg+xml\",zip:\"application/zip\",pbf:\"application/vnd.mapbox-vector-tile\",gz:\"application/gzip\"};for(const l in g)o[g[l]]=l;export{p as getResourceContentExtension};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as t,isNone as r,get as e}from\"../../maybe.js\";import{isMultiOriginJSONMixin as o}from\"../../multiOriginJSONSupportUtils.js\";import{isAbsolute as i,isBlobProtocol as n,join as s,getPathExtension as u}from\"../../urlUtils.js\";import{generateUUID as p}from\"../../uuid.js\";import{getOwnPropertyMetadata as a}from\"../metadata.js\";import{nameToId as c}from\"../PropertyOrigin.js\";import{propertyJSONMeta as l}from\"./property.js\";import{getResourceContentExtension as f}from\"../../../portal/support/resourceExtension.js\";import{r as m,t as y,i as h,p as d}from\"../../../chunks/persistableUrlUtils.js\";function g(r){const e=t(r)&&r.origins?r.origins:[void 0];return(t,o)=>{const i=w(r,t,o);for(const r of e){const e=l(t,r,o);for(const t in i)e[t]=i[t]}}}function w(r,e,o){if(t(r)&&\"resource\"===r.type)return v(r,e,o);switch(t(r)&&r.type?r.type:\"other\"){case\"other\":return{read:!0,write:!0};case\"url\":{const{read:t,write:r}=d;return{read:t,write:r}}}}function v(e,s,u){const p=a(s,u);return{type:String,read:(t,r,e)=>{const o=m(t,r,e);return p.type===String?o:\"function\"==typeof p.type?new p.type({url:o}):void 0},write:{writer(s,a,l,f){if(!f||!f.resources)return\"string\"==typeof s?void(a[l]=y(s,f)):void(a[l]=s.write({},f));const m=P(s),d=m?y(m,{...f,verifyItemRelativeUrls:f&&f.verifyItemRelativeUrls?{writtenUrls:f.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null},1):null,g=p.type!==String&&(!o(this)||f&&f.origin&&this.originIdOf(u)>c(f.origin));f&&f.portalItem&&t(d)&&!i(d)?g?j(this,u,s,d,a,l,f,e):I(d,a,l,f):f&&f.portalItem&&(r(d)||t(h(d))||n(d)||g)?U(this,u,s,d,a,l,f,e):a[l]=d}}}}function U(t,r,o,i,u,a,c,l){const m=p(),y=S(o,i,c),h=s(e(l,\"prefix\"),m),d=`${h}.${f(y)}`,g=c.portalItem.resourceFromPath(d);n(i)&&c.resources.pendingOperations.push(b(i).then((t=>{g.path=`${h}.${f(t)}`,u[a]=g.itemRelativeUrl})).catch((()=>{}))),O(t,r,g,y,c.resources.toAdd),u[a]=g.itemRelativeUrl}function j(t,r,e,o,i,n,s,p){const a=s.portalItem.resourceFromPath(o),c=S(e,o,s);f(c)===u(a.path)?(O(t,r,a,c,s.resources.toUpdate),i[n]=o):U(t,r,e,o,i,n,s,p)}function I(t,r,e,o){o.resources.toKeep.push({resource:o.portalItem.resourceFromPath(t)}),r[e]=t}function O(t,r,e,o,i){i.push({resource:e,content:o,finish:e=>{R(t,r,e)}})}function S(t,r,e){return\"string\"==typeof t?{url:r}:new Blob([JSON.stringify(t.toJSON(e))],{type:\"application/json\"})}async function b(t){const r=(await import(\"../../../request.js\")).default,{data:e}=await r(t,{responseType:\"blob\"});return e}function P(t){return r(t)?null:\"string\"==typeof t?t:t.url}function R(t,r,e){\"string\"==typeof t[r]?t[r]=e.url:t[r].url=e.url}export{g as persistable};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as s}from\"../../../../core/maybe.js\";import{e as r}from\"../../../../chunks/mat4.js\";import{c as t}from\"../../../../chunks/mat4f64.js\";import{VisualElement as o}from\"./VisualElement.js\";import{Object3D as i}from\"../../webgl-engine/lib/Object3D.js\";import{WebGLLayer as a}from\"../../webgl-engine/lib/WebGLLayer.js\";class c extends o{constructor(e){super(e.view),this._resources=null,this._transform=t()}get object(){return e(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){r(this._transform,s),e(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(s(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new a({isPickable:!1,updatePolicy:1});e.add(s);const r=new i({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;!s(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){s(this._resources)||this._resources.object.setVisible(e)}}export{c as Object3DVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nclass t{constructor(t){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch(\"ready\",(t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())}))}applyProps(t){let e=!1;for(const s in t)s in this?\"attached\"===s?e=t[s]:this[s]=t[s]:console.error(\"Cannot set unknown property\",s);this.attached=e}destroy(){this.attached=!1}get attached(){return this._attached}set attached(t){t!==this._attached&&this.view._stage&&(this._attached=t,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.attached&&this.updateVisibility(t))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}export{t as VisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../core/maybe.js\";import{i as r,t as s}from\"../../../../chunks/mat4.js\";import{c as i}from\"../../../../chunks/mat4f64.js\";import{s as o}from\"../../../../chunks/vec3.js\";import{Z as n,c as h}from\"../../../../chunks/vec3f64.js\";import{g as l,c as a}from\"../../../../chunks/vec4.js\";import{f as p,c as d,a as f}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as _}from\"./Object3DVisualElement.js\";import{createGeometry as c}from\"../../layers/graphics/lineUtils.js\";import{RibbonLineMaterial as u}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";class m extends _{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=p(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stippleIntegerRepeats=!1,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromRenderSpacePoint(e){const t=1e3,r=[];r.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),r.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),r.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=r}setGeometryFromExtent(e){const t=this.view.spatialReference,r=h(),s=h(),i=100,n=[];o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),this.geometry=[n]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],r=e.origin,s=e.basis1,i=e.basis2,o=.5,n=h(),l=h(),a=h(),p=h();n[0]=r[0]-s[0]*o-i[0]*o,n[1]=r[1]-s[1]*o-i[1]*o,n[2]=r[2]-s[2]*o-i[2]*o,l[0]=r[0]-s[0]*o+i[0]*o,l[1]=r[1]-s[1]*o+i[1]*o,l[2]=r[2]-s[2]*o+i[2]*o,a[0]=r[0]+s[0]*o+i[0]*o,a[1]=r[1]+s[1]*o+i[1]*o,a[2]=r[2]+s[2]*o+i[2]*o,p[0]=r[0]+s[0]*o-i[0]*o,p[1]=r[1]+s[1]*o-i[1]*o,p[2]=r[2]+s[2]*o-i[2]*o,t.push([n[0],n[1],n[2]]),t.push([l[0],l[1],l[2]]),t.push([a[0],a[1],a[2]]),t.push([p[0],p[1],p[2]]),t.push([n[0],n[1],n[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;r(g),s(g,g,t),this.transform=g;const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=n){r(g),s(g,g,t),this.transform=g,this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){l(e,this._color)||(a(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(r){e(r)?!t(this._innerColor)&&l(r,this._innerColor)||(this._innerColor=a(d(),r),this._updateMaterial()):e(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const r=e(t)!==e(this._stipplePattern);this._stipplePattern=t,r?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(r){(t(r)||t(this._stippleOffColor)||!l(r,this._stippleOffColor))&&(this._stippleOffColor=e(r)?f(r):null,this._updateMaterial())}get stippleIntegerRepeats(){return this._stippleIntegerRepeats}set stippleIntegerRepeats(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new u(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){const t=this._createLineGeometries();if(0!==t.length)for(let r=0;r<t.length;++r){const s=c(t[r]);e.addGeometry(s,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameterValues(this.materialParameters)}_createLineGeometries(){const e=this.geometry;if(t(e)||0===e.length)return[];const r=[];return e.forEach((e=>{const t=e.length,s=new Float64Array(3*t);e.forEach(((e,t)=>{s[3*t+0]=e[0],s[3*t+1]=e[1],s[3*t+2]=e[2]}));const i={attributeData:{position:s},removeDuplicateStartEnd:0};r.push(i)})),r}}const g=i();export{m as LineVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{Slice as e}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as a}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as o}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{defaultMaskAlphaCutoff as i}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as t}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as l}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function s(s){const n=new l;return n.include(r,{linearDepth:!1}),n.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),n.attributes.add(\"position\",\"vec3\"),n.attributes.add(\"uv0\",\"vec2\"),n.varyings.add(\"vpos\",\"vec3\"),s.multipassTerrainEnabled&&n.varyings.add(\"depth\",\"float\"),n.vertex.uniforms.add(\"textureCoordinateScaleFactor\",\"vec2\"),n.vertex.code.add(t`\n    void main(void) {\n      vpos = position;\n      ${s.multipassTerrainEnabled?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  `),n.include(e,s),s.multipassTerrainEnabled&&(n.fragment.include(a),n.include(o,s)),n.fragment.uniforms.add(\"tex\",\"sampler2D\"),n.fragment.uniforms.add(\"opacity\",\"float\"),n.varyings.add(\"vTexCoord\",\"vec2\"),7===s.output?n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    `):(n.fragment.include(d),n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ${s.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n    }\n    `)),n}var n=Object.freeze({__proto__:null,build:s});export{n as I,s as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import o from\"../../core/Error.js\";import{isSome as r}from\"../../core/maybe.js\";async function n(n,t,s,a,i,d){let l=null;if(r(s)){const o=`${n}/nodepages/`,t=o+Math.floor(s.rootIndex/s.nodesPerPage);try{return{type:\"page\",rootPage:(await e(t,{query:{f:\"json\",token:a},responseType:\"json\",signal:d})).data,rootIndex:s.rootIndex,pageSize:s.nodesPerPage,lodMetric:s.lodSelectionMetricType,urlPrefix:o}}catch(f){r(i)&&i.warn(\"#fetchIndexInfo()\",\"Failed to load root node page. Falling back to node documents.\",t,f),l=f}}if(!t)return null;const p=`${n}/nodes/`,c=p+(t&&t.split(\"/\").pop());try{return{type:\"node\",rootNode:(await e(c,{query:{f:\"json\",token:a},responseType:\"json\",signal:d})).data,urlPrefix:p}}catch(f){throw new o(\"sceneservice:root-node-missing\",\"Root node missing.\",{pageError:l,nodeError:f,url:c})}}export{n as fetchIndexInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../shaderModules/interfaces.js\";function i(i){i.vertex.uniforms.add(\"camPos\",\"vec3\").add(\"perScreenPixelRatio\",\"float\").add(\"screenSize\",\"float\"),i.vertex.code.add(e`float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - camPos));\nreturn viewDirectionDistance*perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;\n}`)}function r(e,i,r){e.setUniform1f(\"perScreenPixelRatio\",r.camera.perScreenPixelRatio),e.setUniform1f(\"screenSize\",i.screenSize)}export{i as ScreenSizeScaling,r as bindScreenSizeScalingUniforms};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{ScreenSizeScaling as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js\";import{Slice as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as o}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as i}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as a}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{symbolAlphaCutoff as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as n}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as s}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function t(t){const c=new s;return c.include(o,{linearDepth:!1}),c.include(e,{}),c.include(r,t),c.fragment.include(l),c.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),c.fragment.uniforms.add(\"color\",\"vec4\"),c.attributes.add(\"position\",\"vec3\"),c.varyings.add(\"vWorldPosition\",\"vec3\"),t.multipassTerrainEnabled&&c.varyings.add(\"depth\",\"float\"),t.screenSizeEnabled&&c.attributes.add(\"offset\",\"vec3\"),t.shadingEnabled&&(c.vertex.uniforms.add(\"viewNormal\",\"mat4\"),c.fragment.uniforms.add(\"shadedColor\",\"vec4\").add(\"shadingDirection\",\"vec3\"),c.attributes.add(\"normal\",\"vec3\"),c.varyings.add(\"vViewNormal\",\"vec3\")),c.vertex.code.add(n`\n    void main(void) {\n      vWorldPosition = ${t.screenSizeEnabled?\"screenSizeScaling(offset, position)\":\"position\"};\n  `),t.shadingEnabled&&c.vertex.code.add(n`vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),c.vertex.code.add(n`\n    ${t.multipassTerrainEnabled?\"depth = (view * vec4(vWorldPosition, 1.0)).z;\":\"\"}\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  `),t.multipassTerrainEnabled&&(c.fragment.include(i),c.include(a,t)),c.fragment.code.add(n`\n    void main() {\n      discardBySlice(vWorldPosition);\n      ${t.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n    `),t.shadingEnabled?c.fragment.code.add(n`vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(color, shadedColor, shadingFactor);`):c.fragment.code.add(n`vec4 finalColor = color;`),c.fragment.code.add(n`\n      if (finalColor.a < ${n.float(d)}) {\n        discard;\n      }\n      ${7===t.output?n`gl_FragColor = vec4(finalColor.a);`:\"\"}\n\n      ${0===t.output?n`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${t.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}`:\"\"}\n    }\n    `),c}var c=Object.freeze({__proto__:null,build:t});export{c as S,t as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{glsl as d}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as e}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function r(){const r=new e;return r.extensions.add(\"GL_OES_standard_derivatives\"),r.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),r.attributes.add(\"position\",\"vec3\"),r.attributes.add(\"uv0\",\"vec2\"),r.varyings.add(\"vUV\",\"vec2\"),r.vertex.code.add(d`void main(void) {\nvUV = uv0;\ngl_Position = proj * view * vec4(position, 1.0);\n}`),r.fragment.uniforms.add(\"backgroundColor\",\"vec4\").add(\"gridColor\",\"vec4\").add(\"ratio\",\"float\").add(\"gridWidth\",\"float\"),r.fragment.code.add(d`void main() {\nconst float LINE_WIDTH = 1.0;\nvec2 uvScaled = vUV * gridWidth;\nvec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));\nvec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);\ngrid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);\ngrid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);\nfloat gridFade = max(grid.x, grid.y);\nfloat gridAlpha = gridColor.a * gridFade;\ngl_FragColor =\nvec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +\nvec4(gridColor.rgb, 1.0) * gridAlpha;\n}`),r}var a=Object.freeze({__proto__:null,build:r});export{a as S,r as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as r}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as i,bindView as s}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as a}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as n,ShaderTechniqueConfiguration as l}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as p}from\"../lib/DefaultVertexAttributeLocations.js\";import{OITBlending as c,OITDepthTest as u,OITDepthWrite as d,getOITPolygonOffset as h}from\"../lib/OrderIndependentTransparency.js\";import{Program as m}from\"../lib/Program.js\";import{stencilWriteMaskOn as b,stencilToolMaskBaseParams as f,stencilBaseAllZerosParams as g}from\"../lib/StencilUtils.js\";import{I as y}from\"../../../../chunks/ImageMaterial.glsl.js\";import{simpleBlendingParams as T,makePipelineState as P,cullingParams as v,defaultDepthWriteParams as j,defaultColorWriteParams as S}from\"../../../webgl/renderState.js\";class E extends o{initializeProgram(e){const t=E.shader.get(),r=this.configuration,i=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new m(e.rctx,i,p)}bindPass(e,t){i(this.program,t.camera.projectionMatrix),this.program.setUniform1f(\"opacity\",e.opacity),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),r(this.program,t))}bindDraw(e){s(this.program,e),t(this.program,this.configuration,e),this.program.rebindTextures()}setPipelineState(e,t){const r=this.configuration,i=3===e,s=2===e;return P({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?w:c(e),culling:v(r.cullFace),depthTest:{func:u(e)},depthWrite:i?r.writeDepth&&j:d(e),colorWrite:S,stencilWrite:r.sceneHasOcludees?b:null,stencilTest:r.sceneHasOcludees?t?f:g:null,polygonOffset:i||s?null:h(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}E.shader=new a(y,(()=>import(\"./ImageMaterial.glsl.js\")));const w=T(1,771);class O extends l{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([n({count:8})],O.prototype,\"output\",void 0),e([n({count:3})],O.prototype,\"cullFace\",void 0),e([n()],O.prototype,\"slicePlaneEnabled\",void 0),e([n()],O.prototype,\"transparent\",void 0),e([n()],O.prototype,\"enableOffset\",void 0),e([n()],O.prototype,\"writeDepth\",void 0),e([n()],O.prototype,\"sceneHasOcludees\",void 0),e([n({count:4})],O.prototype,\"transparencyPassType\",void 0),e([n()],O.prototype,\"multipassTerrainEnabled\",void 0),e([n()],O.prototype,\"cullAboveGround\",void 0);export{E as ImageMaterialTechnique,O as ImageMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../lib/GLMaterialTexture.js\";import{Material as t,materialParametersDefaults as i}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as s}from\"../lib/OrderIndependentTransparency.js\";import{DefaultBufferWriter as a,PositionUVLayout as r}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as n}from\"./internal/MaterialUtil.js\";import{ImageMaterialTechniqueConfiguration as u,ImageMaterialTechnique as h}from\"../shaders/ImageMaterialTechnique.js\";class c extends t{constructor(e){super(e,p),this.supportsEdges=!0,this.techniqueConfig=new u}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<s,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}intersect(e,t,i,s,a,r,u){n(e,t,s,a,r,void 0,u)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new l(e):void 0}createBufferWriter(){return new a(r)}}class l extends e{constructor(e){super({...e,...e.material.params}),this.updateParameters()}updateParameters(e){const t=this._material.params;this.updateTexture(t.textureId),this._technique=this._techniqueRep.releaseAndAcquire(h,this._material.getTechniqueConfig(this._output,e),this._technique)}beginSlot(e){if(23===e)return!0;if(4===this._output)return 3===e;return e===(this._technique.configuration.transparent?this._technique.configuration.writeDepth?5:8:3)}_updateOccludeeState(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&(this._material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}ensureParameters(e){0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e){this.bindTextures(this._technique.program),this.bindTextureScale(this._technique.program),this._technique.bindPass(this._material.params,e)}getPipelineState(e,t){return this._technique.getPipelineState(t)}}const p={transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0,...i};export{c as ImageMaterial};\n"],"sourceRoot":""}