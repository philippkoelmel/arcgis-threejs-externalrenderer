{"version":3,"sources":["../node_modules/@arcgis/core/layers/ElevationLayer.js","../node_modules/@arcgis/core/layers/support/TilemapCache.js","../node_modules/@arcgis/core/layers/support/Tilemap.js","../node_modules/@arcgis/core/layers/support/serviceTileInfoProperty.js","../node_modules/@arcgis/core/layers/mixins/ArcGISCachedService.js"],"names":["T","o","getLogger","x","e","copyright","heightModelInfo","path","opacity","operationalLayerType","sourceJSON","type","url","version","_lercDecoder","w","r","this","i","constructed","warn","declaredClass","t","currentVersion","s","signal","addResolvingPromise","loadFromPortal","supportedTypes","supportsData","validateItem","typeKeywords","length","toLowerCase","expectedType","catch","l","then","_fetchImageService","Promise","resolve","a","n","responseType","p","noDataValue","returnFileInfo","load","_fetchTileAvailability","getTileUrl","decode","data","values","pixelData","width","height","maxZError","fileInfo","minValue","maxValue","tilemapCache","supportsBlankTile","c","parsedUrl","query","blankTile","ElevationQuery","createSampler","fetchAvailability","f","ssl","replace","read","origin","fetchTile","__isDefault__","v","g","S","y","h","json","source","prototype","readOnly","u","String","origins","write","service","value","j","m","d","_","location","left","top","_allAvailability","byteSize","_tileAvailabilityBitSet","Math","ceil","Uint8Array","request","row","col","level","tileServers","details","httpStatus","valid","response","definition","fromJSON","validateJSON","Object","freeze","_updateFromData","Array","isArray","_handles","_pendingTilemapRequests","_availableLevels","levels","cacheByteSize","_prefetchingEnabled","_tilemapCache","add","watch","_initializeTilemapDefinition","_initializeAvailableLevels","destroy","error","reject","_tmpTilemapDefinition","_tilemapFromCache","b","fromDefinition","put","getAvailability","layer","tileInfo","updateTileInfo","upsampleTile","fetchTilemap","fetchAvailabilityUpsample","_fetchAvailabilityUpsamplePrefetch","id","has","abort","remove","_prefetches","push","removeUnordered","_maxPrefetch","clear","size","get","forEach","prefetchingEnabled","hasTilemap","initialSize","constructOnly","Number","reader","minScale","maxScale","minLOD","maxLOD","ignoreMinMaxLOD","lods","filter","round","scale","arguments","spatialReference","capabilities","indexOf"],"mappings":"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","file":"static/js/31.3087bebe.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import r from\"../request.js\";import t from\"../core/Error.js\";import o from\"../core/Logger.js\";import{releaseMaybe as i,isSome as s}from\"../core/maybe.js\";import{MultiOriginJSONMixin as a}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as l,createAbortController as n,throwIfAborted as p}from\"../core/promiseUtils.js\";import{objectToQuery as c}from\"../core/urlUtils.js\";import{property as h}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import{reader as m}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as d}from\"../core/accessorSupport/decorators/subclass.js\";import u from\"../geometry/HeightModelInfo.js\";import y from\"./Layer.js\";import{ArcGISCachedService as v}from\"./mixins/ArcGISCachedService.js\";import{ArcGISService as f}from\"./mixins/ArcGISService.js\";import{OperationalLayer as g}from\"./mixins/OperationalLayer.js\";import{PortalLayer as S}from\"./mixins/PortalLayer.js\";import{url as j}from\"./support/commonProperties.js\";import{acquireDecoder as w}from\"./support/LercDecoder.js\";const T=o.getLogger(\"esri.layers.ElevationLayer\");let x=class extends(v(f(g(S(a(y)))))){constructor(...e){super(...e),this.copyright=null,this.heightModelInfo=null,this.path=null,this.opacity=1,this.operationalLayerType=\"ArcGISTiledElevationServiceLayer\",this.sourceJSON=null,this.type=\"elevation\",this.url=null,this.version=null,this._lercDecoder=w()}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}destroy(){this._lercDecoder=i(this._lercDecoder)}set minScale(e){this.constructed&&T.warn(`${this.declaredClass}.minScale support has been removed (since 4.5)`)}get minScale(){}set maxScale(e){this.constructed&&T.warn(`${this.declaredClass}.maxScale support has been removed (since 4.5)`)}get maxScale(){}readVersion(e,r){let t=r.currentVersion;return t||(t=9.3),t}load(e){const r=s(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Image Service\"],supportsData:!1,validateItem:e=>{for(let r=0;r<e.typeKeywords.length;r++)if(\"elevation 3d layer\"===e.typeKeywords[r].toLowerCase())return!0;throw new t(\"portal:invalid-layer-item-type\",\"Invalid layer item type '${type}', expected '${expectedType}' \",{type:\"Image Service\",expectedType:\"Image Service Elevation 3D Layer\"})}},e).catch(l).then((()=>this._fetchImageService(r)))),Promise.resolve(this)}fetchTile(e,t,o,i){const a=s((i=i||{signal:null}).signal)?i.signal:i.signal=n().signal,l={responseType:\"array-buffer\",signal:a},p={noDataValue:i.noDataValue,returnFileInfo:!0};return this.load().then((()=>this._fetchTileAvailability(e,t,o,i))).then((()=>r(this.getTileUrl(e,t,o),l))).then((e=>this._lercDecoder.decode(e.data,p,a))).then((e=>({values:e.pixelData,width:e.width,height:e.height,maxZError:e.fileInfo.maxZError,noDataValue:e.noDataValue,minValue:e.minValue,maxValue:e.maxValue})))}getTileUrl(e,r,t){const o=!this.tilemapCache&&this.supportsBlankTile,i=c({...this.parsedUrl.query,blankTile:!o&&null});return`${this.parsedUrl.path}/tile/${e}/${r}/${t}${i?\"?\"+i:\"\"}`}async queryElevation(e,r){const{ElevationQuery:t}=await import(\"./support/ElevationQuery.js\");p(r);return(new t).query(this,e,r)}async createElevationSampler(e,r){const{ElevationQuery:t}=await import(\"./support/ElevationQuery.js\");p(r);return(new t).createSampler(this,e,r)}_fetchTileAvailability(e,r,t,o){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,r,t,o):Promise.resolve(\"unknown\")}async _fetchImageService(e){if(this.sourceJSON)return this.sourceJSON;const t={query:{f:\"json\",...this.parsedUrl.query},responseType:\"json\",signal:e},o=await r(this.parsedUrl.path,t);o.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=o.data,this.read(o.data,{origin:\"service\",url:this.parsedUrl})}get hasOverriddenFetchTile(){return!this.fetchTile.__isDefault__}};e([h({json:{read:{source:\"copyrightText\"}}})],x.prototype,\"copyright\",void 0),e([h({readOnly:!0,type:u})],x.prototype,\"heightModelInfo\",void 0),e([h({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0}},read:!1}})],x.prototype,\"path\",void 0),e([h({type:[\"show\",\"hide\"]})],x.prototype,\"listMode\",void 0),e([h({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},\"portal-item\":{read:!1,write:!1},\"web-document\":{read:!1,write:!1}}}})],x.prototype,\"minScale\",null),e([h({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},\"portal-item\":{read:!1,write:!1},\"web-document\":{read:!1,write:!1}}}})],x.prototype,\"maxScale\",null),e([h({json:{read:!1,write:!1,origins:{\"web-document\":{read:!1,write:!1}}}})],x.prototype,\"opacity\",void 0),e([h({type:[\"ArcGISTiledElevationServiceLayer\"]})],x.prototype,\"operationalLayerType\",void 0),e([h()],x.prototype,\"sourceJSON\",void 0),e([h({json:{read:!1},value:\"elevation\",readOnly:!0})],x.prototype,\"type\",void 0),e([h(j)],x.prototype,\"url\",void 0),e([h()],x.prototype,\"version\",void 0),e([m(\"version\",[\"currentVersion\"])],x.prototype,\"readVersion\",null),x=e([d(\"esri.layers.ElevationLayer\")],x),x.prototype.fetchTile.__isDefault__=!0;var _=x;export{_ as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../request.js\";import i from\"../../core/Accessor.js\";import l from\"../../core/Error.js\";import r from\"../../core/Handles.js\";import s from\"../../core/Logger.js\";import a from\"../../core/LRUCache.js\";import o from\"../../core/PooledArray.js\";import{onAbort as n,createAbortError as c,isAbortError as h,createAbortController as p,isAborted as m}from\"../../core/promiseUtils.js\";import{waitTicks as u}from\"../../core/scheduling.js\";import{objectToQuery as f}from\"../../core/urlUtils.js\";import{init as v}from\"../../core/watchUtils.js\";import{property as y}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import{cast as _}from\"../../core/accessorSupport/decorators/cast.js\";import{subclass as d}from\"../../core/accessorSupport/decorators/subclass.js\";import{tilemapDefinitionId as b,Tilemap as g}from\"./Tilemap.js\";var w;const T=s.getLogger(\"esri.layers.support.TilemapCache\");let j=w=class extends i{constructor(e){super(e),this._handles=new r,this._pendingTilemapRequests={},this._availableLevels={},this.levels=5,this.cacheByteSize=2097152,this.request=t,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new a(this.cacheByteSize),this._handles.add([this.watch([\"layer.parsedUrl\",\"layer.tileServers?\"],(()=>this._initializeTilemapDefinition())),v(this,\"layer.tileInfo.lods\",(e=>this._initializeAvailableLevels(e)),!0)]),this._initializeTilemapDefinition()}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}castLevels(e){return e<=2?(T.error(\"Minimum levels for Tilemap is 3, but got \",e),3):e}get size(){return 1<<this.levels}fetchTilemap(e,t,i,r){if(!this._availableLevels[e])return Promise.reject(new l(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`));const s=this._tmpTilemapDefinition,a=this._tilemapFromCache(e,t,i,s);if(a)return Promise.resolve(a);const o=r&&r.signal;return r={...r,signal:null},new Promise(((e,t)=>{n(o,(()=>t(c())));const i=b(s);let l=this._pendingTilemapRequests[i];if(!l){l=g.fromDefinition(s,r).then((e=>(this._tilemapCache.put(i,e,e.byteSize),e)));const e=()=>delete this._pendingTilemapRequests[i];this._pendingTilemapRequests[i]=l,l.then(e,e)}l.then(e,t)}))}getAvailability(e,t,i){if(!this._availableLevels[e])return\"unavailable\";const l=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return l?l.getAvailability(t,i):\"unknown\"}getAvailabilityUpsample(e,t,i,l){l.level=e,l.row=t,l.col=i;const r=this.layer.tileInfo;for(r.updateTileInfo(l);;){const e=this.getAvailability(l.level,l.row,l.col);if(\"unavailable\"!==e)return e;if(!r.upsampleTile(l))return\"unavailable\"}}fetchAvailability(e,t,i,r){return this._availableLevels[e]?this.fetchTilemap(e,t,i,r).catch((e=>e)).then((r=>{if(r instanceof g){const s=r.getAvailability(t,i);return\"unavailable\"===s?Promise.reject(new l(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:e,row:t,col:i})):s}if(h(r))throw r;return\"unknown\"})):Promise.reject(new l(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`))}fetchAvailabilityUpsample(e,t,i,l,r){l.level=e,l.row=t,l.col=i;const s=this.layer.tileInfo;s.updateTileInfo(l);const a=this.fetchAvailability(e,t,i,r).catch((e=>{if(h(e))throw e;if(s.upsampleTile(l))return this.fetchAvailabilityUpsample(l.level,l.row,l.col,l);throw e}));return this._fetchAvailabilityUpsamplePrefetch(l.id,e,t,i,r,a),a}async _fetchAvailabilityUpsamplePrefetch(e,t,i,l,r,s){if(!this._prefetchingEnabled)return;const a=`prefetch-${e}`;if(this._handles.has(a))return;const o=p();s.then((()=>o.abort()),(()=>o.abort()));let n=!1;const c={remove(){n||(n=!0,o.abort())}};if(this._handles.add(c,a),await u(10,o.signal).catch((()=>{})),n||(n=!0,this._handles.remove(a)),m(o))return;const h={id:e,level:t,row:i,col:l},f={...r,signal:o.signal},v=this.layer.tileInfo;for(let p=0;w._prefetches.length<w._maxPrefetch&&v.upsampleTile(h);++p){const e=this.fetchAvailability(h.level,h.row,h.col,f);w._prefetches.push(e);const t=()=>{w._prefetches.removeUnordered(e)};e.then(t,t)}}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const e=this.layer.parsedUrl,t=e.query;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?f(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,l){l.level=e,l.row=t-t%this.size,l.col=i-i%this.size;const r=b(l);return this._tilemapCache.get(r)}_initializeAvailableLevels(e){this._availableLevels={},e&&e.forEach((e=>this._availableLevels[e.level]=!0))}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,i,l)=>!!e._tilemapFromCache(t,i,l,e._tmpTilemapDefinition)}}};j._maxPrefetch=4,j._prefetches=new o({initialSize:w._maxPrefetch}),e([y({constructOnly:!0,type:Number})],j.prototype,\"levels\",void 0),e([_(\"levels\")],j.prototype,\"castLevels\",null),e([y({readOnly:!0,type:Number})],j.prototype,\"size\",null),e([y({constructOnly:!0,type:Number})],j.prototype,\"cacheByteSize\",void 0),e([y({constructOnly:!0})],j.prototype,\"layer\",void 0),e([y({constructOnly:!0})],j.prototype,\"request\",void 0),j=w=e([d(\"esri.layers.support.TilemapCache\")],j);export{j as TilemapCache};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport t from\"../../request.js\";import{constant as i}from\"../../core/arrayUtils.js\";import e from\"../../core/Error.js\";import{clone as a}from\"../../core/lang.js\";class l{constructor(){this.location={left:0,top:0,width:0,height:0},this._allAvailability=\"unknown\",this.byteSize=40}getAvailability(t,i){if(\"unknown\"!==this._allAvailability)return this._allAvailability;const e=(t-this.location.top)*this.location.width+(i-this.location.left),a=e%8,l=e>>3,o=this._tileAvailabilityBitSet;return l<0||l>o.length?\"unknown\":o[l]&1<<a?\"available\":\"unavailable\"}_updateFromData(t){const i=this.location.width,e=this.location.height;let a=!0,l=!0;const o=Math.ceil(i*e/8),n=new Uint8Array(o);let r=0;for(let s=0;s<t.length;s++){const i=s%8;t[s]?(l=!1,n[r]|=1<<i):a=!1,7===i&&++r}l?this._allAvailability=\"unavailable\":a?this._allAvailability=\"available\":(this._allAvailability=\"unknown\",this._tileAvailabilityBitSet=n,this.byteSize+=n.length)}static fromDefinition(a,o){const r=a.service.request||t,{row:s,col:h,width:c,height:m}=a,d={query:{f:\"json\"}};return o=o?{...d,...o}:d,r(n(a),o).then((t=>t.data)).catch((t=>{if(t&&t.details&&422===t.details.httpStatus)return{location:{top:s,left:h,width:c,height:m},valid:!0,data:i(c*m,0)};throw t})).then((t=>{if(t.location&&(t.location.top!==s||t.location.left!==h||t.location.width!==c||t.location.height!==m))throw new e(\"tilemap:location-mismatch\",\"Tilemap response for different location than requested\",{response:t,definition:{top:s,left:h,width:c,height:m}});return l.fromJSON(t)}))}static fromJSON(t){l.validateJSON(t);const i=new l;return i.location=Object.freeze(a(t.location)),i._updateFromData(t.data),Object.freeze(i)}static validateJSON(t){if(!t||!t.location)throw new e(\"tilemap:missing-location\",\"Location missing from tilemap response\");if(!1===t.valid)throw new e(\"tilemap:invalid\",\"Tilemap response was marked as invalid\");if(!t.data)throw new e(\"tilemap:missing-data\",\"Data missing from tilemap response\");if(!Array.isArray(t.data))throw new e(\"tilemap:data-mismatch\",\"Data must be an array of numbers\");if(t.data.length!==t.location.width*t.location.height)throw new e(\"tilemap:data-mismatch\",\"Number of data items does not match width/height of tilemap\")}}function o(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function n(t){let i;if(\"vector-tile\"===t.service.type)i=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;else{const e=t.service.tileServers;i=`${e&&e.length?e[t.row%e.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}const e=t.service.query;return e&&(i=`${i}?${e}`),i}export{l as Tilemap,l as default,o as tilemapDefinitionId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"./TileInfo.js\";const r={type:e,json:{origins:{service:{read:{source:[\"tileInfo\",\"minScale\",\"maxScale\",\"minLOD\",\"maxLOD\"],reader:n}}}}};function n(r,n,l,o){if(!r)return null;const{minScale:i,maxScale:t,minLOD:m,maxLOD:s}=n;if(null!=m&&null!=s)return o&&o.ignoreMinMaxLOD?e.fromJSON(r):e.fromJSON({...r,lods:r.lods.filter((({level:e})=>null!=e&&e>=m&&e<=s))});if(0!==i&&0!==t){const n=e=>Math.round(1e4*e)/1e4,l=i?n(i):1/0,o=t?n(t):-1/0;return e.fromJSON({...r,lods:r.lods.filter((e=>{const r=n(e.scale);return r<=l&&r>=o}))})}return e.fromJSON(r)}export{n as readServiceTileInfo,r as serviceTileInfoProperty};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as o}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{serviceTileInfoProperty as i}from\"../support/serviceTileInfoProperty.js\";import{TilemapCache as p}from\"../support/TilemapCache.js\";import a from\"../../geometry/SpatialReference.js\";const s=s=>{let l=class extends s{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}readMaxScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,r){return r.capabilities&&r.capabilities.indexOf(\"Tilemap\")>-1?new p({layer:this}):null}};return e([r({json:{read:{source:\"copyrightText\"}}})],l.prototype,\"copyright\",void 0),e([r()],l.prototype,\"minScale\",void 0),e([o(\"service\",\"minScale\")],l.prototype,\"readMinScale\",null),e([r()],l.prototype,\"maxScale\",void 0),e([o(\"service\",\"maxScale\")],l.prototype,\"readMaxScale\",null),e([r({type:a})],l.prototype,\"spatialReference\",void 0),e([r({readOnly:!0})],l.prototype,\"supportsBlankTile\",null),e([r(i)],l.prototype,\"tileInfo\",void 0),e([r()],l.prototype,\"tilemapCache\",void 0),e([o(\"service\",\"tilemapCache\",[\"capabilities\"])],l.prototype,\"readTilemapCache\",null),e([r()],l.prototype,\"version\",void 0),l=e([t(\"esri.layers.mixins.ArcGISCachedService\")],l),l};export{s as ArcGISCachedService};\n"],"sourceRoot":""}