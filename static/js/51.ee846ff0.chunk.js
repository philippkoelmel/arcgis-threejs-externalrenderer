(this.webpackJsonpexample=this.webpackJsonpexample||[]).push([[51],{1008:function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var r=i(14),a=i(2),n=i(3),s=i(6),o=i(7),c=i(513),l=i(133),u=i(95),d=i(276),h=i(106),b=i(0),p=i(81),f=i(124),v=i(117),O=i(86),y=i(90),j=i(26),g=i(75),m=i(85),w=i(123),_=i(896),k=i(38),C=function(e){Object(s.a)(i,e);var t=Object(o.a)(i);function i(){return Object(a.a)(this,i),t.apply(this,arguments)}return Object(n.a)(i,[{key:"initializeProgram",value:function(e){var t=i.shader.get(),r=this.configuration,a=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new m.a(e.rctx,a,g.a)}},{key:"bindPass",value:function(e,t){Object(v.c)(this.program,t.camera.projectionMatrix),this.program.setUniform1f("opacity",e.opacity),t.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(f.a)(this.program,t))}},{key:"bindDraw",value:function(e){Object(v.d)(this.program,e),Object(p.c)(this.program,this.configuration,e),this.program.rebindTextures()}},{key:"setPipelineState",value:function(e,t){var i=this.configuration,r=3===e,a=2===e;return Object(k.g)({blending:0!==i.output&&7!==i.output||!i.transparent?null:r?P:Object(u.a)(e),culling:Object(k.c)(i.cullFace),depthTest:{func:Object(u.b)(e)},depthWrite:r?i.writeDepth&&k.e:Object(u.c)(e),colorWrite:k.d,stencilWrite:i.sceneHasOcludees?w.j:null,stencilTest:i.sceneHasOcludees?t?w.f:w.e:null,polygonOffset:r||a?null:Object(u.h)(i.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}},{key:"getPipelineState",value:function(e){return e?this._occludeePipelineState:this.pipeline}}]),i}(y.a);C.shader=new O.a(_.a,(function(){return i.e(210).then(i.bind(null,1191))}));var P=Object(k.i)(1,771),x=function(e){Object(s.a)(i,e);var t=Object(o.a)(i);function i(){var e;return Object(a.a)(this,i),(e=t.apply(this,arguments)).output=0,e.cullFace=0,e.slicePlaneEnabled=!1,e.transparent=!1,e.enableOffset=!0,e.writeDepth=!0,e.sceneHasOcludees=!1,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return i}(j.a);Object(b.a)([Object(j.b)({count:8})],x.prototype,"output",void 0),Object(b.a)([Object(j.b)({count:3})],x.prototype,"cullFace",void 0),Object(b.a)([Object(j.b)()],x.prototype,"slicePlaneEnabled",void 0),Object(b.a)([Object(j.b)()],x.prototype,"transparent",void 0),Object(b.a)([Object(j.b)()],x.prototype,"enableOffset",void 0),Object(b.a)([Object(j.b)()],x.prototype,"writeDepth",void 0),Object(b.a)([Object(j.b)()],x.prototype,"sceneHasOcludees",void 0),Object(b.a)([Object(j.b)({count:4})],x.prototype,"transparencyPassType",void 0),Object(b.a)([Object(j.b)()],x.prototype,"multipassTerrainEnabled",void 0),Object(b.a)([Object(j.b)()],x.prototype,"cullAboveGround",void 0);var E=function(e){Object(s.a)(i,e);var t=Object(o.a)(i);function i(e){var r;return Object(a.a)(this,i),(r=t.call(this,e,S)).supportsEdges=!0,r.techniqueConfig=new x,r}return Object(n.a)(i,[{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<u.e,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}},{key:"intersect",value:function(e,t,i,r,a,n,s){Object(h.i)(e,t,r,a,n,void 0,s)}},{key:"getGLMaterial",value:function(e){return 0===e.output||7===e.output||4===e.output?new V(e):void 0}},{key:"createBufferWriter",value:function(){return new d.a(d.d)}}]),i}(l.a),V=function(e){Object(s.a)(i,e);var t=Object(o.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,Object(r.a)(Object(r.a)({},e),e.material.params))).updateParameters(),n}return Object(n.a)(i,[{key:"updateParameters",value:function(e){var t=this._material.params;this.updateTexture(t.textureId),this._technique=this._techniqueRep.releaseAndAcquire(C,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"beginSlot",value:function(e){return 23===e||(4===this._output?3===e:e===(this._technique.configuration.transparent?this._technique.configuration.writeDepth?5:8:3))}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&(this._material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}},{key:"ensureParameters",value:function(e){0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}},{key:"bind",value:function(e){this.bindTextures(this._technique.program),this.bindTextureScale(this._technique.program),this._technique.bindPass(this._material.params,e)}},{key:"getPipelineState",value:function(e,t){return this._technique.getPipelineState(t)}}]),i}(c.a),S=Object(r.a)({transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0},l.b)},1204:function(e,t,i){"use strict";i.r(t),i.d(t,"SliceLayerView3D",(function(){return ut})),i.d(t,"default",(function(){return dt}));var r=i(8),a=i.n(r),n=i(15),s=i(2),o=i(3),c=i(6),l=i(7),u=i(0),d=i(25),h=i(1),b=i(17),p=i(18),f=i(16),v=i(12),O=i(34),y=i(61),j=i(4),g=i(36),m=i(175),w=i(409),_=i(872),k=i(42),C=(i(29),i(140),i(156)),P=i(21),x=i(32),E=i(28),V=i(33),S=(i(217),i(5)),T=i(10),D=i(41),F=i(83),R=i(236),z=i(51),M=(i(11),i(94),i(130),i(68),i(99)),G=(i(31),i(49),i(70),i(43),i(139)),q=(i(381),i(179)),W=(i(235),i(93),i(186),i(311),i(57));Object(x.f)(),Object(G.c)(),Object(F.c)(),Object(M.b)(),Object(V.d)(),Object(V.d)(),Object(D.d)(),Object(T.e)(),Object(T.e)(),Object(T.e)(),Object(T.e)(),Object(T.e)(),Object(T.e)(),new W.a({x:0,y:0,z:0,spatialReference:null});var I=i(46),L=(i(114),i(194)),A=(i(610),i(14)),U=i(37),N=i(35),H=i(119),B=i(219),J=i(133),K=i(47),Z=i(169),Q=i(106),X=i(981),Y=i(81),$=i(124),ee=i(117),te=i(86),ie=i(90),re=i(26),ae=i(95),ne=i(85),se=i(982),oe=i(38),ce=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(){return Object(s.a)(this,i),t.apply(this,arguments)}return Object(o.a)(i,[{key:"initializeProgram",value:function(e){var t=i.shader.get(),r=this.configuration,a=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:r.screenSizeEnabled,shadingEnabled:r.shadingEnabled,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new ne.a(e.rctx,a,ue)}},{key:"bindPass",value:function(e,t){var i=this.configuration,r=i.screenSizeEnabled,a=i.shadingEnabled,n=e.color,s=e.shadingTint,o=e.shadingDirection;Object(ee.c)(this.program,t.camera.projectionMatrix),this.program.setUniform4fv("color",n),t.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object($.a)(this.program,t)),a&&(this.program.setUniform4fv("shadedColor",this.blendColor(de,s,n)),this.program.setUniform3fv("shadingDirection",o),this.program.setUniformMatrix4fv("viewNormal",t.camera.viewInverseTransposeMatrix)),r&&Object(X.b)(this.program,e,t)}},{key:"bindDraw",value:function(e){Object(ee.d)(this.program,e),Object(ee.a)(this.program,e.origin,e.camera.viewInverseTransposeMatrix),Object(Y.c)(this.program,this.configuration,e),this.program.rebindTextures()}},{key:"blendColor",value:function(e,t,i){var r=1-t[3],a=t[3]+i[3]*r;return 0===a?(e[3]=a,e):(e[0]=(t[0]*t[3]+i[0]*i[3]*r)/a,e[1]=(t[1]*t[3]+i[1]*i[3]*r)/a,e[2]=(t[2]*t[3]+i[2]*i[3]*r)/a,e[3]=i[3],e)}},{key:"setPipelineState",value:function(e){var t=this.configuration,i=3===e,r=2===e;return Object(oe.g)({blending:0!==t.output&&7!==t.output||!t.transparent?null:i?ae.g:Object(ae.a)(e),culling:Object(oe.c)(t.cullFace),depthTest:{func:r?513:t.shadingEnabled?515:513},depthWrite:i?t.writeDepth&&oe.e:Object(ae.c)(e),colorWrite:oe.d,polygonOffset:i||r?null:ae.d})}},{key:"initializePipeline",value:function(){return this.setPipelineState(this.configuration.transparencyPassType)}}]),i}(ie.a);ce.shader=new te.a(se.a,(function(){return i.e(220).then(i.bind(null,1196))}));var le=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(){var e;return Object(s.a)(this,i),(e=t.apply(this,arguments)).output=0,e.cullFace=0,e.slicePlaneEnabled=!1,e.transparent=!1,e.writeDepth=!0,e.screenSizeEnabled=!0,e.shadingEnabled=!0,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return i}(re.a);Object(u.a)([Object(re.b)({count:8})],le.prototype,"output",void 0),Object(u.a)([Object(re.b)({count:3})],le.prototype,"cullFace",void 0),Object(u.a)([Object(re.b)()],le.prototype,"slicePlaneEnabled",void 0),Object(u.a)([Object(re.b)()],le.prototype,"transparent",void 0),Object(u.a)([Object(re.b)()],le.prototype,"writeDepth",void 0),Object(u.a)([Object(re.b)()],le.prototype,"screenSizeEnabled",void 0),Object(u.a)([Object(re.b)()],le.prototype,"shadingEnabled",void 0),Object(u.a)([Object(re.b)({count:4})],le.prototype,"transparencyPassType",void 0),Object(u.a)([Object(re.b)()],le.prototype,"multipassTerrainEnabled",void 0),Object(u.a)([Object(re.b)()],le.prototype,"cullAboveGround",void 0);var ue=new Map([["position",0],["normal",1],["offset",2]]),de=Object(I.e)(),he=(J.a,function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){var r;return Object(s.a)(this,i),(r=t.call(this,e)).updateParameters(),r}return Object(o.a)(i,[{key:"updateParameters",value:function(e){this._technique=this._techniqueRep.releaseAndAcquire(ce,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"beginSlot",value:function(e){if(4===this._output)return 3===e;var t=3;return this._technique.configuration.transparent&&(t=this._technique.configuration.writeDepth?5:8),e===t||23===e}},{key:"ensureParameters",value:function(e){this.updateParameters(e)}},{key:"bind",value:function(e){this._technique.bindPass(this._material.getPassParameters(),e)}}]),i}(B.a)),be=Object(A.a)({color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:Object(S.t)(Object(T.e)(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0},J.b),pe=function(){function e(t){Object(s.a)(this,e),this.screenSizeEnabled=t;var i=Object(H.a)().vec3f("position").vec3f("normal");this.screenSizeEnabled&&i.vec3f("offset"),this.vertexBufferLayout=i}return Object(o.a)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get("position").length}},{key:"write",value:function(e,t,i,r){if(Object(Z.c)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,i,r),this.screenSizeEnabled){if(!t.vertexAttributes.has("offset"))throw new Error("offset vertex attribute required for screenSizeEnabled ShadedColorMaterial");var a=t.vertexAttributes.get("offset"),n=t.indices.get("offset");Object(K.a)(3===a.size);var s=i.getField("offset",N.u);if(!s)throw new Error("unable to acquire view for offset");Object(Z.e)(n,a.data,e.invTranspTransformation,s,r)}}}]),e}(),fe=Object(T.e)(),ve=Object(T.e)();function Oe(e,t,i,r){var a=Object(S.t)(z.d.get(),e),n=Object(S.t)(z.d.get(),t),s=Object(S.i)(z.d.get(),a,n);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=0,r[4]=n[0],r[5]=n[1],r[6]=n[2],r[7]=0,r[8]=s[0],r[9]=s[1],r[10]=s[2],r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}Object(b.a)("mac"),Math.cos(Object(P.h)(45)),Math.cos(Object(P.h)(5));var ye=[1,.5,0],je=[].concat(ye,[.7]),ge=[0,0,0,.04],me=[].concat(ye,[.5]),we=([].concat(ye,[1]),[].concat(ye,[1]),[].concat(ye,[1]),i(876)),_e=i(55),ke=i(229),Ce=i(843),Pe=i(136),xe=i(276),Ee=i(75),Ve=i(983),Se=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(){return Object(s.a)(this,i),t.apply(this,arguments)}return Object(o.a)(i,[{key:"initializeProgram",value:function(e){var t=i.shader.get().build();return new ne.a(e.rctx,t,Ee.a)}},{key:"bindPass",value:function(e,t){Object(ee.c)(this.program,t.camera.projectionMatrix),this.program.setUniform4fv("backgroundColor",e.backgroundColor),this.program.setUniform4fv("gridColor",e.gridColor),this.program.setUniform1f("gridWidth",e.gridWidth)}},{key:"bindDraw",value:function(e){Object(ee.d)(this.program,e),this.program.rebindTextures()}},{key:"initializePipeline",value:function(){return Object(oe.g)({blending:Object(oe.h)(1,1,771,771),depthTest:{func:513},colorWrite:oe.d})}}]),i}(ie.a);Se.shader=new te.a(Ve.a,(function(){return i.e(223).then(i.bind(null,1197))}));var Te=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){return Object(s.a)(this,i),t.call(this,e,Re)}return Object(o.a)(i,[{key:"intersect",value:function(e,t,i,r,a,n,s){return Object(Q.i)(e,t,r,a,n,void 0,s)}},{key:"createBufferWriter",value:function(){return new xe.a(xe.d)}},{key:"getGLMaterial",value:function(e){return 0===e.output?new De(e):void 0}}]),i}(J.a),De=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){var r;return Object(s.a)(this,i),(r=t.call(this,e))._technique=new Se(r._techniqueRep.constructionContext,null),r.updateParameters(),r}return Object(o.a)(i,[{key:"updateParameters",value:function(){}},{key:"beginSlot",value:function(e){return 8===e}},{key:"bind",value:function(e){this._technique.bindPass(this._material.params,e)}}]),i}(B.a);Object(u.a)([Object(Pe.c)()],De.prototype,"_technique",void 0);var Fe,Re=Object(A.a)({backgroundColor:[1,0,0,.5],gridColor:[0,1,0,.5],gridWidth:4},J.b),ze=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){var r;return Object(s.a)(this,i),(r=t.call(this,e))._material=null,r._renderOccluded=4,r._gridWidth=1,r._gridColor=Object(ke.c)(1,0,0,1),r._backgroundColor=Object(ke.c)(1,0,0,1),r.applyProps(e),r}return Object(o.a)(i,[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}},{key:"gridWidth",get:function(){return this._gridWidth},set:function(e){this._gridWidth!==e&&(this._gridWidth=e,this._updateMaterial())}},{key:"gridColor",get:function(){return this._gridColor},set:function(e){Object(_e.c)(this._gridColor,e),this._updateMaterial()}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){Object(_e.c)(this._backgroundColor,e),this._updateMaterial()}},{key:"createExternalResources",value:function(){this._material=new Te(this.materialParameters)}},{key:"destroyExternalResources",value:function(){this._material=null}},{key:"forEachExternalMaterial",value:function(e){Object(j.k)(this._material)&&e(this._material)}},{key:"createGeometries",value:function(e){if(Object(j.k)(this._material)){var t=L.a.createSquareGeometry();e.addGeometry(t,this._material)}}},{key:"materialParameters",get:function(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}},{key:"_updateMaterial",value:function(){Object(j.k)(this._material)&&this._material.setParameterValues(this.materialParameters)}}]),i}(Ce.a),Me=(i(131),i(1008),i(400),i(383),i(30)),Ge=i(27),qe=i(66),We=i(837),Ie=i(97),Le=Fe=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){var r;return Object(s.a)(this,i),(r=t.call(this,e)).type="plane",r.position=null,r.heading=0,r.tilt=0,r.width=10,r.height=10,r}return Object(o.a)(i,[{key:"clone",value:function(){return new Fe({position:Object(Ge.a)(this.position),heading:this.heading,tilt:this.tilt,width:this.width,height:this.height})}},{key:"equals",value:function(e){return this.heading===e.heading&&this.tilt===e.tilt&&Object(j.k)(this.position)&&Object(j.k)(e.position)&&this.position.equals(e.position)&&this.width===e.width&&this.height===e.height}}]),i}(Me.a);Object(u.a)([Object(h.b)({readOnly:!0,json:{read:!1,write:!0}})],Le.prototype,"type",void 0),Object(u.a)([Object(h.b)({type:W.a}),Object(We.a)()],Le.prototype,"position",void 0),Object(u.a)([Object(h.b)({type:Number,nonNullable:!0,range:{min:0,max:360}}),Object(We.a)(),Object(qe.a)((function(e){return Ie.e.normalize(Object(p.i)(e),0,!0)}))],Le.prototype,"heading",void 0),Object(u.a)([Object(h.b)({type:Number,nonNullable:!0,range:{min:0,max:360}}),Object(We.a)(),Object(qe.a)((function(e){return Ie.e.normalize(Object(p.i)(e),0,!0)}))],Le.prototype,"tilt",void 0),Object(u.a)([Object(h.b)({type:Number,nonNullable:!0}),Object(We.a)()],Le.prototype,"width",void 0),Object(u.a)([Object(h.b)({type:Number,nonNullable:!0}),Object(We.a)()],Le.prototype,"height",void 0);var Ae=Le=Fe=Object(u.a)([Object(v.a)("esri.widgets.Slice.SlicePlane")],Le),Ue=f.a.getLogger("esri.views.3d.interactive.analysisTools.slice.sliceToolUtils");function Ne(e,t,i){var r=t.worldUpAtPosition(e.origin,z.d.get()),a=e.basis1,n=Be(e,r),s=Math.round(n/Ze)*Ze;return Object(m.j)(e,s-n,a,i)}function He(e){return new we.a({view:e,attached:!0,color:je,width:1,writeDepthEnabled:!1,renderOccluded:4,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]]})}function Be(e,t){return Object(R.b)(t,e.basis2,e.basis1)+Ze}function Je(e,t,i){return Object(R.b)(e.basis1,i,t)-Ze}function Ke(e,t,i,r,a,n){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Object(m.b)();return n.toRenderCoords(e,s.origin)?(n.worldBasisAtPosition(s.origin,0,s.basis1),n.worldBasisAtPosition(s.origin,1,s.basis2),Object(D.j)(s.basis2,s.basis1,s.origin,s.plane),Object(m.j)(s,-Object(P.h)(t),Object(m.i)(s),s),Object(m.j)(s,Object(P.h)(i),s.basis1,s),Object(S.g)(s.basis1,s.basis1,r/2),Object(S.g)(s.basis2,s.basis2,a/2),Object(m.l)(s),s):(Ue.error("Failed to project slice plane position, projection from ".concat(e.spatialReference.wkid," is not supported")),null)}Object(F.c)();var Ze=Math.PI/2,Qe=f.a.getLogger("esri.views.3d.interactive.graphics.Slice.SliceController"),Xe=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){var r;return Object(s.a)(this,i),(r=t.call(this,e))._handles=new y.a,r._internalChange=!1,r._currentSlicePlane=null,r.state="pending",r}return Object(o.a)(i,[{key:"ready",get:function(){return"ready"===this.state}},{key:"initialize",value:function(){var e=this;this._handles.add(this.layerView.layerViewData.excludedLayers.on("before-add",(function(t){var i=t.item;null!=i&&(i instanceof w.a||i instanceof _.a)?i instanceof w.a&&function(e){switch(e.type){case"building-scene":case"csv":case"direct-line-measurement":case"area-measurement":case"feature":case"geo-rss":case"geojson":case"graphics":case"group":case"integrated-mesh":case"kml":case"line-of-sight":case"map-notes":case"ogc-feature":case"point-cloud":case"route":case"slice":case"scene":case"stream":case"voxel":case"subtype-group":case"unknown":case"unsupported":case"wfs":case null:return!1;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"elevation":case"imagery":case"imagery-tile":case"map-image":case"open-street-map":case"tile":case"vector-tile":case"wcs":case"web-tile":case"wms":case"wmts":return!0;default:return Object(C.a)(e.type),!1}}(i)?(Qe.error("excludedLayers","Layer '".concat(i.title,", id:").concat(i.id,"' of type '").concat(i.type,"' can not be individually excluded from slicing. Use 'excludeGroundSurface' instead.")),t.preventDefault()):e.layerView.layerViewData.excludedLayers.includes(i)&&t.preventDefault():(Qe.error("excludedLayers","Invalid layer type, layer must derive from Layer or BuildingComponentSublayer"),t.preventDefault())}))),this._handles.add(Object(g.j)(this.view,"ready",(function(){return e._initialize()}),!0))}},{key:"_initialize",value:function(){var e,t,i=this;switch(this.state){case"pending":break;case"destroyed":return;case"ready":throw new Error("state error")}e=this.view,t=this,Ye.has(e)||Ye.set(e,{all:[],activeController:null}),Ye.get(e).all.push(t),this._handles.add([this.layerView.layerViewData.watch("plane",(function(){i._internalChange||i._updateSlicePlaneFromBoundedPlane(),i._updateLayerViews()}),!0),this.layerView.layerViewData.watch("excludeGroundSurface",(function(){return i._updateLayerViews()}),!0),this.layerView.layerViewData.excludedLayers.on("change",(function(){return i._updateLayerViews()})),this.layerView.watch(["active","visible"],(function(){i._updateActiveController(),i._updateViewSlicePlane()}),!0),this.view.allLayerViews.on("change",(function(){return i._updateLayerViews()}))]),this._handles.add([this.analysis.watch("plane",(function(){i._internalChange||(i._updateBoundedPlaneFromSlicePlane(),i._updateViewSlicePlane())}),!0)],"analysis"),this._set("state","ready"),this._updateActiveController(),this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane()}},{key:"destroy",value:function(){switch(this.state){case"destroyed":case"pending":return}this.layerView.active=!1,function(e,t){if(!Ye.has(e))throw new Error("view expected in global slice register");var i=Ye.get(e),r=i.all.lastIndexOf(t);if(-1===r)throw new Error("controller expected in global slice register");i.all.splice(r,1),0===i.all.length&&Ye.delete(e)}(this.view,this),this._handles.destroy(),this.view.slicePlane=null,this.set("view",null),this._set("state","destroyed")}},{key:"whenReady",value:function(){var e=Object(n.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.j)(this,"ready");case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_updateBoundedPlaneFromSlicePlane",value:function(){var e=this.analysis.plane,t=this._currentSlicePlane;if(!(Object(j.j)(t)&&Object(j.j)(e)||Object(j.k)(t)&&Object(j.k)(e)&&e.equals(t))){var i=null,r=null;Object(j.k)(e)&&(i=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(m.b)();if(Object(j.j)(e)||Object(j.j)(e.position))return null;var r=e.position;return e.position.hasZ||((r=e.position.clone()).z=Object(j.u)(Object(q.b)(t.elevationProvider,e.position),0)),Ke(r,e.heading,e.tilt,e.width,e.height,t.renderCoordsHelper,i)}(e,this.view,Object(m.b)()),Object(j.k)(i)?r={heading:e.heading,tilt:e.tilt,position:e.position,width:e.width,height:e.height}:console.warn("Failed slice plane conversion.")),this._currentSlicePlane=r,Object(j.k)(i)&&!this.analysis.tiltEnabled&&Ne(i,this.view.renderCoordsHelper,i),this._internalChange=!0,this.layerView.layerViewData.plane=i,this._internalChange=!1}}},{key:"_updateSlicePlaneFromBoundedPlane",value:function(){var e=this.layerView.layerViewData.plane,t=function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ae;if(Object(j.j)(e))return null;var a=Object(j.k)(r.position)?r.position:new W.a;t.fromRenderCoords(e.origin,a,i),r.position=a;var n=t.worldUpAtPosition(e.origin,z.d.get()),s=t.worldBasisAtPosition(e.origin,1,z.d.get());return r.width=2*Object(S.r)(e.basis1),r.height=2*Object(S.r)(e.basis2),r.tilt=Object(P.r)(Be(e,n)),r.heading=Object(P.r)(Je(e,n,s)),r}(e,this.view.renderCoordsHelper,this.view.spatialReference,new Ae),i=null;Object(j.k)(t)&&(i={heading:t.heading,tilt:t.tilt,position:t.position,width:t.width,height:t.height}),this._currentSlicePlane=i,Object(j.k)(e)&&(this.analysis.tiltEnabled||Ne(e,this.view.renderCoordsHelper,e)),this._internalChange=!0,this.analysis.plane=t,this._internalChange=!1,this._updateViewSlicePlane()}},{key:"_updateActiveController",value:function(){if(!$e){var e=et(this.view);if(this.layerView.active)Object(j.k)(e.activeController)&&e.activeController!==this?($e=!0,e.activeController.layerView.active=!1,$e=!1):Object(j.k)(e.activeController)&&e.activeController,this._updateLayerViews(),e.activeController=this;else{if(Object(j.k)(e.activeController)&&e.activeController!==this)return;Object(j.k)(e.activeController)&&e.activeController===this&&(e.activeController=null,this._updateLayerViews())}}}},{key:"_updateViewSlicePlane",value:function(){"ready"===this.state&&function(e){var t=et(e).activeController;Object(j.k)(t)&&Object(j.k)(t.layerView.layerViewData.plane)&&t.layerView.visible?e.slicePlane=t.layerView.layerViewData.plane:e.slicePlane=null}(this.view)}},{key:"_updateLayerViews",value:function(){var e=Object(j.k)(this.layerView.layerViewData.plane)&&this.layerView.visible&&this.layerView.active,t=[];this.layerView.layerViewData.excludedLayers.forEach((function e(i){"layers"in i?i.layers.forEach(e):t.push(i)})),this.view.allLayerViews.forEach((function(i){"slicePlaneEnabled"in i&&(i.slicePlaneEnabled=e&&t.indexOf(i.layer)<0),"sublayerViews"in i&&i.sublayerViews.forEach((function(i){i.slicePlaneEnabled=e&&t.indexOf(i.sublayer)<0}))})),null!=this.view.basemapTerrain&&(this.view.basemapTerrain.slicePlaneEnabled=e&&!this.layerView.layerViewData.excludeGroundSurface)}}]),i}(O.a);Object(u.a)([Object(h.b)({readOnly:!0})],Xe.prototype,"state",void 0),Object(u.a)([Object(h.b)()],Xe.prototype,"view",void 0),Object(u.a)([Object(h.b)()],Xe.prototype,"analysis",void 0),Object(u.a)([Object(h.b)()],Xe.prototype,"layerView",void 0),Object(u.a)([Object(h.b)()],Xe.prototype,"ready",null),Xe=Object(u.a)([Object(v.a)("esri.views.3d.interactive.graphics.Slice.SliceController")],Xe);var Ye=new Map,$e=!1;function et(e){return Ye.get(e)}var tt=i(218),it=i(363),rt=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){var r;return Object(s.a)(this,i),(r=t.call(this,e))._handles=new y.a,r._gridVisualElement=null,r._outlineVisualElement=null,r.state="pending",r}return Object(o.a)(i,[{key:"ready",get:function(){return"ready"===this.state}},{key:"showGrid",set:function(e){this._set("showGrid",e),this._updateMaterials()}},{key:"editable",set:function(e){this._set("editable",e),this._updateMaterials()}},{key:"initialize",value:function(){this._initialize()}},{key:"_initialize",value:function(){var e=Object(n.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.state,e.next="pending"===e.t0?3:"destroyed"===e.t0?4:"ready"===e.t0?5:6;break;case 3:return e.abrupt("break",6);case 4:return e.abrupt("return");case 5:throw new Error("state error");case 6:return e.next=8,Object(g.j)(this.view,"ready",!0);case 8:if(!Object(j.j)(this.layerView.layerViewData)){e.next=10;break}throw new Error("expected internal object to be valid");case 10:this._gridVisualElement=(i=this.view,new ze({view:i,attached:!0,backgroundColor:Object(k.a)(ge),gridColor:me,gridWidth:4,renderOccluded:4})),this._outlineVisualElement=He(this.view),this._handles.add(Object(tt.d)((function(){return t.layerView.fullOpacity}),(function(){return t._updateMaterials()})),"layer"),this._handles.add([this.layerView.watch("visible",(function(){return t._updateMaterials()}),!0),this.layerView.layerViewData.watch("plane",(function(){return t._updatePlane()}),!0),this.layerView.watch("active",(function(){return t._updateMaterials()}),!0)],"internal"),this._updatePlane(),this._set("state","ready");case 11:case"end":return e.stop()}var i}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){switch(this.state){case"destroyed":case"pending":return}this._handles.destroy(),this._gridVisualElement=Object(j.e)(this._gridVisualElement),this._outlineVisualElement=Object(j.e)(this._outlineVisualElement),this.set("view",null),this._set("state","destroyed")}},{key:"whenReady",value:function(){var e=Object(n.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.j)(this,"ready");case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_update",value:function(){switch(this.state){case"pending":case"destroyed":return}}},{key:"_updatePlane",value:function(){var e=this.layerView.layerViewData.plane,t=Object(j.k)(e)?function(e,t){return Oe(e.basis1,e.basis2,e.origin,t)}(e,z.a.get()):null;if(this._outlineVisualElement.width=1,Object(j.k)(e)){var i=Object(S.y)(z.d.get(),Object(S.r)(e.basis1),Object(S.r)(e.basis2),1),r=Object(E.w)(z.a.get(),i),a=Object(E.m)(r,t,r);this._outlineVisualElement.transform=a,this._gridVisualElement.transform=a}this._updateMaterials()}},{key:"_updateMaterials",value:function(){var e=this.layerView.layerViewData.plane&&this.layerView.visible,t=this.layerView.active,i=this.layerView.fullOpacity,r=Object(P.c)(at,je,i);this._outlineVisualElement.color=r,this._outlineVisualElement.width=this.editable?1:2,this._outlineVisualElement.stipplePattern=t?null:Object(it.b)(5);var a=Object(P.c)(at,ge,i),n=Object(j.k)(this.layerView.layerViewData)&&this.showGrid?me:[0,0,0,0];this._gridVisualElement.backgroundColor=a,this._gridVisualElement.gridColor=n,this._gridVisualElement.visible=e,this._outlineVisualElement.visible=e}}]),i}(O.a);Object(u.a)([Object(h.b)({readOnly:!0})],rt.prototype,"state",void 0),Object(u.a)([Object(h.b)()],rt.prototype,"view",void 0),Object(u.a)([Object(h.b)()],rt.prototype,"layer",void 0),Object(u.a)([Object(h.b)()],rt.prototype,"layerView",void 0),Object(u.a)([Object(h.b)()],rt.prototype,"ready",null),Object(u.a)([Object(h.b)({value:!1})],rt.prototype,"showGrid",null),Object(u.a)([Object(h.b)({value:!0})],rt.prototype,"editable",null),rt=Object(u.a)([Object(v.a)("esri.views.3d.interactive.graphics.Slice.SliceView")],rt);var at=Object(I.e)(),nt=i(631),st=i(54),ot=i(230),ct=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(){var e;return Object(s.a)(this,i),(e=t.apply(this,arguments)).plane=null,e.excludeGroundSurface=!1,e}return Object(o.a)(i,[{key:"excludedLayers",get:function(){return this._get("excludedLayers")||new st.a},set:function(e){this._set("excludedLayers",Object(ot.b)(e,this._get("excludedLayers")))}}]),i}(O.a);Object(u.a)([Object(h.b)()],ct.prototype,"plane",void 0),Object(u.a)([Object(h.b)()],ct.prototype,"excludeGroundSurface",void 0),Object(u.a)([Object(h.b)({cast:ot.a})],ct.prototype,"excludedLayers",null),ct=Object(u.a)([Object(v.a)("esri.views.3d.interactive.graphics.Slice.SliceInternal")],ct);var lt=i(630),ut=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(){var e;return Object(s.a)(this,i),(e=t.apply(this,arguments)).type="slice-3d",e.analysisView=null,e.analysisController=null,e._initialized=Object(d.g)(),e.layerViewData=new ct,e.active=!0,e.showGrid=!1,e.editable=!1,e}return Object(o.a)(i,[{key:"initialize",value:function(){this.analysisView=new rt({view:this.view,layer:this.layer,layerView:this}),this.analysisController=new Xe({view:this.view,analysis:this.layer,layerView:this}),this._initialized.resolve()}},{key:"destroy",value:function(){this.analysisView.destroy(),this.analysisView=null,this.analysisController.destroy(),this.analysisController=null}},{key:"when",value:function(){var e=Object(n.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.destroyed){e.next=4;break}e.t0=null,e.next=21;break;case 4:return e.next=6,this._initialized.promise;case 6:if(!this.destroyed){e.next=10;break}e.t1=null,e.next=20;break;case 10:return e.next=12,this.analysisView.whenReady();case 12:if(!this.destroyed){e.next=16;break}e.t2=null,e.next=19;break;case 16:return e.next=18,this.analysisController.whenReady();case 18:e.t2=this;case 19:e.t1=e.t2;case 20:e.t0=e.t1;case 21:return e.abrupt("return",e.t0);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"testData",get:function(){return{view:this.analysisView,controller:this.analysisController}}}]),i}(Object(nt.a)(lt.a));Object(u.a)([Object(h.b)()],ut.prototype,"type",void 0),Object(u.a)([Object(h.b)()],ut.prototype,"layerViewData",void 0),Object(u.a)([Object(h.b)()],ut.prototype,"layer",void 0),Object(u.a)([Object(h.b)()],ut.prototype,"active",void 0),Object(u.a)([Object(h.b)({aliasOf:"analysisView.showGrid"})],ut.prototype,"showGrid",void 0),Object(u.a)([Object(h.b)({aliasOf:"analysisView.editable"})],ut.prototype,"editable",void 0);var dt=ut=Object(u.a)([Object(v.a)("esri.views.3d.layers.SliceLayerView3D")],ut)},834:function(e,t,i){"use strict";function r(e){return e&&"getAtOrigin"in e&&"originOf"in e}i.d(t,"a",(function(){return r}))},837:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var r=i(8),a=i.n(r),n=i(15),s=i(14),o=i(11),c=i(4),l=i(834),u=i(44),d=i(641),h=i(231),b=i(185),p=i(1);function f(e){return v[function(e){return e instanceof Blob?e.type:function(e){var t=Object(u.n)(e);return j[t]||O}(e.url)}(e)]||y}var v={},O="text/plain",y=v[O],j={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip"};for(var g in j)v[j[g]]=g;var m=i(144);function w(e){var t=Object(c.k)(e)&&e.origins?e.origins:[void 0];return function(i,r){var a,n=function(e,t,i){if(Object(c.k)(e)&&"resource"===e.type)return function(e,t,i){var r=Object(h.b)(t,i);return{type:String,read:function(e,t,i){var a=Object(m.d)(e,t,i);return r.type===String?a:"function"==typeof r.type?new r.type({url:a}):void 0},write:{writer:function(t,a,n,o){if(!o||!o.resources)return"string"==typeof t?void(a[n]=Object(m.e)(t,o)):void(a[n]=t.write({},o));var d=function(e){return Object(c.j)(e)?null:"string"==typeof e?e:e.url}(t),h=d?Object(m.e)(d,Object(s.a)(Object(s.a)({},o),{},{verifyItemRelativeUrls:o&&o.verifyItemRelativeUrls?{writtenUrls:o.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null}),1):null,p=r.type!==String&&(!Object(l.a)(this)||o&&o.origin&&this.originIdOf(i)>Object(b.d)(o.origin));o&&o.portalItem&&Object(c.k)(h)&&!Object(u.s)(h)?p?function(e,t,i,r,a,n,s,o){var c=s.portalItem.resourceFromPath(r),l=C(i,r,s);f(l)===Object(u.n)(c.path)?(k(e,t,c,l,s.resources.toUpdate),a[n]=r):_(e,t,i,r,a,n,s,o)}(this,i,t,h,a,n,o,e):function(e,t,i,r){r.resources.toKeep.push({resource:r.portalItem.resourceFromPath(e)}),t[i]=e}(h,a,n,o):o&&o.portalItem&&(Object(c.j)(h)||Object(c.k)(Object(m.b)(h))||Object(u.t)(h)||p)?_(this,i,t,h,a,n,o,e):a[n]=h}}}}(e,t,i);switch(Object(c.k)(e)&&e.type?e.type:"other"){case"other":return{read:!0,write:!0};case"url":return{read:m.c.read,write:m.c.write}}}(e,i,r),d=Object(o.a)(t);try{for(d.s();!(a=d.n()).done;){var v=a.value,O=Object(p.c)(i,v,r);for(var y in n)O[y]=n[y]}}catch(j){d.e(j)}finally{d.f()}}}function _(e,t,i,r,a,n,s,o){var l=Object(d.a)(),h=C(i,r,s),b=Object(u.z)(Object(c.i)(o,"prefix"),l),p="".concat(b,".").concat(f(h)),v=s.portalItem.resourceFromPath(p);Object(u.t)(r)&&s.resources.pendingOperations.push(function(e){return P.apply(this,arguments)}(r).then((function(e){v.path="".concat(b,".").concat(f(e)),a[n]=v.itemRelativeUrl})).catch((function(){}))),k(e,t,v,h,s.resources.toAdd),a[n]=v.itemRelativeUrl}function k(e,t,i,r,a){a.push({resource:i,content:r,finish:function(i){!function(e,t,i){"string"==typeof e[t]?e[t]=i.url:e[t].url=i.url}(e,t,i)}})}function C(e,t,i){return"string"==typeof e?{url:t}:new Blob([JSON.stringify(e.toJSON(i))],{type:"application/json"})}function P(){return(P=Object(n.a)(a.a.mark((function e(t){var r,n,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(i.bind(null,107));case 2:return r=e.sent.default,e.next=5,r(t,{responseType:"blob"});case 5:return n=e.sent,s=n.data,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},843:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i(2),a=i(3),n=i(6),s=i(7),o=i(4),c=i(28),l=i(33),u=i(875),d=i(186),h=i(311),b=function(e){Object(n.a)(i,e);var t=Object(s.a)(i);function i(e){var a;return Object(r.a)(this,i),(a=t.call(this,e.view))._resources=null,a._transform=Object(l.d)(),a}return Object(a.a)(i,[{key:"object",get:function(){return Object(o.k)(this._resources)?this._resources.object:null}},{key:"transform",get:function(){return this._transform},set:function(e){Object(c.e)(this._transform,e),Object(o.k)(this._resources)&&(this._resources.object.transformation=this._transform)}},{key:"recreate",value:function(){this.attached&&this.createResources()}},{key:"recreateGeometry",value:function(){if(!Object(o.j)(this._resources)){var e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),t.addMany(e.geometries)}}},{key:"createResources",value:function(){this.destroyResources();var e=this.view._stage;if(e){var t=new h.a({isPickable:!1,updatePolicy:1});e.add(t);var i=new d.a({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((function(t){return e.add(t)})),e.add(i),t.add(i),this.visible||i.setVisible(!1),this._resources={layer:t,object:i}}}},{key:"destroyResources",value:function(){var e=this.view._stage;!Object(o.j)(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((function(t){e.remove(t),t.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}},{key:"updateVisibility",value:function(e){Object(o.j)(this._resources)||this._resources.object.setVisible(e)}}]),i}(u.a)},875:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(2),a=i(3),n=function(){function e(t){var i=this;Object(r.a)(this,e),this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch("ready",(function(e){i._resourcesCreated&&(e?i._createResources():i._destroyResources())}))}return Object(a.a)(e,[{key:"applyProps",value:function(e){var t=!1;for(var i in e)i in this?"attached"===i?t=e[i]:this[i]=e[i]:console.error("Cannot set unknown property",i);this.attached=t}},{key:"destroy",value:function(){this.attached=!1}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}},{key:"_createResources",value:function(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}},{key:"_destroyResources",value:function(){this.destroyResources(),this._resourcesCreated=!1}}]),e}()},876:function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var r=i(2),a=i(3),n=i(6),s=i(7),o=i(4),c=i(28),l=i(33),u=i(5),d=i(10),h=i(55),b=i(229),p=i(843),f=i(388),v=i(383),O=function(e){Object(n.a)(i,e);var t=Object(s.a)(i);function i(e){var a;return Object(r.a)(this,i),(a=t.call(this,e))._renderOccluded=4,a._width=1,a._color=Object(b.c)(1,0,1,1),a._innerWidth=1,a._innerColor=null,a._stipplePattern=null,a._stippleOffColor=null,a._stippleIntegerRepeats=!1,a._writeDepthEnabled=!0,a._falloff=0,a._polygonOffset=!1,a.applyProps(e),a}return Object(a.a)(i,[{key:"setGeometryFromRenderSpacePoint",value:function(e){var t=1e3,i=[];i.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),i.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),i.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=i}},{key:"setGeometryFromExtent",value:function(e){var t=this.view.spatialReference,i=Object(d.e)(),r=Object(d.e)(),a=100,n=[];Object(u.y)(i,e[0],e[1],a),this.view.renderCoordsHelper.toRenderCoords(i,t,r),n.push([r[0],r[1],r[2]]),Object(u.y)(i,e[2],e[1],a),this.view.renderCoordsHelper.toRenderCoords(i,t,r),n.push([r[0],r[1],r[2]]),Object(u.y)(i,e[2],e[3],a),this.view.renderCoordsHelper.toRenderCoords(i,t,r),n.push([r[0],r[1],r[2]]),Object(u.y)(i,e[0],e[3],a),this.view.renderCoordsHelper.toRenderCoords(i,t,r),n.push([r[0],r[1],r[2]]),Object(u.y)(i,e[0],e[1],a),this.view.renderCoordsHelper.toRenderCoords(i,t,r),n.push([r[0],r[1],r[2]]),Object(u.y)(i,e[0],e[1],a),this.view.renderCoordsHelper.toRenderCoords(i,t,r),n.push([r[0],r[1],r[2]]),this.geometry=[n]}},{key:"setGeometryFromFrustum",value:function(e){var t=[];e.lines.forEach((function(e){t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}},{key:"setGeometryFromBoundedPlane",value:function(e){var t=[],i=e.origin,r=e.basis1,a=e.basis2,n=.5,s=Object(d.e)(),o=Object(d.e)(),c=Object(d.e)(),l=Object(d.e)();s[0]=i[0]-r[0]*n-a[0]*n,s[1]=i[1]-r[1]*n-a[1]*n,s[2]=i[2]-r[2]*n-a[2]*n,o[0]=i[0]-r[0]*n+a[0]*n,o[1]=i[1]-r[1]*n+a[1]*n,o[2]=i[2]-r[2]*n+a[2]*n,c[0]=i[0]+r[0]*n+a[0]*n,c[1]=i[1]+r[1]*n+a[1]*n,c[2]=i[2]+r[2]*n+a[2]*n,l[0]=i[0]+r[0]*n-a[0]*n,l[1]=i[1]+r[1]*n-a[1]*n,l[2]=i[2]+r[2]*n-a[2]*n,t.push([s[0],s[1],s[2]]),t.push([o[0],o[1],o[2]]),t.push([c[0],c[1],c[2]]),t.push([l[0],l[1],l[2]]),t.push([s[0],s[1],s[2]]),this.geometry=[t]}},{key:"setGeometryFromSegment",value:function(e){var t=e.endRenderSpace;Object(c.i)(y),Object(c.t)(y,y,t),this.transform=y;var i=e.createRenderGeometry(t,this.view.renderCoordsHelper).points;this.geometry=[i]}},{key:"setGeometryFromSegments",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.b;Object(c.i)(y),Object(c.t)(y,y,i),this.transform=y,this.geometry=e.map((function(e){return e.createRenderGeometry(i,t.view.renderCoordsHelper).points}))}},{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this.recreateGeometry()}},{key:"width",get:function(){return this._width},set:function(e){e!==this._width&&(this._width=e,this._updateMaterial())}},{key:"color",get:function(){return this._color},set:function(e){Object(h.g)(e,this._color)||(Object(h.c)(this._color,e),this._updateMaterial())}},{key:"innerWidth",get:function(){return this._innerWidth},set:function(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}},{key:"innerColor",get:function(){return this._innerColor},set:function(e){Object(o.k)(e)?!Object(o.j)(this._innerColor)&&Object(h.g)(e,this._innerColor)||(this._innerColor=Object(h.c)(Object(b.b)(),e),this._updateMaterial()):Object(o.k)(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}},{key:"stipplePattern",get:function(){return this._stipplePattern},set:function(e){var t=Object(o.k)(e)!==Object(o.k)(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}},{key:"stippleOffColor",get:function(){return this._stippleOffColor},set:function(e){(Object(o.j)(e)||Object(o.j)(this._stippleOffColor)||!Object(h.g)(e,this._stippleOffColor))&&(this._stippleOffColor=Object(o.k)(e)?Object(b.a)(e):null,this._updateMaterial())}},{key:"stippleIntegerRepeats",get:function(){return this._stippleIntegerRepeats},set:function(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}},{key:"writeDepthEnabled",get:function(){return this._writeDepthEnabled},set:function(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}},{key:"falloff",get:function(){return this._falloff},set:function(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}},{key:"polygonOffset",get:function(){return this._polygonOffset},set:function(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}},{key:"createExternalResources",value:function(){this._material=new v.a(this.materialParameters)}},{key:"destroyExternalResources",value:function(){this._material=null}},{key:"createGeometries",value:function(e){var t=this._createLineGeometries();if(0!==t.length)for(var i=0;i<t.length;++i){var r=Object(f.a)(t[i]);e.addGeometry(r,this._material)}}},{key:"forEachExternalMaterial",value:function(e){e(this._material)}},{key:"materialParameters",get:function(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}},{key:"_updateMaterial",value:function(){this.attached&&this._material.setParameterValues(this.materialParameters)}},{key:"_createLineGeometries",value:function(){var e=this.geometry;if(Object(o.j)(e)||0===e.length)return[];var t=[];return e.forEach((function(e){var i=e.length,r=new Float64Array(3*i);e.forEach((function(e,t){r[3*t+0]=e[0],r[3*t+1]=e[1],r[3*t+2]=e[2]}));var a={attributeData:{position:r},removeDuplicateStartEnd:0};t.push(a)})),t}}]),i}(p.a),y=Object(l.d)()},896:function(e,t,i){"use strict";i.d(t,"a",(function(){return v})),i.d(t,"b",(function(){return f}));var r,a,n,s=i(13),o=i(81),c=i(147),l=i(126),u=i(124),d=i(121),h=i(183),b=i(9),p=i(84);function f(e){var t=new p.a;return t.include(c.a,{linearDepth:!1}),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.attributes.add("position","vec3"),t.attributes.add("uv0","vec2"),t.varyings.add("vpos","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),t.vertex.uniforms.add("textureCoordinateScaleFactor","vec2"),t.vertex.code.add(Object(b.a)(r||(r=Object(s.a)(["\n    void main(void) {\n      vpos = position;\n      ","\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":"")),t.include(o.a,e),e.multipassTerrainEnabled&&(t.fragment.include(l.a),t.include(u.b,e)),t.fragment.uniforms.add("tex","sampler2D"),t.fragment.uniforms.add("opacity","float"),t.varyings.add("vTexCoord","vec2"),7===e.output?t.fragment.code.add(Object(b.a)(a||(a=Object(s.a)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ",") {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",b.a.float(d.b))):(t.fragment.include(h.a),t.fragment.code.add(Object(b.a)(n||(n=Object(s.a)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ",") {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ","\n    }\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",b.a.float(d.b),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),t}var v=Object.freeze({__proto__:null,build:f})},899:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(8),a=i.n(r),n=i(15),s=i(107),o=i(24),c=i(4);function l(e,t,i,r,a,n){return u.apply(this,arguments)}function u(){return u=Object(n.a)(a.a.mark((function e(t,i,r,n,l,u){var d,h,b,p,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=null,!Object(c.k)(r)){e.next=17;break}return h="".concat(t,"/nodepages/"),b=h+Math.floor(r.rootIndex/r.nodesPerPage),e.prev=3,e.next=6,Object(s.default)(b,{query:{f:"json",token:n},responseType:"json",signal:u});case 6:return e.t0=e.sent.data,e.t1=r.rootIndex,e.t2=r.nodesPerPage,e.t3=r.lodSelectionMetricType,e.t4=h,e.abrupt("return",{type:"page",rootPage:e.t0,rootIndex:e.t1,pageSize:e.t2,lodMetric:e.t3,urlPrefix:e.t4});case 14:e.prev=14,e.t5=e.catch(3),Object(c.k)(l)&&l.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",b,e.t5),d=e.t5;case 17:if(i){e.next=19;break}return e.abrupt("return",null);case 19:return p="".concat(t,"/nodes/"),f=p+(i&&i.split("/").pop()),e.prev=20,e.next=23,Object(s.default)(f,{query:{f:"json",token:n},responseType:"json",signal:u});case 23:return e.t6=e.sent.data,e.t7=p,e.abrupt("return",{type:"node",rootNode:e.t6,urlPrefix:e.t7});case 28:throw e.prev=28,e.t8=e.catch(20),new o.a("sceneservice:root-node-missing","Root node missing.",{pageError:d,nodeError:e.t8,url:f});case 31:case"end":return e.stop()}}),e,null,[[3,14],[20,28]])}))),u.apply(this,arguments)}},981:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o}));var r,a=i(13),n=i(9);function s(e){e.vertex.uniforms.add("camPos","vec3").add("perScreenPixelRatio","float").add("screenSize","float"),e.vertex.code.add(Object(n.a)(r||(r=Object(a.a)(["float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - camPos));\nreturn viewDirectionDistance*perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;\n}"]))))}function o(e,t,i){e.setUniform1f("perScreenPixelRatio",i.camera.perScreenPixelRatio),e.setUniform1f("screenSize",t.screenSize)}},982:function(e,t,i){"use strict";i.d(t,"a",(function(){return _})),i.d(t,"b",(function(){return w}));var r,a,n,s,o,c,l,u,d,h=i(13),b=i(981),p=i(81),f=i(147),v=i(126),O=i(124),y=i(121),j=i(183),g=i(9),m=i(84);function w(e){var t=new m.a;return t.include(f.a,{linearDepth:!1}),t.include(b.a,{}),t.include(p.a,e),t.fragment.include(j.a),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.fragment.uniforms.add("color","vec4"),t.attributes.add("position","vec3"),t.varyings.add("vWorldPosition","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add("offset","vec3"),e.shadingEnabled&&(t.vertex.uniforms.add("viewNormal","mat4"),t.fragment.uniforms.add("shadedColor","vec4").add("shadingDirection","vec3"),t.attributes.add("normal","vec3"),t.varyings.add("vViewNormal","vec3")),t.vertex.code.add(Object(g.a)(r||(r=Object(h.a)(["\n    void main(void) {\n      vWorldPosition = ",";\n  "])),e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position")),e.shadingEnabled&&t.vertex.code.add(Object(g.a)(a||(a=Object(h.a)(["vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;"])))),t.vertex.code.add(Object(g.a)(n||(n=Object(h.a)(["\n    ","\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(vWorldPosition, 1.0)).z;":"")),e.multipassTerrainEnabled&&(t.fragment.include(v.a),t.include(O.b,e)),t.fragment.code.add(Object(g.a)(s||(s=Object(h.a)(["\n    void main() {\n      discardBySlice(vWorldPosition);\n      ","\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"")),e.shadingEnabled?t.fragment.code.add(Object(g.a)(o||(o=Object(h.a)(["vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(color, shadedColor, shadingFactor);"])))):t.fragment.code.add(Object(g.a)(c||(c=Object(h.a)(["vec4 finalColor = color;"])))),t.fragment.code.add(Object(g.a)(l||(l=Object(h.a)(["\n      if (finalColor.a < ",") {\n        discard;\n      }\n      ","\n\n      ","\n    }\n    "])),g.a.float(y.c),7===e.output?Object(g.a)(u||(u=Object(h.a)(["gl_FragColor = vec4(finalColor.a);"]))):"",0===e.output?Object(g.a)(d||(d=Object(h.a)(["gl_FragColor = highlightSlice(finalColor, vWorldPosition); ",""])),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"")),t}var _=Object.freeze({__proto__:null,build:w})},983:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c}));var r,a,n=i(13),s=i(9),o=i(84);function c(){var e=new o.a;return e.extensions.add("GL_OES_standard_derivatives"),e.vertex.uniforms.add("proj","mat4").add("view","mat4"),e.attributes.add("position","vec3"),e.attributes.add("uv0","vec2"),e.varyings.add("vUV","vec2"),e.vertex.code.add(Object(s.a)(r||(r=Object(n.a)(["void main(void) {\nvUV = uv0;\ngl_Position = proj * view * vec4(position, 1.0);\n}"])))),e.fragment.uniforms.add("backgroundColor","vec4").add("gridColor","vec4").add("ratio","float").add("gridWidth","float"),e.fragment.code.add(Object(s.a)(a||(a=Object(n.a)(["void main() {\nconst float LINE_WIDTH = 1.0;\nvec2 uvScaled = vUV * gridWidth;\nvec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));\nvec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);\ngrid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);\ngrid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);\nfloat gridFade = max(grid.x, grid.y);\nfloat gridAlpha = gridColor.a * gridFade;\ngl_FragColor =\nvec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +\nvec4(gridColor.rgb, 1.0) * gridAlpha;\n}"])))),e}var l=Object.freeze({__proto__:null,build:c})}}]);
//# sourceMappingURL=51.ee846ff0.chunk.js.map