(this.webpackJsonpexample=this.webpackJsonpexample||[]).push([[26],{1221:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return T}));var n=r(8),a=r.n(n),i=r(15),o=r(29),l=r(2),s=r(3),u=r(6),c=r(7),f=r(0),p=r(4),h=r(36),d=r(1),m=(r(17),r(18),r(16),r(12)),b=r(631),y=r(654),v=r(619),x=r(146),g=r(24),j=r(922),O=r(803),w=r(630),R=r(810),k=r(895),M=r(697),I=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(l.a)(this,r),(e=t.apply(this,arguments)).type="imagery-tile-3d",e.isAlignedMapTile=!0,e}return Object(s.a)(r,[{key:"initialize",value:function(){var e=this;this.layer.increaseRasterJobHandlerUsage();var t=this.updateFullExtent();this.addResolvingPromise(t);var r=Object(h.l)(this.view,"basemapTerrain.tilingSchemeLocked").then((function(){var t=e.view.basemapTerrain.tilingScheme,r=e.layer.tileInfo,n=["png","png24","png32","jpg","mixed"].indexOf(r.format)>-1&&t.compatibleWith(r);e.isAlignedMapTile=n;var a=n?r:t.toTileInfo();e._set("tileInfo",a),e.updatingHandles.add(e,"layer.renderer",(function(){return e.refresh()})),e.updatingHandles.add(e,"layer.interpolation",(function(){return e.refresh()})),e.updatingHandles.add(e,"layer.bandIds",(function(){return e.refresh()})),e.updatingHandles.add(e,"layer.multidimensionalDefinition",(function(){return e.refresh()}))}));this.addResolvingPromise(r)}},{key:"destroy",value:function(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}},{key:"_blankTile",get:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),r=Object(o.a)(this.tileInfo.size,2),n=r[0],a=r[1];return e.width=n,e.height=a,t.clearRect(0,0,n,a),t.getImageData(0,0,n,a)}},{key:"imageFormatIsOpaque",get:function(){return"jpg"===this.layer.tileInfo.format}},{key:"hasMixedImageFormats",get:function(){return"mixed"===this.layer.tileInfo.format}},{key:"dataLevelRange",get:function(){var e=this.tileInfo.lods,t=this.layer.tileInfo.lods,r=e[0].scale,n=t[t.length-1].scale;return this.levelRangeFromScaleRange(r,n)}},{key:"fetchTile",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n,i){var o,l,s,u,c,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.tileInfo,l=this._canSymbolizeInWebGL(),s={tileInfo:o,requestRawData:l,signal:Object(p.t)(i.signal),requestAsImageElement:this.isAlignedMapTile},e.next=5,this.layer.fetchTile(t,r,n,s);case 5:if(!((u=e.sent)instanceof HTMLImageElement)){e.next=8;break}return e.abrupt("return",u);case 8:if(c=u&&u.pixelBlock,!Object(p.j)(c)){e.next=11;break}return e.abrupt("return",this._blankTile);case 11:if(e.t0=!l,!e.t0){e.next=17;break}return e.next=15,this.layer.applyRenderer(u);case 15:c=e.sent,e.t0=Object(p.j)(c);case 17:if(!e.t0){e.next=19;break}return e.abrupt("return",this._blankTile);case 19:return f=new v.a([t,r,n],c,o.size[0],o.size[1]),e.abrupt("return",(l?(f.symbolizerRenderer=this.layer.symbolizer.rendererJSON,f.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(t)),f.transformGrid=u.transformGrid):f.isRendereredSource=!0,f.interpolation=this.layer.interpolation,f.bandIds=this.layer.bandIds,f));case 21:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_getSymbolizerOptions",value:function(e){var t=this.tileInfo.lodAt(e).resolution;return{pixelBlock:null,isGCS:this.view.spatialReference.isGeographic,resolution:{x:t,y:t},bandIds:this.layer.bandIds}}},{key:"ensureSymbolizerParameters",value:function(e){this._canSymbolizeInWebGL()&&JSON.stringify(e.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(e.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e.lij[0])))}},{key:"createFetchPopupFeaturesQueryGeometry",value:function(e,t){return Object(k.a)(e,t,this.view)}},{key:"refresh",value:function(){this.emit("data-changed")}},{key:"doRefresh",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.suspended||this.emit("data-changed");case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_canSymbolizeInWebGL",value:function(){return Object(M.a)().supportsTextureFloat&&this.layer.symbolizer.canRenderInWebGL}}]),r}(function(e){var t=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(l.a)(this,r),(e=t.apply(this,arguments))._rasterFieldPrefix="Raster.",e.layer=null,e.view=null,e.fullExtent=null,e.tileInfo=null,e.datumTransformation=null,e}return Object(s.a)(r,[{key:"hasTilingEffects",get:function(){return this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}},{key:"fetchPopupFeatures",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r){var n,i,o,l,s,u,c,f,h,d,m,b,y,v,j,w,R,k,M;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.layer,t){e.next=3;break}return e.abrupt("return",Promise.reject(new g.a("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:n})));case 3:if(i=n.popupEnabled,o=Object(O.a)(n,r),i&&Object(p.k)(o)){e.next=6;break}throw new g.a("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:i,popupTemplate:o});case 6:return l=[],e.next=9,n.identify(t);case 9:if(s=e.sent,u=s.value,c=s.magdirValue,f="",u&&u.length){if(f="imagery-tile"===n.type&&n.hasStandardTime()&&null!=u[0]?u.map((function(e){return n.getStandardTimeValue(e)})).join(", "):u.join(", "),(m={ObjectId:0})[b="Raster.ServicePixelValue"]=this._formatAttributeValue(f,b),(y=null==(h=n.rasterInfo)||null==(d=h.attributeTable)?void 0:d.features)&&y.length>0&&(v=y.filter((function(e){var t=e.attributes.value||e.attributes.Value||e.attributes.VALUE;return String(t)===f})),v.length>0&&(j=v[0])))for(w in j.attributes)j.attributes.hasOwnProperty(w)&&(R=this._rasterFieldPrefix+w,m[R]=this._formatAttributeValue(j.attributes[w],R));"vector-magdir"!==(k=n.rasterInfo.dataType)&&"vector-uv"!==k||(m["Raster.Magnitude"]=null==c?void 0:c[0],m["Raster.Direction"]=null==c?void 0:c[1]),(M=new x.a(this.fullExtent.clone(),null,m)).layer=n,M.sourceLayer=M.layer,l.push(M)}return e.abrupt("return",l);case 15:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateFullExtent",value:function(){var e,t=this.layer.tileInfo;t&&t.spatialReference||(e=new g.a("layerview:tiling-information-missing","The layer doesn't provide tiling information",{layer:this.layer}));var r=Object(j.a)(this.layer.fullExtent,this.view.spatialReference,!1),n=Object(j.f)(this.layer.fullExtent,this.view.spatialReference,r);return null==n&&(e=new g.a("layerview:projection-not-supported","The layer extent cannot be projected to the view's spatial reference",{layer:this.layer})),this._set("fullExtent",n),this.datumTransformation||(this.datumTransformation=Object(j.a)(this.layer.fullExtent,this.view.spatialReference,!0)),e?Promise.reject(e):Promise.resolve()}},{key:"_formatAttributeValue",value:function(e,t){if("string"==typeof e){var r,n,a=this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,i=this._getFieldInfo(a,t),o=i&&i.format;if(o)return e.trim().indexOf(",")>-1?(n=(r=",")+" ",this._formatDelimitedString(e,r,n,o)):e.trim().indexOf(" ")>-1?(r=n=" ",this._formatDelimitedString(e,r,n,o)):this._formatNumberFromString(e,o)}return e}},{key:"_getFieldInfo",value:function(e,t){if(e&&e.length&&t){var r,n=t.toLowerCase();return e.some((function(e){return!(!e.fieldName||e.fieldName.toLowerCase()!==n&&e.fieldName.toLowerCase()!==n.replace(/ /g,"_"))&&(r=e,!0)})),r}}},{key:"_formatDelimitedString",value:function(e,t,r,n){var a=this;return e&&t&&r&&n?e.trim().split(t).map((function(e){return a._formatNumberFromString(e,n)})).join(r):e}},{key:"_formatNumberFromString",value:function(e,t){if(!e||!t)return e;var r=Number(e);return isNaN(r)?e:t.format(r)}}]),r}(e);return Object(f.a)([Object(d.b)()],t.prototype,"layer",void 0),Object(f.a)([Object(d.b)()],t.prototype,"view",void 0),Object(f.a)([Object(d.b)()],t.prototype,"fullExtent",void 0),Object(f.a)([Object(d.b)()],t.prototype,"tileInfo",void 0),Object(f.a)([Object(d.b)({readOnly:!0})],t.prototype,"hasTilingEffects",null),t=Object(f.a)([Object(m.a)("esri.views.layers.ImageryTileLayerView")],t)}(Object(R.a)(Object(y.a)(Object(b.a)(w.a)))));Object(f.a)([Object(d.b)({readOnly:!0})],I.prototype,"_blankTile",null),Object(f.a)([Object(d.b)({readOnly:!0})],I.prototype,"imageFormatIsOpaque",null),Object(f.a)([Object(d.b)({readOnly:!0})],I.prototype,"hasMixedImageFormats",null),Object(f.a)([Object(d.b)({readOnly:!0})],I.prototype,"dataLevelRange",null);var T=I=Object(f.a)([Object(m.a)("esri.views.3d.layers.ImageryTileLayerView3D")],I)},803:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return u}));var n=r(8),a=r.n(n),i=r(42),o=r(15),l=r(4),s=r(112);function u(e){return c.apply(this,arguments)}function c(){return c=Object(o.a)(a.a.mark((function e(t){var r,n,o,u,c,f,p,h,d,m=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=m.length>1&&void 0!==m[1]?m[1]:t.popupTemplate,Object(l.k)(r)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,r.getRequiredFields(t.fieldsIndex);case 5:if(n=e.sent,o=r.lastEditInfoEnabled,u=t.objectIdField,c=t.typeIdField,f=t.globalIdField,p=t.relationships,!n.includes("*")){e.next=13;break}return e.abrupt("return",["*"]);case 13:if(!o){e.next=19;break}return e.next=16,Object(s.n)(t);case 16:e.t0=e.sent,e.next=20;break;case 19:e.t0=[];case 20:return h=e.t0,d=Object(s.j)(t.fieldsIndex,[].concat(Object(i.a)(n),Object(i.a)(h))),e.abrupt("return",(c&&d.push(c),d&&u&&t.fieldsIndex.has(u)&&-1===d.indexOf(u)&&d.push(u),d&&f&&t.fieldsIndex.has(f)&&-1===d.indexOf(f)&&d.push(f),p&&p.forEach((function(e){var r=e.keyField;d&&r&&t.fieldsIndex.has(r)&&-1===d.indexOf(r)&&d.push(r)})),d));case 23:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function f(e,t){return e.popupTemplate?e.popupTemplate:Object(l.k)(t)&&t.defaultPopupTemplateEnabled&&Object(l.k)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}},810:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(2),a=r(3),i=r(6),o=r(7),l=r(0),s=r(16),u=r(25),c=r(36),f=r(1),p=(r(17),r(18),r(12)),h=function(e){var t=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(a.a)(r,[{key:"initialize",value:function(){var e=this;this.handles.add(Object(c.b)(this,"layer","refresh",(function(){e.doRefresh().catch((function(t){Object(u.n)(t)||s.a.getLogger(e.declaredClass).error(t)}))})),"RefreshableLayerView")}}]),r}(e);return Object(l.a)([Object(f.b)()],t.prototype,"layer",void 0),t=Object(l.a)([Object(p.a)("esri.layers.mixins.RefreshableLayerView")],t)}},854:function(e,t,r){"use strict";function n(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function a(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){for(var t=0,r=0,n=0;n<e.length;n++){var a=e[n].size;"number"==typeof a&&(t+=a,r++)}return t/r}(e.stops):t}function i(e,t){if(!t)return e;var r=t.filter((function(e){return"size"===e.type})).map((function(t){var r=t.maxSize,n=t.minSize;return(a(r,e)+a(n,e))/2})),n=0,i=r.length;if(0===i)return e;for(var o=0;o<i;o++)n+=r[o];var l=Math.floor(n/i);return Math.max(l,e)}function o(e){var t=e&&e.renderer,r="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return r;var a="visualVariables"in t?i(r,t.visualVariables):r;if("simple"===t.type)return n(a,t.symbol);if("unique-value"===t.type){var o=a;return t.uniqueValueInfos.forEach((function(e){o=n(o,e.symbol)})),o}if("class-breaks"===t.type){var l=a;return t.classBreakInfos.forEach((function(e){l=n(l,e.symbol)})),l}return t.type,a}r.d(t,"a",(function(){return o}))},895:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r(140);var n=r(4),a=r(78),i=(r(854),r(72));function o(e,t,r){var o,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new i.a;if("2d"===r.type)o=t*r.resolution;else if("3d"===r.type){var s=r.overlayPixelSizeInMapUnits(e),u=r.basemapSpatialReference;o=Object(n.k)(u)&&!u.equals(r.spatialReference)?Object(a.f)(u)/Object(a.f)(r.spatialReference):t*s}var c=e.x-o,f=e.y-o,p=e.x+o,h=e.y+o,d=r.spatialReference;return l.xmin=Math.min(c,p),l.ymin=Math.min(f,h),l.xmax=Math.max(c,p),l.ymax=Math.max(f,h),l.spatialReference=d,l}new i.a},922:function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return L})),r.d(t,"c",(function(){return F})),r.d(t,"d",(function(){return z})),r.d(t,"e",(function(){return v})),r.d(t,"f",(function(){return k})),r.d(t,"g",(function(){return w})),r.d(t,"h",(function(){return j})),r.d(t,"i",(function(){return P})),r.d(t,"j",(function(){return N}));var n=r(8),a=r.n(n),i=r(29),o=r(15),l=(r(140),r(24)),s=r(4),u=r(78),c=r(49),f=r(77),p=r(72),h=r(57),d=5e-4,m=function(e,t){var r=(e.isWGS84||e.isWebMercator)&&(t.isWGS84||t.isWebMercator);return!(e.equals(t)||r)},b=function(e,t){var r=(e[0]+e[4]+e[4*t.cols]+e[4*t.cols+4])/4,n=(e[1]+e[5]+e[4*t.rows+1]+e[4*t.rows+5])/4;return[Math.abs(r-e[2*t.rows+2]),Math.abs(n-e[2*t.rows+3])]},y={3395:20037508.342789244,3410:17334193.943686873,3832:3339584.723798206,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,8858:7396237.374497803,8859:2465412.4581659334,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53025:7276828.3848298555,53031:10384677.558821043,53034:20015086.79602057,53036:7389443.187332862,53037:2463147.729110953,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54025:7311399.09166516,54031:10396310.810074743,54034:20037508.342789244,54050:808820.9223376509,54053:1920897.3915568967,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244,102038:4297258.582585486,102299:5013965.117483125};function v(){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(c.h)()&&Object(c.i)()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,Object(c.j)();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t,r){if(!m(e.spatialReference,t))return null;if(!Object(c.h)())throw new l.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");return r?Object(c.f)(t,e.spatialReference,e):Object(c.f)(e.spatialReference,t,e)}function j(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e.spatialReference.equals(t))return e;var a=m(e.spatialReference,t);if(a&&!Object(c.h)())throw new l.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");var i=r.center,o=new p.a({xmin:i.x-e.x/2,xmax:i.x+e.x/2,ymin:i.y-e.y/2,ymax:i.y+e.y/2,spatialReference:e.spatialReference}),u=a?Object(c.n)(o,t,n):Object(f.d)(o,t);return Object(s.j)(u)?null:{x:u.xmax-u.xmin,y:u.ymax-u.ymin}}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;return Object(u.f)(e)?t/Object(u.f)(e):0}function w(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=e.spatialReference;if(a.equals(t))return e;var o=Object(f.d)(e,t);if(Object(s.j)(o)){if(!Object(c.h)())throw new l.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");o=Object(c.n)(e,t,r)}if(n&&t.isGeographic){var u=T(a,!0),p=Object(i.a)(u,2),h=p[0],m=p[1],b=O(a);b&&null!=h&&null!=m&&(Math.abs(e.x-h)<b&&Math.abs(180-o.x)<d?o.x-=360:Math.abs(e.x-m)<b&&Math.abs(180+o.x)<d&&(o.x+=360))}return o}function R(e){var t=I(e[0].spatialReference);if(e.length<2||!Object(s.k)(t))return e[0];for(var r=e[0],n=r.xmin,a=r.xmax,i=r.ymin,o=r.ymax,l=1;l<e.length;l++){var u=e[l];a=u.xmax+t*l,i=Math.min(i,u.ymin),o=Math.max(o,u.ymax)}return new p.a({xmin:n,xmax:a,ymin:i,ymax:o,spatialReference:e[0].spatialReference})}function k(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e.spatialReference.equals(t))return e;var a=z(e),i=I(e.spatialReference,!0);return Object(s.k)(i)&&0!==a?R(e.clone().normalize().map((function(e){return M(e,t,r,n)}))):M(e,t,r,n)}function M(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=e.spatialReference;if(a.equals(t))return e;if(m(a,t)&&!Object(c.h)())throw new l.a("rasterprojectionhelper-projectExtent","projection engine is not loaded");var o=Object(f.d)(e,t);Object(s.j)(o)&&(o=Object(c.n)(e,t,r));var u=T(a,!0),p=Object(i.a)(u,2),b=p[0],y=p[1];if(o&&n&&a.isWebMercator&&t.isGeographic&&null!=b&&null!=y){var v=.001,x=1e3;if(Math.abs(e.xmin-b)<v&&Math.abs(y-e.xmax)>x&&Math.abs(180-o.xmax)<d){o.xmin=-180;var g=[];g.push(new h.a(e.xmax,e.ymin,a)),g.push(new h.a(e.xmax,(e.ymin+e.ymax)/2,a)),g.push(new h.a(e.xmax,e.ymax,a));var j=g.map((function(e){return w(e,t,r)})).filter((function(e){return!isNaN(null==e?void 0:e.x)})).map((function(e){return e.x}));o.xmax=Math.max.apply(null,j)}if(Math.abs(e.xmax-y)<v&&Math.abs(b-e.xmin)>x&&Math.abs(180+o.xmin)<d){o.xmax=180;var R=[];R.push(new h.a(e.xmin,e.ymin,a)),R.push(new h.a(e.xmin,(e.ymin+e.ymax)/2,a)),R.push(new h.a(e.xmin,e.ymax,a));var k=R.map((function(e){return w(e,t,r)})).filter((function(e){return!isNaN(null==e?void 0:e.x)})).map((function(e){return e.x}));o.xmin=Math.min.apply(null,k)}}var M=T(t,!0),I=Object(i.a)(M,2);b=I[0],y=I[1];var S=O(t);return S&&null!=b&&null!=y&&(Math.abs(o.xmin-b)<S&&(o.xmin=b),Math.abs(o.xmax-y)<S&&(o.xmax=y)),o}function I(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*r:e.wkid&&e.isGeographic?360:2*y[e.wkid]||null}function T(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=I(e,t);return Object(s.k)(n)&&(r.push(-n/2),r.push(n/2)),r}function S(e,t,r,n){var a=(e-t)/r;return a-Math.floor(a)!=0?a=Math.floor(a):n&&(a-=1),a}function z(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=I(e.spatialReference);if(!Object(s.k)(r))return 0;var n=t?0:-r/2;return S(e.xmax,n,r,!0)-S(e.xmin,n,r,!1)}function F(e){var t=e.storageInfo.origin.x,r=I(e.spatialReference,!0);if(!Object(s.k)(r))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};for(var n=r/2,a=e.nativePixelSize,i=e.storageInfo,o=e.extent,l=i.maximumPyramidLevel,u=i.blockWidth,c=i.pyramidScalingFactor,f=a.x,p=[],h=Object(s.k)(e.transform)&&"gcs-shift"===e.transform.type,d=t+n,m=h?r-t:n-t,b=0;b<=l;b++){var y=(o.xmax-t)/f/u,v=y-Math.floor(y)==0?y:Math.ceil(y),x=(r/2-t)/f/u,g=x-Math.floor(x)==0?x:Math.ceil(x),j=Math.floor(d/f/u),O=Math.round(d/f)%u,w=(u-Math.round(m/f)%u)%u;p.push({resolutionX:f,blockWidth:u,datsetColumnCount:v,worldColumnCountFromOrigin:g,leftMargin:O,rightPadding:w,originColumnOffset:j}),f*=c}return{originX:t,halfWorldWidth:n,pyramidsInfo:p,hasGCSSShiftTransform:h}}function L(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[32,32];if(m(e.spatialReference,t.spatialReference)&&!Object(c.h)())throw new l.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");if(!(e&&t&&r))return null;var u=e.xmin,f=e.ymin,p=e.xmax,d=e.ymax,y=e.spatialReference,v=t.spatialReference,x=I(v);i=i||"gcs-shift"===(null==a?void 0:a.type);for(var g,j={x:o[0]*r.x,y:o[1]*r.y},O={cols:Math.ceil((p-u)/j.x-.1/o[0])+1,rows:Math.ceil((d-f)/j.y-.1/o[1])+1},R=j.x,k=j.y,M=[],T=!1,S=0;S<O.cols;S++){for(var z=[],F=0;F<O.rows;F++){var L=w(new h.a({x:u+R*S,y:d-k*F,spatialReference:y}),v,n);a&&(L=a.inverseTransform(L)),z.push(L),S>0&&i&&L&&g[F]&&Object(s.k)(x)&&L.x<g[F].x&&(L.x+=x),L?(M.push((L.x-t.xmin)/(t.xmax-t.xmin)),M.push((t.ymax-L.y)/(t.ymax-t.ymin))):(M.push(NaN),M.push(NaN),T=!0)}g=z}for(var P=b(M,O),N=new Float32Array((O.cols-1)*(O.rows-1)*2*6),_=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),E=new Float32Array([-1,1,0,0,-1,1,1,0,0]),W=0;W<O.cols-1;W++){for(var G=0;G<O.rows-1;G++){for(var V=W*O.rows*2+2*G,q=M[V],A=M[V+1],C=M[V+2],D=M[V+3],J=M[V+=2*O.rows],H=M[V+1],U=M[V+2],B=M[V+3],X=0,Q=12*(G*(O.cols-1)+W),K=0;K<3;K++)N[Q++]=_[X++]*q+_[X++]*C+_[X++]*U;X=0;for(var Y=0;Y<3;Y++)N[Q++]=_[X++]*A+_[X++]*D+_[X++]*B;X=0;for(var Z=0;Z<3;Z++)N[Q++]=E[X++]*q+E[X++]*J+E[X++]*U;X=0;for(var $=0;$<3;$++)N[Q++]=E[X++]*A+E[X++]*H+E[X++]*B}if(T)for(var ee=0;ee<N.length;ee++)isNaN(N[ee])&&(N[ee]=-1)}return{offsets:M,error:P,coefficients:N,spacing:o,size:[O.cols-1,O.rows-1]}}function P(e){var t=e.clone().normalize();return 1===t.length?t[0]:R(t)}function N(e,t,r){var n,a=t.storageInfo,i=t.pixelSize,o=!1,l=a.pyramidResolutions;if(Object(s.k)(l)&&l.length){var u=(e.x+e.y)/2,c=l[l.length-1],f=(c.x+c.y)/2,p=(i.x+i.y)/2;if(u<=p)n=0;else if(u>=f)n=l.length,o=u/f>8;else for(var d,m=p,b=1;b<=l.length;b++){if(u<=(d=(l[b-1].x+l[b-1].y)/2)){u===d?n=b:"down"===r?(n=b-1,o=u/m>8):n="up"===r||u-m>d-u||u/m>2?b:b-1;break}m=d}var y=0===n?i:l[n-1];return{pyramidLevel:n,pyramidResolution:new h.a({x:y.x,y:y.y,spatialReference:t.spatialReference}),excessiveReading:o}}var v=Math.log(e.x/i.x)/Math.LN2,x=Math.log(e.y/i.y)/Math.LN2,g=t.storageInfo.maximumPyramidLevel||0;(n="down"===r?Math.floor(Math.min(v,x)):"up"===r?Math.ceil(Math.max(v,x)):Math.round((v+x)/2))<0?n=0:n>g&&(o=n>g+3,n=g);var j=Math.pow(2,n);return{pyramidLevel:n,pyramidResolution:new h.a({x:j*t.nativePixelSize.x,y:j*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:o}}}}]);
//# sourceMappingURL=26.ecfd22a9.chunk.js.map